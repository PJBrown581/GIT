<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>SKS_EFT_Format_US_CITICONNECT_XML</Name>
	<SourceCode>
		<Declaration><![CDATA[
/// <summary>
/// SKS_EFT_Format_US_CITICONNECT_XML extends SKS_EFT_Format_ISO_20022_001001003
/// </summary>
class SKS_EFT_Format_US_CITICONNECT_XML extends SKS_EFT_Format_ISO_20022_001001003
{
    //------------------------------------------------------------------------------------------------------
    /// <summary>
    /// This is extending the SEPA_Credit Format
    /// </summary>
    //------------------------------------------------------------------------------------------------------
    #define.FormatVersion('20230524')
    #define.FT607('FT-607')
    #define.CHK487('CHK-487')
    #define.OTC894('OTC-894')
    #define.DFT391('DFT-391')
    #define.CBFT392('CBFT-392')                  //SKG#VSTS:11471
    #define.CBFT896('CBFT-896')
    #define.CACH460('CACH-460')
    #define.BKT602('BKT-602')
    #define.DFT603('DFT-603')
    #define.CBFT604('CBFT-604')
    #define.ACHCCD('ACH-CCD')
    #define.ACHPPD('ACH-PPD')
    #define.ACHCTX('ACH-CTX')
    #define.FT499('FT-499')
    #define.BKT500('BKT-500')
    #define.WLW571('WLW-571')
    #define.ACH502('CCD-502')
    #define.ACH503('PPD-503')
    #define.CPS28('CPS-28')
    #define.CPS29('CPS-29')
    #define.USFCP821('USFCP-821')

    #define.ACH_SEPA('ACH-SEPA')
    #define.ACH_DC('ACH-DC')
    #define.ACH_KID('ACH-KID')
    #define.ACH_PG('ACH-PG')
    #define.ACH_BG('ACH-BG')
    #define.CB_WIRE('CB-WIRE')

    #define.DOM391('DOM-391')
    #define.CB392('CB-392')          //SKG#VSTS:11471
    #define.BKT393('BKT-393')       //SKG#VSTS:11471
    #define.DC417('DC-417')
    #define.CHECK416('CHECK-416')
    #define.IBRS429('IBRS-429')
    #define.IBRS430('IBRS-430')
    #define.CHECK427('CHECK-427')
    #define.DOM391RT('DOM-391-RT')  //SKG#VSTS:7509

    #define.ACH964('ACH-964')
    #define.CHECK815('CHECK-815')
    #define.DFT555('DFT-555')
    #define.CBFT574('CBFT-574')     //SKG#VSTS:11518

    #define.CHK804('CHK-804')       //SKG#VSTS:7453
    #define.DFT574('DFT-574')       //SKG#VSTS:7453

    #define.ACHCCP('ACH-CCP')
    #define.ACHPPP('ACH-PPP')
    #define.CCDP14('CCDP-14')
    #define.CTX17('CTX-17')
    #define.CHK19('CHK-19')
    #define.CHK585('CHK-585')
    #define.CTX942('CTX-942')
    #define.CHK20('CHK-20')
    #define.CPS706('CPS-706')
    #define.ACH780('ACH-780')
    #define.DOM317('DOM-317')
    #define.DOM555('DOM-555')               //SKG#VSTS:11518
    #define.SEPA848('SEPA-848')
    #define.SEPA939('SEPA-939')
    #define.ACH208('ACH-208')
    #define.DOM303('DOM-303')
    #define.DOM903('DOM-903')
    #define.DOM325('DOM-325')
    #define.DOM332('DOM-332')
    #define.DOM789('DOM-789')
    #define.DOM548('DOM-548')
    #define.ACH150('ACH-150')
    #define.SEPA938('SEPA-938')
    #define.ACH809('ACH-809')
    #define.BKT440('BKT-440')
    #define.DOM441('DOM-441')
    #define.TLPAY451('TLPAY-451')
    #define.RT453('RT-453')
    #define.DL454('DL-454')
    #define.CBFT442('CBFT-442')
    #define.CHK478('CHK-478')
    #define.DE397('DE-397')
    #define.PLG400('PLG-400')
    #define.ATPAY403('ATPAY-403')
    #define.CHK405('CHK-405')
    #define.LLG408('LLG-408')
    #define.CHK436('CHK-436')
    #define.PRL398('PRL-398')
    #define.PRL401('PRL-401')
    #define.DD437('DD-437')
    #define.DOM540('DOM-540')
    #define.DFT914('DFT-914')
    #define.BKT410('BKT-410')
    #define.PRL414('PRL-414')
    #define.PLG527('PLG-527')
    #define.CHK418('CHK-418')
    #define.GIRO421('GIRO-421')
    #define.ATPAY424('ATPAY-424')
    #define.CHK425('CHK-425')
    #define.PRL426('PRL-426')

    #define.CHK496('CHK-496')
    #define.CHK834('CHK-834')
    #define.BWPMT835('BWPMT-835')
    #define.DFT441('DFT-441')
    #define.CBFT827('CBFT-827')
    #define.DIT828('DIBT-828')
    #define.DPRL831('DPRL-831')
    #define.DPENS832('DPENS-832')
    #define.BKT833('BKT-833')
    #define.GIRO527('GIRO-527')
    #define.CHK415('CHK-415')
    #define.ATPAY403('ATPAY-403')   //SKG#VSTS:9402
    #define.CHECK405('CHECK-405')   //SKG#VSTS:9402
    #define.DE397('DE-397')         //SKG#VSTS:9403
    #define.CHK396('CHK-396')       //SKG#VSTS:9403
    #define.BPAY889('BPAY-889')     //SKG#VSTS:9403

    #define.ACH_WL('ACH-WL')
    #define.WIRE_WL('WIRE-WL')
    #define.CHK_WL('CHK-WL')
    #define.SEPA_WL('SEPA-WL')

    #define.ACH_WL_RC('ACH-WL-RC')
    #define.WIRE_WL_RC('WIRE-WL-RC')
    #define.CHK_WL_RC('CHK-WL-RC')
    #define.SEPA_WL_RC('SEPA-WL-RC')
    #define.WIRE_WL_O('WIRE-WL-O')
    #define.WIRE_WLORC('WIRE-WLORC')

    #define.CHK815('CHK-815')           //SKG#VSTS:10808
    #define.BKT547('BKT-547')           //SKG#VSTS:10808

    #define.WIRE574('WIRE-574')     
    #define.ACH410('ACH-410')       
    #define.WIRE391('WIRE-391')     
    #define.WIRE392('WIRE-392')     

    #define.CDFT392('CDFT-392')
    #define.SIP962('SIP-962')

    #define.CHK423('CHK-423')           //SKG#VSTS:11471
    #define.CHK420('CHK-420')           //SKG#VSTS:11471
    #define.PRL422('PRL-422')           //SKG#VSTS:11471
    #define.GIRO421('GIRO-421')         //SKG#VSTS:11471

    #define.BKT547('BKT-547')           //SKG#VSTS:11518
    #define.SSK853('SSK-853')           //SKG#VSTS:11518

    #define.BFT551('BFT-551')
    #define.CHK402('CHK-402')           //SKS_VSTS_12162

    //SKS_VSTS_11880 --->
    #define.CHK493('CHK-493')
    #define.CHK494('CHK-494')
    //SKS_VSTS_11880<---

    #define.SEPA('SEPA')                //SKG#VSTS:12473
    #define.XPRS888('XPRS-888')         //SKG#VSTS:12473
    
    #define.TAX592('TAX-592')           //SKG#VSTS:12473
    #define.VAT984('VAT-984')           //SKG#VSTS:12473

    #define.WIRE_WL_I('WIRE-WL-I')      //SKS_VSTS_13659
    #define.WIRE_WLIRC('WIRE-WLIRC')    //SKS_VSTS_13659

    #define.CTX950('CTX-950')           //SKS#VSTS:13477
    #define.CDM950('CDM-950')           //SKS#VSTS:13477
    #define.CHK950('CHK-950')           //SKS#VSTS:13477
    #define.RTGS605('RTGS-605')         //SKG#VSTS:14212

    #define.PPW_WL('PPW-WL')            //SKS#VSTS:14271
    #define.PPW_PH_WL('PPW-PH-WL')      //SKS#DevOps:14542
    #define.SIP962('SIP-962')           //SKS#DevOps:14844

    #define.DFT541('DFT-541')       //SKG#DevOps:15853
    #define.RTGS539('RTGS-539')     //SKG#DevOps:15853
    #define.TAX908('TAX-908')       //SKG#DevOps:15853
    #define.TAX927('TAX-927')       //SKG#DevOps:15853
    #define.TAX947('TAX-947')       //SKG#DevOps:15853
    #define.IFT_CB392('IFT-CB392')  //SKG#DevOps:15853
    #define.CDT862('CDT-862')       //SKG#DevOps:15853

    #define.WIRE_WL_IC('WIRE-WL-IC')      //SKG#DevOps:17359
    #define.WIREWLICRC('WIREWLICRC')      //SKG#DevOps:17359
    #define.WIRE_WL_IS('WIRE-WL-IS')      //SKG#DevOps:17359
    #define.WIREWLISRC('WIREWLISRC')      //SKG#DevOps:17359
    #define.WIRE_WL_IP('WIRE-WL-IP')      //SKG#DevOps:17359
    #define.WIREWLIPRC('WIREWLIPRC')      //SKG#DevOps:17359
    #define.TRADE('TRADE')          //DevOps18498
    #define.INSTPAY('INSTPAY')      //DevOps20744 (Port 20684)

    str bankCode;
    str bankCodeText;
    str email, telNo;
    SKS_PP_Setup lSKS_PP_Setup;
    //str street, city, postalCode, countryRegionId;

}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getFormatVersion</Name>
				<Source><![CDATA[
    protected str getFormatVersion()
    {
        return #FormatVersion;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getBankPurposeCode</Name>
				<Source><![CDATA[
    private void getBankPurposeCode()
    {
        msks_EFT_FileDetail_PaymentLine = sks_EFT_FileDetail_PaymentLine::find(mSKS_EFT_FileDetail.RecId); //FDD-10590
    
        bankCodeText = this.CharacterReplacement(msks_EFT_FileDetail_PaymentLine.BankCentralBankPurposeText); //FDD-10590

        bankCode = this.CharacterReplacement(msks_EFT_FileDetail_PaymentLine.BankCentralBankPurposeCode); //FDD-10590

        return;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getRemoveBOM</Name>
				<Source><![CDATA[
    protected boolean getRemoveBOM()
    {
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getEmailandTelephonenumber</Name>
				<Source><![CDATA[
    private void getEmailandTelephonenumber()
    {
        VendTable   lVendTable;
        DirPartyLocation                dirPartyLocation;
        LogisticsElectronicAddress      lLogisticsElectronicAddress;
        LogisticsElectronicAddressRole  lLogisticsElectronicAddressRole;
        LogisticsLocationRole           lLogisticsLocationRole;

        boolean telephonenumber = true;
        boolean emailvalue = true;

        lVendTable = VendTable::findByCompany(mSKS_EFT_FileDetail.AccountCompany, mSKS_EFT_FileDetail.AccountNum);

        while select Location from DirPartyLocation where dirPartyLocation.party == lVendTable.Party
            join lLogisticsElectronicAddress where lLogisticsElectronicAddress.Location == dirPartyLocation.Location
                join LocationRole from lLogisticsElectronicAddressRole where lLogisticsElectronicAddressRole.ElectronicAddress == lLogisticsElectronicAddress.RecId
                    join Name from lLogisticsLocationRole
                        where lLogisticsLocationRole.RecId == lLogisticsElectronicAddressRole.LocationRole && lLogisticsLocationRole.Name == 'SKGPaymentContact'
        {
            if(lLogisticsElectronicAddress.Type == LogisticsElectronicAddressMethodType::Phone && telephonenumber)
            {
                if(lLogisticsElectronicAddress.Locator)
                {
                    telNo = this.CharacterReplacement(lLogisticsElectronicAddress.Locator);
                    telephonenumber = false;
                }
            }
            else if(lLogisticsElectronicAddress.Type == LogisticsElectronicAddressMethodType::Email && emailvalue)
            {
                if(lLogisticsElectronicAddress.Locator)
                {
                    email = this.CharacterReplacement(lLogisticsElectronicAddress.Locator);
                    emailvalue = false;
                }
            }
        }

        return;
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Cdtr</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_Cdtr(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.79: Cdtr
        //              Nm
        //              PstlAdr
        //              Id
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeCdtr;
    
        //          2.79: Cdtr
        nodeCdtr = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Cdtr'));
    
        //              Nm
        this.node_CdtTrfTxInf_Cdtr_Nm(nodeCdtr);
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TRADE)
        {
            //              PstlAdr
            this.node_PmtInf_Cdtr_PstlAdr(nodeCdtr);
    
            //              Id
            this.node_PmtInf_Cdtr_Id(nodeCdtr);

            //              CtctDtls
            this.node_PmtInf_Cdtr_CtctDtls(nodeCdtr);           //SKS#VSTS:14271
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf()
    {
        //------------------------------------------------------------------------------------------------------
        //      2.27: CdtTrfTxInf
        //          2.28: PmtId
        //          2.31: PmtTpInf
        //          2.42: Amt
        //          2.51: ChrgBr
        //          2.52: ChqInstr
        //          2.77: CdtrAgt
        //          2.79: Cdtr
        //          2.80: CdtrAcct
        //          2.98: RmtInf
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeCdtTrfTxInf;

        //      2.27: CdtTrfTxInf
        nodeCdtTrfTxInf = nodePmtInf.appendChild(xmlDoc.createElement('CdtTrfTxInf'));

        //          2.28: PmtId
        this.node_CdtTrfTxInf_PmtId(nodeCdtTrfTxInf);

        //          2.31 PmtTpInf
        this.node_CdtTrfTxInf_PmtTpInf(nodeCdtTrfTxInf);

        //          2.42: Amt
        this.node_CdtTrfTxInf_Amt(nodeCdtTrfTxInf);

        //          2.51: ChrgBr
        this.node_CdtTrfTxInf_ChrgBr(nodeCdtTrfTxInf);

        //          2.52 ChqInstr
        if(mSKS_EFT_FileFormatPaymSpec.UseCheckNumber == NoYes::Yes ||
           subStr(mSKS_EFT_FileDetail.PaymSpec, 1, 3) == 'CHK'      ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK427 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK416 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK815 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY) //DevOps20744 (Port 20684)
        {
            this.node_CdtTrfTxInf_ChqInstr(nodeCdtTrfTxInf);
        }

        if((subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'WL') ||
           (subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'RC') ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-O' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-I')            //SKS_VSTS_13659
        {
            //          2.71: IntrmyAgt1
            this.node_CdtTrfTxInf_IntrmyAgt1WL(nodeCdtTrfTxInf);
        }
        else
        {
            //          2.71: IntrmyAgt1
            this.node_CdtTrfTxInf_IntrmyAgt1(nodeCdtTrfTxInf);
        }

        //          2.72: IntrmyAgt1Acct
        this.node_CdtTrfTxInf_IntrmyAgt1Acct(nodeCdtTrfTxInf);

        //          2.73: IntrmyAgt2
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499)    //SKS#DevOps:16222
        {
            this.node_CdtTrfTxInf_IntrmyAgt2(nodeCdtTrfTxInf);
        }

        if((subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'WL') ||
            (subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'RC') ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-O' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-I')            //SKS_VSTS_13659
        {
            //          2.77: CdtrAgt
            this.node_CdtTrfTxInf_CdtrAgtWL(nodeCdtTrfTxInf);
        }
        else
        {
            //          2.77: CdtrAgt
            this.node_CdtTrfTxInf_CdtrAgt(nodeCdtTrfTxInf);
        }

        //          2.79: Cdtr
        this.node_CdtTrfTxInf_Cdtr(nodeCdtTrfTxInf);

        if((subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'WL') ||
            (subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'RC') ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-O' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-I')            //SKS_VSTS_13659

        {
            //          2.80: CdtrAcct
            this.node_CdtTrfTxInf_CdtrAcctWL(nodeCdtTrfTxInf);
        }
        else
        {
            //          2.80: CdtrAcct
            this.node_CdtTrfTxInf_CdtrAcct(nodeCdtTrfTxInf);
        }

        //          2.82: InstrForCdtrAgt
        this.node_CdtTrfTxInf_InstrForCdtrAgt(nodeCdtTrfTxInf);

        //          2.85: InstrForDbtrAgt
        this.node_CdtTrfTxInf_InstrForDbtrAgt(nodeCdtTrfTxInf);
        //          2.86: Purp
        this.node_CdtTrfTxInf_Purp(nodeCdtTrfTxInf);

        //          2.89: RgltryRptg
        this.node_CdtTrfTxInf_RgltryRptg(nodeCdtTrfTxInf);

        //          2.90: Tax
        this.node_CdtTrfTxInf_Tax(nodeCdtTrfTxInf);

        //          2.91: RltdRmtInf
        this.node_CdtTrfTxInf_RltdRmtInf(nodeCdtTrfTxInf);

        //          2.98: RmtInf
        this.node_CdtTrfTxInf_RmtInf(nodeCdtTrfTxInf);
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_IntrmyAgt2</Name>
				<Source><![CDATA[
    /// <summary>
    /// IntrmyAgt2
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">IntrmyAgt2</param>
    protected void node_CdtTrfTxInf_IntrmyAgt2(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.73: IntrmyAgt2
        //              FinInstnId
        //                  BIC
        //                  ClrSysMmbId
        //                  PstlAdr
        //              BrnchId
        //                  Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeIntrmyAgt1;
        XmlElement nodeFinInstnId;
        XmlElement nodeClrSysMmbId;
    
        if(msKS_EFT_FileDetail_CreditParty.CrePartySwift != '' || msKS_EFT_FileDetail_CreditParty.CrePartyBankId != '')
        {
            //          2.73: IntrmyAgt2
            nodeIntrmyAgt1 = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('IntrmyAgt2'));
    
            //              FinInstnId
            nodeFinInstnId = nodeIntrmyAgt1.appendChild(xmlDoc.createElement('FinInstnId'));
    
            if(msKS_EFT_FileDetail_CreditParty.CrePartySwift)
            {
                //                  BIC
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', msKS_EFT_FileDetail_CreditParty.CrePartySwift, 0, false);  //SKS_FDD_10590
            }
            //                  ClrSysMmbId
            else if(msKS_EFT_FileDetail_CreditParty.CrePartyBankId)
            {
                //      ClrSysMmbId
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                //          MmbId
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', msKS_EFT_FileDetail_CreditParty.CrePartyBankId, 0, false);  //SKS_FDD_10590
            }
    
            if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
            {
                //                  Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 140, false);
            }
            
            //                  PstlAdr
            this.node_PstlAdr(nodeFinInstnId, msKS_EFT_FileDetail_CreditParty.CrePartyCountryRegionId, msKS_EFT_FileDetail_CreditParty.CrePartyAddr, '', msKS_EFT_FileDetail_CreditParty.CrePartyCity);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Amt</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_Amt(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.42: Amt
        //              2.43: InstdAmt
        //------------------------------------------------------------------------------------------------------
        XmlElement currentElement;
        XmlElement nodeAmt;
        XmlElement nodeEqvtAmt;        
    
        //          2.42: Amt
        nodeAmt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Amt'));
    
        //              2.43: InstdAmt
        if(subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'RC')
        {
            //          EqvtAmt
            nodeEqvtAmt = nodeAmt.appendChild(xmlDoc.createElement('EqvtAmt'));

            if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' &&
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')          ||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' &&
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW')          ||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' &&
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD')          ||
               ((mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XOF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XAF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XPF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'BIF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KMF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'GNF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'HUF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'ISK' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'IDR' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'JPY' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'LAK' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'PYG' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RWF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'UGX' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VUV' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VND' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')&&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL))        //SKS#DevOps:17344
            {
                //              Amt
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeEqvtAmt, 'Amt', num2str(this.getPositiveAmount(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1),0,0,0,0));
            }
            else
            {
                //              Amt
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeEqvtAmt, 'Amt', num2str(this.getPositiveAmount(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1),0,2,1,0));
            }

            SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);           
            //              CcyOfTrf
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeEqvtAmt, 'CcyOfTrf', mSKS_EFT_FileDetail.DepBankCurrency);
        }
        else
        {
            if(((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CL'   ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KR'   ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TW')  &&
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode != 'CBFT-442'&&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != 'CB-392'))       ||
               ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' &&
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')          ||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' &&
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW')          ||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' &&
                                  mSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD'))  ||
                ((mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XOF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XAF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XPF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'BIF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KMF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'GNF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'HUF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'ISK' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'IDR' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'JPY' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'LAK' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'PYG' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RWF' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'UGX' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VUV' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VND' ||
                 mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')&&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL))      //SKS#DevOps:17344
            {
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAmt, 'InstdAmt', num2str(this.getPositiveAmount(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1),0,0,0,0));
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP' &&              //SKS_VSTS_12116
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == 'DOM-391' ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == 'BKT-410'))
            {
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAmt, 'InstdAmt',num2Str(this.getPositiveAmount(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1),0,0,0,0));
            }
            else
            {
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAmt, 'InstdAmt', num2str(this.getPositiveAmount(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1),0,2,1,0));
            }
            SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Cdtr_Nm</Name>
				<Source><![CDATA[
    [SuppressBPWarning('BPErrorSelectUsingFirstOnly', 'The buffer is used in next statement or in a datasource query loop.')]
    protected void node_CdtTrfTxInf_Cdtr_Nm(XmlElement _nodeCdtr)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.79: Cdtr
        //              Nm
        //------------------------------------------------------------------------------------------------------
        int len;
        str name = mSKS_EFT_FileDetail.AccountName;

        select firstonly msks_EFT_FileDetail_BankAddress where
            msks_EFT_FileDetail_BankAddress.RefRecId == mSKS_EFT_FileDetail.RecId &&
            msks_EFT_FileDetail_BankAddress.AddressType == SKS_EFT_AddressType::VendBankAddress;

        EventHandlerResult result = new EventHandlerResult();

        this.node_CdtTrfTxInf_Cdtr_Nm_delegate(mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, result);

        if(!result.result())
        {
            if(mRemittanceName != '')
            {
                name = mRemittanceName;
            }
            switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
            {
                case #ATPAY403:
                    len = 20;
                    name = strUpr(name);
                    break;
                case #CHECK405:
                case #CHK396:
                case #CHK420:       //SKG#VSTS:11471
                case #CHK423:       //SKG#VSTS:11471
                case #BKT547:       //SKG#VSTS:11518
                case #SEPA:         //SKG#VSTS:12473
                case #DFT541:       //SKG#VSTS:15853
                case #RTGS539:      //SKG#VSTS:15853
                case #TRADE:        //SKS#DevOps:18732  
                    len = 70;
                    break;
                case #DOM391:
                case #CB392:        //SKG#VSTS:11471
                case #BKT393:
                case #ACH809:       
                case #WIRE574:      
                case #WIRE392:      
                case #CDFT392:
                case #SIP962:
                case #TAX592:       //SKG#VSTS:12473
                case #VAT984:       //SKG#VSTS:12473
                case #DOM540:       //SKS_VSTS_13253
                case #CTX950:       //SKG#VSTS:13477
                case #CDM950:       //SKG#VSTS:13477
                case #CHK950:       //SKG#VSTS:13477
                case #FT499:       //SKG#DevOps:15095
                case #IFT_CB392:    //SKG#DevOps:15853
                case #CHK19:        //SKG#DevOps:16961
                case #ACHCCP:       //SKG#DevOps:17066
                case #DOM789:       //SKG#DevOps:17266
                case #DOM903:       //SKG#DevOps:17266
                case #FT607:       //SKG#DevOps:17555
                    len = 35;
                    break;
                case #DE397:
                    len = 32;
                    break;
                case 'DFT-603':
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CA')
                    {
                        len =35;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                case #ACH_WL:
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU')
                    {
                        len = 35;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA')
                    {
                        len = 30;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG')
                    {
                        len = 20;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB')
                    {
                        len = 18;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US')
                    {
                        len = 22;
                    }
                    break;
                case #DFT391:
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')         //SKS#DevOps:16681
                    {
                        len = 35;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                case #DOM555:
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR ')
                    {
                        len = 35;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')     //SKS#VSTS:14212
                    {
                        len = 16;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                case #WIRE_WL:
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BA' ||      //SKS#DevOps:16138
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BB' ||      //SKS#DevOps:16237
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK' ||      //SKS#DevOps:16428
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG' ||      //SKS#DevOps:16946
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||      //SKS#DevOps:16946
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM' ||      //SKS#DevOps:16946
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NI' ||      //SKS#DevOps:19613
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GM' ||      //SKS#DevOps:17970
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MV' ||       //SKS#DevOps:20079
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JM' ||       //SKS#DevOps:19378
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GN')         //SKS#DevOps:21269
                    {
                        len = 105;
                    }
                    else
                    {
                        len = 35;
                    }
                    break;
                case #SEPA_WL:
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU')
                    {
                        len = 35;
                    }
                    else
                    {
                        len = 105;
                    }
                    break;
                case #CHK_WL:
                    len = 35;
                    break;
                case #ACH410:
                    len = 48;
                    if(msks_EFT_FileDetail_BankAddress.BankAccountNameKana_JP)
                    {
                        name = msks_EFT_FileDetail_BankAddress.BankAccountNameKana_JP;
                    }
                    break;
                case #WIRE391:     
                    len = 48;
                    break;
                case #GIRO421:     //SKG#VSTS:11471
                case #PRL422:      //SKG#VSTS:11471
                    len = 20;
                    break;
                case #CBFT574:      //SKG#VSTS:11518
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'  ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'  ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL'  ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')     //SKS#VSTS:14212
                    {
                        len = 35;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                case #CBFT392:      //SKG#VSTS:11518
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL' ||   //SKS#DevOps:16141
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN' ||    //SKS#DevOps:16681
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO' ||     //SKS#DevOps:17266
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU')
                    {
                        len = 35;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                case #DFT555:      //SKG#VSTS:12473
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'  ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'  ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                    {
                        len = 20;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                    {
                        len = 35;
                    }
                    break;
                case #PPW_WL:      //SKS#VSTS:14271
                case #PPW_PH_WL:   //SKS#DevOps:14542
                    len = 140;      //SKS#DevOps:19720
                    break;
                case #INSTPAY:      //DevOps20744 (Port 20684)
                    len = 80;
                    break;
                case #SEPA938:      //SKS#DevOps:21041
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                    {
                        len = 70;
                    }
                    else
                    {
                        len = 140;
                    }
                    break;
                default:
                    len = 140;
                    break;
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410   ||           
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391)             
            {
                //              Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtr, 'Nm', this.CharacterReplacement(strUpr(name)), len);
            }
            else
            {
                //              Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtr, 'Nm', this.CharacterReplacement(name), len);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAcct</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_CdtrAcct(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.80: CdtrAcct
        //              Id
        //                  Othr
        //                  Id
        //              Tp/Ptry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeCdtrAcct;
        XmlElement nodeCdtrAcctId;
        XmlElement nodeCdtrAcctIdOthr;
        XmlElement nodeCdtrAcctTp;
        VendBankAccount mVendBankAccount;
        str value;
        int length;
    
        if(mSKS_EFT_FileFormatPaymSpec.UseCheckNumber == NoYes::No  &&
           subStr(mSKS_EFT_FileDetail.PaymSpec, 1, 3) != 'CHK'      &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK427 &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK416 &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK815 &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK405 &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BPAY889  )

        {
            //          2.80: CdtrAcct
            value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenAcctTpCd', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
            nodeCdtrAcct = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('CdtrAcct'));
    
            //              Id
            nodeCdtrAcctId = nodeCdtrAcct.appendChild(xmlDoc.createElement('Id'));
    
            if(mSKS_EFT_FileDetail.DepBankAcct && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574      &&
               mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-RO')     //SKG#DevOps:17266
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, 24);
            }
            else if((!(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CACH460     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_KID     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE       ||  //SKG#DevOps:18732
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DC417       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS429     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS430     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT602      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT604     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT547      ||                  //SKG#VSTS:10808
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS29       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH208      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM317      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM325      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809      ||          //SKG#VSTS:10574
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574     ||          //SKG#VSTS:10574
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410      ||          //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391     ||          //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392     ||          //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #LLG408      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG527      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL426      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391      ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL422      ||          //SKG#VSTS:11471
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555      ||          //SKG#VSTS:12473
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #XPRS888     ||          //SKG#VSTS:12473
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541      ||          //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539     ||          //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IFT_CB392   ||          //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDT862      ||          //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SIP962      ||          //SKS#DevOps:16527
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BFT551  )   &&
                mSKS_EFT_FileFormatPaymSpec.FormatId  != 'US-CITICONNECT-XML-MX' &&
                mSKS_EFT_FileFormatPaymSpec.FormatId  != 'US-CITICONNECT-XML-UY' &&     //SKS_VSTS_11880
                mSKS_EFT_FileFormatPaymSpec.FormatId  != 'US-CITICONNECT-XML-PY' &&     //SKS_VSTS_11880
                mSKS_EFT_FileDetail.DepBankIBAN != '')                      ||
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821 &&
                 mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-US' &&      //SKS_VSTS_21976
                 mSKS_EFT_FileDetail.DepBankIBAN != '')								||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC      &&
                mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-IT' &&
                mSKS_EFT_FileDetail.DepBankIBAN != '')                      ||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555      &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'&&
                mSKS_EFT_FileDetail.DepBankIBAN != '')                      ||
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392 &&
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB'&&
                 this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) != 'GB'&&
                 mSKS_EFT_FileDetail.DepBankIBAN != '')||      //SKS#DevOps:17871,20008
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392 &&
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB'&&
                 this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'GB' && mSKS_EFT_FileDetail.DepBankAcct=='')||//DevOps18552
                ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555  &&             //SKG#VSTS:12473
                  mSKS_EFT_FileFormatPaymSpec.FormatId  != 'US-CITICONNECT-XML-CZ')&&
                 mSKS_EFT_FileDetail.DepBankIBAN != '')                       ||
                 (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392      &&
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL'&&
                  mSKS_EFT_FileDetail.DepBankIBAN != ''))                  //SKG#DevOps:21041
            {
                //                  IBAN
                nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_SEPA     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM332       &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA938      &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #RTGS605      &&  //SKG#VSTS:14212
                ((mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB_WIRE        ||
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-DE') &&
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_DC          ||
                mSKS_EFT_FileFormatPaymSpec.FormatId  != 'US-CITICONNECT-XML-IT')))
            {
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD   ||                    
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT500  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CACH460 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT602  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT604 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS28   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS29   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM317  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH208  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT441  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT827 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DIT828  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DPRL831 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DPENS832||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541  ||          //SKG#DevOps:15853
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539 ||          //SKG#DevOps:15853
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT833)
                {
                    if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
                    {
                        value = 'SVGS';
                    }
                    else
                    {
                        value = 'CACC';
                    }
                }
    
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));
    
                switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                {
                    case #DOM391:
                    case #CB392:
                    case #IBRS429:
                    case #IBRS430:
                    case #CBFT574:
                    case #CBFT442:
                    case #LLG408:
                    case #DOM540:
                    case #BKT410:
                    case #PLG527:
                    case #WIRE574:              //SKG#VSTS:10574
                    case #WIRE392:              //SKG#VSTS:10575
                    case #CDFT392:
                    case #BFT551:
                    case #RTGS539:              //SKS#DevOps:15853
                    case #IFT_CB392:            //SKS#DevOps:15853
                    case #CDT862:               //SKS#DevOps:15853
                    case #TRADE:
                        length = 34;
                        break;
                    case #DOM789:               //SKS#DevOps:17266
                        length = 24;
                        break;
                    case #CBFT392:
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL' ||  //SKS#DevOps:16141
                           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')     //SKS#DevOps:16681
                        {
                            length = 34;
                        }
                    case #ACH964:
                    case #DFT555:
                    case #DFT914:
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ')
                        {
                            length = 17;
                        }
                        else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                        {
                            length = 26;
                        }
                        else
                        {
                            length = 30;
                        }
                        break;
                    case #DC417:
                    case #DL454:
                    case #BKT547:                           //SKG#VSTS:10808
                        length = 10;
                        break;
                    case #BKT393:
                        length = ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NZ' ||
                                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU' ||
                                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP' )? 10 : 34);
                        break;
                    case #ACHCCP:
                    case #ACHPPP:
                    case #CTX17:
                    case #CCDP14:
                    case #CPS706:
                    case #DOM317:
                    case #DOM555:
                        switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                        {
                            case 'US-CITICONNECT-XML-TR':
                                length = 34;
                                break;
                            case 'US-CITICONNECT-XML-UA':
                                length = 14;
                                break;
                            case 'US-CITICONNECT-XML-TN':
                                length = 20;
                                break;
                            case 'US-CITICONNECT-XML-IL':       //SKS#VSTS:14212
                                length = 9;
                                break;
                            default:
                                length = 17;
                                break;
                        }
                        break;
                    case #DOM441:
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-BR'  ||
                           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VE')
                        {
                            length = 34;
                        }
                        else
                        {
                            length = 35;
                        }
                        break;
                    case #ACH780:
                        length = 12;
                        break;
                    case #ACH208:
                        length = 14;
                        break;
                    case #DOM903:
                    case #ACH150:
                        length = 16;
                        break;
                    case #DOM548:                    
                    case #TLPAY451:
                        length = 20;
                        break;                   
                    case #ACH809:
                        length = 13;
                        break;
                    case #ACH410:       //SKG#VSTS:10575
                    case #WIRE391:      //SKG#VSTS:10575
                        length = 7;
                        break;
                    case #BKT440:
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-UY')
                        {
                            length = 10;
                        }
                        else
                        {
                            length = 35;
                        }
                        break;
                    case #RT453:
                        length = 35;
                        break;
                    case #DE397:
                    case #ATPAY403:
                        length = 9;
                        break;
                    case #PLG400:
                    case #PRL401:
                        length = 32;
                        break;
                    case #PRL414:
                    case #ATPAY424:
                    case #PRL426:
                        length = 15;
                        break;
                    case #GIRO421:
                        length = 11;
                        break;
                    case #DOM325:
                        length = 26;
                        break;
                    case #DFT391:
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG' ||
                           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')     //SKS#DevOps:16681
                        {
                            length = 34;
                        }
                        break;
                    case #SIP962:
                        length = 8;
                        break;
                    case #TAX592:       //SKG#VSTS:12473
                    case #VAT984:       //SKG#VSTS:12473
                        length = 26;
                        break;
                    case #DFT541:       //SKG#DevOps:15853
                        length = 30;
                        break;
                    default:
                        length = 0;
                        break;
                }
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_BG)                      //SKG#VSTS:7132
                {
                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, length);
                }
                else
                {
                    //                         Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', SKS_PP_StringFormats::strFill(10, mSKS_EFT_FileDetail.DepBankAcct, SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
                }
            }
    
            //              Tp
            //                  Cd/Ptry
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)                          //VSTS_12838
            {
                mVendBankAccount = VendBankAccount::findByCompany(mSKS_EFT_FileDetail.AccountCompany, mSKS_EFT_FileDetail.AccountNum, mSKS_EFT_FileDetail.DepBankAccountId);
                
                switch(mVendBankAccount.TransType_JP)
                {
                    case VendBankTransType_JP::Checking:
                        value = 'TO';
                        break;
                    case VendBankTransType_JP::OrdinarySavings:
                        value = 'FU';
                        break;
                    case VendBankTransType_JP::Others:
                        value = 'SO';
                        break;
                    case VendBankTransType_JP::Savings:
                        value = 'TI';
                        break;
                    default:
                        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenAcctTpPrtry', mSKS_EFT_FileDetail.RecId));
                        break;
                }
                if(value)
                {
                    nodeCdtrAcctTp = nodeCdtrAcct.appendChild(xmlDoc.createElement('Tp'));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Prtry', value);
                }
            }
            else if((value == 'SVGS' || value == 'CACC') && mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH809)
            {
                nodeCdtrAcctTp = nodeCdtrAcct.appendChild(xmlDoc.createElement('Tp'));
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Cd', value);
            }
            else if (value != '')
            {
                nodeCdtrAcctTp = nodeCdtrAcct.appendChild(xmlDoc.createElement('Tp'));

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809)
                {
                    if(value == 'CACC')
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Prtry', '1');
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Prtry', '2');
                    }
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Prtry', value);
                }
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE)
            {
                //          Ccy
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcct, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398 ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789)
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcct, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneName)); //SKS_FDD_10590
                
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAgt</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_CdtrAgt(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.77: CdtrAgt
        //              FinInstnId
        //                  BIC
        //                  ClrSysMmbId
        //                  Nm
        //                  PstlAdr
        //              BrnchId
        //                  Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeCdtrAgt;
        XmlElement nodeFinInstnId;
        XmlElement nodeClrSysMmbId;     //SKS_VSTS_13694
        XmlElement nodeClrSysId;        //SKS_VSTS_13694
        XmlElement nodeBrnchId;
        str value;
        
        EventHandlerResult result = new EventHandlerResult();

        this.node_CdtTrfTxInf_RmtInf_CdtrAgt_delegate(_nodeCdtTrfTxInf,mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_FileDetail_BenBank, mSKS_EB_CharacterReplacement, xmldoc, result);

        if(!result.result())
        {
            if((mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK815 &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK416 &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK427 &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK804   &&                      //SKG#VSTS:7453
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK19    &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK585   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK20    &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH208   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT440   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK478   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK405   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK436   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TRADE    &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TLPAY451 &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DD437    &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK418   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK425   &&
               mSKS_EFT_FileFormatPaymSpec.PaymSpec        != 'CHK-443' &&
               mSKS_EFT_FileFormatPaymSpec.PaymSpec        != 'CHK-445' &&
               mSKS_EFT_FileFormatPaymSpec.PaymSpec        != 'CHK-455' &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK415   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHECK405 &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK396   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BPAY889  &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK950   &&        //SKG#VSTS:13477
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK402   &&          //SKS_VSTS_12162
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK420   &&        //SKG#VSTS:11471
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK423   &&        //SKG#VSTS:11471
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT547   &&        //SKG#VSTS:11518
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #RTGS605  &&        //SKG#VSTS:14212
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK815) ||        //SKG#VSTS:10808
               (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-DO' &&
               mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'CHK-465' &&
               (mSKS_EFT_FileDetail.DepSwiftNo != '' || mSKS_EFT_FileDetail.DepBankTransit != '')))

            {
                //          2.77: CdtrAgt
                nodeCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('CdtrAgt'));

                //              FinInstnId
                nodeFinInstnId = nodeCdtrAgt.appendChild(xmlDoc.createElement('FinInstnId'));

                if((mSKS_EFT_FileDetail.DepSwiftNo != '' || mSKS_EFT_FileDetail.DepBankTransit)&&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
                    lSKS_PP_Setup.RegCustomerID == 'fc3ce6') //SKS#DevOps:19784
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 0, false);

                    if(mSKS_EFT_FileDetail.DepBankTransit)
                    {
                        nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit);
                    }
                }
                else if((mSKS_EFT_FileDetail.DepSwiftNo != '' &&
                    !(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT500            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY             ||      //DevOps20744 (Port 20684)
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DC417               ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS429             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS430             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391              ||      //SKG#VSTS:7570
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391RT            ||      //SKG#VSTS:7570
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17               ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM325              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM332              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410              ||              //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391             ||              //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453               ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454               ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397               ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #LLG408              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL422              ||              //SKG#VSTS:11471
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL426              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BWPMT835            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT441              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DIT828              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DPRL831             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DPENS832            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SIP962              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603              ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555              ||             //SKG#VSTS:12473
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #XPRS888             ||             //SKG#VSTS:12473
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX592              ||             //SKG#VSTS:12473
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #VAT984              ||             //SKG#VSTS:12473
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499               ||             //SKG#DevOps:16878
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC              ||             //SKG#DevOps:16877
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541              ||             //SKG#DevOps:15853
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539             ||             //SKG#DevOps:15853
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392               ||             //SKG#DevOps:22102
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-DE'    &&             //SKG#VSTS:7343
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC))          ||
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'    &&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391 &&
                     mSKS_EFT_FileDetail.DepBankTransit == '')                          ||                    
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG')   ||
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391             &&             //SKG#VSTS:9790
                     mSKS_EFT_FileDetail.DepSwiftNo                                     &&
                     (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK'   ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KR'))  ||
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392             &&             //SKG#VSTS:22102
                     mSKS_EFT_FileFormat.FormatId != 'US-CITICONNECT-XML-MO'           &&
                     mSKS_EFT_FileDetail.DepSwiftNo)                                   ||
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT555             &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-CZ'   ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-PL')))||
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555             &&                  //SKG#VSTS:10808
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TN'    &&
                     mSKS_EFT_FileDetail.DepBankTransit == ''  && mSKS_EFT_FileDetail.DepSwiftNo)||
                     (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499              &&                  //SKG#DevOps:16878
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US'    &&
                      mSKS_EFT_FileDetail.DepSwiftNo && (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId != 'USA' ||
                    (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId =='' && mSKS_EFT_FileDetail.DepBankTransit =='')))|| //DevOps18567
                     (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC              &&                //SKG#DevOps:16877
                      mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-GB'     &&
                      mSKS_EFT_FileDetail.DepSwiftNo != ''))
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 0, false);

                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392 &&               //SKS_VSTS_13694--->
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB'&&
                       mSKS_EFT_FileDetail.DepBankIBAN == '')                           //SKS#VSTS:14490
                    {
                        nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                        nodeClrSysId = nodeClrSysMmbId.appendChild(xmlDoc.createElement('ClrSysId'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysId, 'Cd', 'IS', 0, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit);   //SKS#VSTS:14490
                    }//SKS_VSTS_13694<---
                }
                else if(mSKS_EFT_FileDetail.DepSwiftNo != '' &&
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392 &&
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB') //sks#DevOps:20959
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 0, false);
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL' &&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)       //SKS#devOps:16141
                {
                    //                  ClrSysMmbId
                    this.node_CdtTrfTxInf_CdtrAgt_MmbId(nodeFinInstnId);
                }
                else if(((mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-GB'    ||  //SKG#VSTS:4420
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB_WIRE     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_SEPA))  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT392     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB392       &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH964      &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT555      &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT574     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA848     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA939     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA938     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT914      &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392)       ||               //SKG#VSTS:10575
                    ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ' ||
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL' ||            //SKG#VSTS:14212
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL' || 
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO'  ||
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU')  &&
                     (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574)||
                    (mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN'&&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)))
                {
                    //                  ClrSysMmbId
                    this.node_CdtTrfTxInf_CdtrAgt_MmbId(nodeFinInstnId);
                }
    
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499    ||
                    mSKS_EFT_FileFormatPaymSpec.PaymSpec == #ACH502         ||
                    mSKS_EFT_FileFormatPaymSpec.PaymSpec == #ACH503         ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT604 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM332  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397   ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821||          //SKS#DevOps:20423
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #LLG408  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IFT_CB392 ||             //SKG#VSTS:15853
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392 ||               //SKG#VSTS:10575
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574 &&              //SKG#VSTS:10574
                    mSKS_EFT_FileDetail.DepSwiftNo == '')                   ||
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392 &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN'&&
                     mSKS_EFT_FileDetail.DepSwiftNo == '')                       ||         //SKS#DevOps:16681
                   ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')&&     //SKG#VSTS:14212
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555) ||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574 &&                          //SKG#VSTS:10808
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == 'US-CITICONNECT-XML-TN'  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == 'US-CITICONNECT-XML-IL'  ||          //SKG#VSTS:14212
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO'||    //SKG#DevOps:17266
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU'||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == 'US-CITICONNECT-XML-TR'))||           //SKG#VSTS:11518
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL'&&     //SKG#DevOps:16141
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392))
                {
                    //                  Nm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankName), 0, false); //SKS_FDD_10590
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574 &&
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')     //SKS#DevOps:21738
                {
                    //                  Nm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankName), 35, false);
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 &&
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')     //SKS#DevOps:16681
                {
                    //                  Nm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankName + mSKS_EFT_FileDetail_BenBank.BenBankBranch), 35, false);
                }
    
                switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                {
                    case #WIRE574:                      //SKG#VSTS:10574
                        if(mSKS_EFT_FileDetail.DepSwiftNo == '' && mSKS_EFT_FileDetail_BenBank.BenBankName != '') //SKS_FDD_10590
                        {
                            //                  PstlAdr
                            this.node_CdtTrfTxInf_CdtrAgt_PstlAdr(nodeFinInstnId);
                        }
                        break;
                    default:
                        //                  PstlAdr
                        this.node_CdtTrfTxInf_CdtrAgt_PstlAdr(nodeFinInstnId);
                        break;
                }

                if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY && mSKS_EFT_FileDetail_BenBank.BenBankBranch != '') //DevOps20744 (Port 20684)
                {
                    nodeBrnchId = nodeCdtrAgt.appendChild(xmlDoc.createElement('BrnchId'));
                
                        //                  Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', mSKS_EFT_FileDetail_BenBank.BenBankBranch);
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_SEPA &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_DC  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_KID &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_PG  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB_WIRE &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_BG  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT602  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT603  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT604 &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS28   &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS29   &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #USFCP821&&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH809    &&                  //SKG#VSTS:10574
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE574   &&                  //SKG#VSTS:10574
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH410    &&                  //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE391   &&                  //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392   &&                  //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS706  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH780  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CDFT392 &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK815  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT547  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN'&&            //SKS#DevOps:16681
                    !(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG')   &&
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM555  ||                  //SKG#VSTS:10808
                    mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITI-CONNECT-XML-TN'))
                {
                    //              BrnchId
                    value = SKS_EFT_Format::getCodelookupvalue('BenBrnchId', mSKS_EFT_FileDetail.RecId); //SKS_FDD_10590
                    if(value == '')
                    {
                        value = mSKS_EFT_FileDetail_BenBank.BenBankBranch; //SKS_FDD_10590
                    }
    
                    if((value != '' || mSKS_EFT_FileDetail_BenBank.BenBankName != '')   &&     //SKS_FDD_10590
                        !(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD   ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX   ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT500   ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499    ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853   ||                  //SKG#VSTS:11518
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555   ||                  //SKG#VSTS:11518
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574) &&                  //SKG#VSTS:11518
                        !(mSKS_EFT_FileDetail_BenBank.BenBankName != ''                 &&              //SKS_FDD_10590
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571))
                    {
                        if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KR'||           //SKS_VSTS_12116
                            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MO')&&           //SKS#DevOps:22102
                            (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391 ||
                            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392))
                        {
                            if(mSKS_EFT_FileDetail_BenBank.BenBankBranch)
                            {
                                nodeBrnchId = nodeCdtrAgt.appendChild(xmlDoc.createElement('BrnchId'));

                                //              Nm
                                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                            }
                        }
                        else
                        {    
                            nodeBrnchId = nodeCdtrAgt.appendChild(xmlDoc.createElement('BrnchId'));

                            if(value != '')
                            {
                                //              Id
                                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', this.CharacterReplacement(value));
                            }
    
                            if(mSKS_EFT_FileDetail_BenBank.BenBankName != '' && mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WLW571)  //SKS_FDD_10590
                            {
                                //              Nm
                                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankName));  //SKS_FDD_10590
                            }
                        }
                    }
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAgt_MmbId</Name>
				<Source><![CDATA[
    /// <summary>
    /// CdtrAgt 
    /// </summary>
    /// <param name = "_nodeFinInstnId">CdtrAgt_MmbId</param>
    protected void node_CdtTrfTxInf_CdtrAgt_MmbId(XmlElement _nodeFinInstnId)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.77: CdtrAgent
        //          MmbId
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeClrSysMmbId;
        XmlElement nodeClrSysId;
        str value;
        int len;
    
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenBankRC', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
    
        if(value != '')
        {
            nodeClrSysMmbId = _nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', value, 0, false);
        }
        else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574 || //SKS#DevOps:16141
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)&&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')            //SKS#VSTS:14212
        {
            nodeClrSysMmbId = _nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

            nodeClrSysId = nodeClrSysMmbId.appendChild(xmlDoc.createElement('ClrSysId'));
            if(mSKS_EFT_FileDetail.DepSwiftNo)
            {
                value = 'IS';
            }
            else if(mSKS_EFT_FileDetail.DepBankTransit)
            {
                value = 'FW';
            }
            else
            {
                value = 'OT';
            }
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysId, 'Cd', value, 0, false);

            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, 11, false);
        }
        else if(mSKS_EFT_FileDetail.DepBankTransit != '')
        {
            nodeClrSysMmbId = _nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));
    
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571)
            {
                nodeClrSysId = _nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysId'));
                switch(mSKS_EFT_FileDetail.DepBankCodeType)
                {
                    case BankCodeType::Code_SC:
                        value = 'GBSC';
                        break;
                    case BankCodeType::Code_FW:
                        value = 'USFW';
                        break;
                }
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysId, 'Id', value, 0, false);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB' &&              //SKS_VSTS_13694--->
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392)
            {
                if(mSKS_EFT_FileDetail.DepBankIBAN == '')       //SKS#DevOps:20315
                {
                    value = 'IS';
                }
                else
                {
                    switch(this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId))
                    {
                        case 'GB':
                            value = 'SC';
                            break;
                        case 'IE':
                            value = 'IE';
                            break;
                        case 'US':
                            value = 'USFW';
                            break;
                    }
                }

                if(value)
                {
                    nodeClrSysId = nodeClrSysMmbId.appendChild(xmlDoc.createElement('ClrSysId'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysId, 'Cd', value, 0, false);
                }
            }              //SKS_VSTS_13694<---
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG)
            {
                nodeClrSysId = nodeClrSysMmbId.appendChild(xmlDoc.createElement('ClrSysId'));
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysId, 'Cd', 'SESBA', 0, false);
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG)          //SKG#VSTS:7312
            {
                //                         Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', SKS_PP_StringFormats::strFill(10, mSKS_EFT_FileDetail.DepBankTransit, SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
            }
            else
            {
                switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                {
                    case #ACH809:                //SKG#VSTS:10574
                    case #TAX592:                //SKG#VSTS:12473
                        len = 6;
                        break;
                    case #ACH410:                //SKG#VSTS:10575
                    case #WIRE391:               //SKG#VSTS:10575
                    case #GIRO421:               //SKG#VSTS:11471
                    case #PRL422:                //SKG#VSTS:11471
                    case #DFT541:                //SKG#DevOps:15853
                    case #RTGS539:               //SKG#DevOps:15853
                        len = 11;
                        break;
                    case #DFT391:                //SKG#VSTS:11471
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG'||
                           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')         //SKS#DevOps:16681
                        {
                            len = 11;                            
                        }
                        break;
                    case #DOM555:                //SKG#VSTS:11518
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')     //SKS#VSTS:14212
                        {
                            len = 5;
                        }
                        else
                        {
                            len = 12;
                        }
                        break;
                    case #DOM441:                //SKS_VSTS_11880
                        len = 0;
                        break;
                    case #CBFT442:              //SKS_VSTS_11880
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY' ||
                           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY')      //SKS_VSTS_12158
                        {
                            len = 11;
                        }
                        else
                        {
                            len = 0;
                        }
                        break;
                    case #DFT441:               //SKS_VSTS_12158
                        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY' ||
                            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY')
                        {
                            len = 3;
                        }
                        else
                        {
                            len = 0;
                        }
                        break;
                    case #XPRS888:                //SKG#VSTS:12473
                    case #DFT555:                 //SKG#VSTS:12473
                        len = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'? 7 : 8);
                        break;
                    case #VAT984:                //SKG#VSTS:12473
                        len = 8;
                        break;
                    case #CTX950:           //SKG#VSTS:13477
                    case #CDM950:           //SKG#VSTS:13477
                        len = 9;
                        break;
                    default:
                        len = 0;
                        break;
                }
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, len, false);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_ChqInstr</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_ChqInstr(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.52 ChqInstr
        //              2.58 DlvryMtd
        //              2.65 ChqMtrtyDt
        //              2.69: PrtLctn
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeChqInstr;
        XmlElement nodePrtLctn;
        XmlElement nodeDlvryMtd;
        XmlElement nodeDlvryTo;
        XmlElement nodeAdr;
        str value, DlvryMtd;
    
        //          2.52 ChqInstr
        nodeChqInstr = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('ChqInstr'));
    
        //              2.53 ChqTp
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Chqtp', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
        if(value != '')
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeChqInstr, 'ChqTp', value, 0, false);
        }
        if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585  ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950  ||      //SKS_VSTS_13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK436)  && mSKS_EFT_FileFormatPaymSpec.UseCheckNumber)
        {
            //              2.54 ChqNb
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeChqInstr, 'ChqNb', SKS_PP_StringFormats::strFill(10, mSKS_EFT_FileDetail.PaymentReference, SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
        }

        //                  2.59: Cd
        DlvryMtd = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DlvryMtd', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK416 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK427 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK815 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK804   ||  //SKG#VSTS:7453
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19    ||     //SKS#DevOps:21699
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK405   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK436   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DD437    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425   ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec        == 'CHK-443' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec        == 'CHK-445' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec        == 'CHK-455' ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK415   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK396   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK815   ||                  //SKG#VSTS:10808
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK420   ||                  //SKG#VSTS:11471
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK423   ||                  //SKG#VSTS:11471
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK402)                      //SKS_VSTS_12162
        {
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL && DlvryMtd)                                      //SKS#DevOps:17192
            {
                //              2.58 DlvryMtd
                nodeDlvryMtd = nodeChqInstr.appendChild(xmlDoc.createElement('DlvryMtd'));

                //                  2.59: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDlvryMtd, 'Cd', DlvryMtd, 0, false);
            }

            if(DlvryMtd == 'CRDB' || DlvryMtd == 'MLDB' || DlvryMtd == 'RGDB' || DlvryMtd == 'PUDB')
            {
                //              2.61 DlvrTo
                nodeDlvryTo = nodeChqInstr.appendChild(xmlDoc.createElement('DlvrTo'));

                //              2.62 Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDlvryTo, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName));      //SKS_FDD_10590

                //              2.63 Adr
                nodeAdr = nodeDlvryTo.appendChild(xmlDoc.createElement('Adr'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'StrtNm', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr), 0, false);        //SKS_FDD_10590
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'BldgNb', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2), 16, false);       //SKS_FDD_10590
                
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20 ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)       //SKS#DevOps:21699
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'PstCd', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode), 0, false);       //SKS#DevOps:17783
                }
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'TwnNm', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity), 0, false);     //SKS_FDD_10590

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)  //SKS#DevOps:21699
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'CtrySubDvsn', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyState), 0, false);     //SKS#DevOps:21699
                }
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'Ctry', this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId));        //SKS_FDD_10590
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK19)      //SKS#DevOps:21699
            {
                //              2.61 DlvrTo
                nodeDlvryTo = nodeChqInstr.appendChild(xmlDoc.createElement('DlvrTo'));

                //              2.62 Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDlvryTo, 'Nm', this.CharacterReplacement(mRemittanceName));

                //              2.63 Adr
                nodeAdr = nodeDlvryTo.appendChild(xmlDoc.createElement('Adr'));

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'Ctry', this.getLogisticsAddressCountryISO(mRemittanceCountryRegionId));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'AdrLine', this.CharacterReplacement(mRemittanceAdrline1), 0, false);
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'AdrLine', this.CharacterReplacement(mRemittanceCity), 0, false);
                }
                else
                {
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20 && mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CA')
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'StrtNm', this.CharacterReplacement(mRemittanceStreet), 70, false);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'StrtNm', this.CharacterReplacement(mRemittanceAdrline1), 0, false);
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'BldgNb', this.CharacterReplacement(mRemittanceAdrline2), 16, false);
                    }

                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL ||
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20)       //SKS#DevOps:17783
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'PstCd', this.CharacterReplacement(mRemittanceZipCode), 0, false);
                    }

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'TwnNm', this.CharacterReplacement(mRemittanceCity), 0, false);

                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'CtrySubDvsn', this.CharacterReplacement(mRemittanceState), 0, false);
                    }

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'Ctry', this.getLogisticsAddressCountryISO(mRemittanceCountryRegionId));
                }
            }

        }
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT440   &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM441   &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #RT453    &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DD437	&&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL	&&
		   mSKS_EFT_FileFormatPaymSpec.PaymSpec != 'CHK-445'        &&
           mSKS_EFT_FileFormatPaymSpec.PaymSpec != 'CHK-465'        &&
           mSKS_EFT_FileFormatPaymSpec.PaymSpec != 'INSTPAY')           //DevOps20744 (Port 20684)
        {
            //              2.65 ChqMtrtyDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeChqInstr, 'ChqMtrtyDt', SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_File.EffectiveDate, DateSeparator::Hyphen), 0, false);
        } 
    
        //              22.69: PrtLctn
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DestBrnch', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
        if(value != '')
        {
            nodePrtLctn = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeChqInstr, 'PrtLctn',value);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_ChrgBr</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_ChrgBr(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.51: ChrgBr
        //------------------------------------------------------------------------------------------------------
        str value;
    
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ChrgBr', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL && mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ')
        {
            value = 'OUR';
        }

        if(value == '')
        {
            switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
            {
                case #DOM555:
                    value = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KE' ? 'DEBT' : '');
                    break;
                default:
                    value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ChrgBr', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
                    break;
            }
        }
        
        if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TN' &&                        //SKG#VSTS:10808
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT547) && value == '')
        {
            value = 'OUR';
        }

        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821)            //SKS_VSTS_13397
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtTrfTxInf, 'ChrgBr', 'SHAR');
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtTrfTxInf, 'ChrgBr', strUpr(value), 0, false);
        }
        else
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtTrfTxInf, 'ChrgBr', value, 0, false);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_InstrForCdtrAgt</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_InstrForCdtrAgt(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.82: InstrForCdtrAgt
        //              InstrInf
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeInstrForCdtrAgt;
        str value, CNS1, CNS2;
        str instrInfvalue;
        str addressinf;

        VendBankAccount                 mVendBankAccount;
    
        EventHandlerResult result = new EventHandlerResult();
        

        mVendBankAccount = VendBankAccount::findByCompany(mSKS_EFT_FileDetail.AccountCompany, mSKS_EFT_FileDetail.AccountNum, mSKS_EFT_FileDetail.DepBankAccountId);
        this.node_CdtTrfTxInf_InstrForCdtrAgt_delegate(_nodeCdtTrfTxInf,mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_FileDetail_BenBank, msKS_EFT_FileDetail_CreditParty, mVendBankAccount, xmldoc, result);

        if(!result.result())
        {
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                 this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'ZW'))
            {
                this.getEmailandTelephonenumber();

                if(email)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(email, 1, 30));

                    if(strLen(email) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(email, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL ||mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL_RC) &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US')    ||
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499))//DevOps18352
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName || msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', 'FFC');
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf',subStr( this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    if(strLen(msKS_EFT_FileDetail_CreditParty.CrePartyName) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(msKS_EFT_FileDetail_CreditParty.CrePartyName, 31, 35));
                    }
                    if(strLen(msKS_EFT_FileDetail_CreditParty.CrePartyName) > 65)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(msKS_EFT_FileDetail_CreditParty.CrePartyName, 66, 35));
                    }
                    if(strLen(msKS_EFT_FileDetail_CreditParty.CrePartyName) > 100)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(msKS_EFT_FileDetail_CreditParty.CrePartyName, 101, 35));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG')
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/DTYPE/PORD');

                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/BAEREF/');

                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }


            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('UIN', mSKS_EFT_FileDetail.RecId));
            
                if(value)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(value, 1, 30));

                    if(strLen(value) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(value, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }                
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'SEK' &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE')
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/UTL/');

                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }            
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB_WIRE &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NL' ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB'))               //SKS#DevOps:17181, 17182
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CentralBankCode', mSKS_EFT_FileDetail.RecId));
            
                if(value)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', value);
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||                     
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HK' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MW' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BW' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CY' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DK' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FI' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JP' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KW' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LV' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LB' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LI' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MX' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MC' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ME' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-OM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-QA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RS' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SK' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SI' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ES' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UY' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZW')))
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL             &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET')         //SKS#DevOps:18131
            {
                if(mSKS_EFT_FileDetail_BenBank.BenBankBranch)
                {
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                }
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CA' &&
                    mSKS_EFT_FileFormatPaymSpec.PaymSpec ==#DFT603)
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB' &&
                    mSKS_EFT_FileFormatPaymSpec.PaymSpec ==#CDFT392)
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                if(mSKS_EFT_FileDetail_Intermediary.IntBankAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(mSKS_EFT_FileDetail_Intermediary.IntBankAcct, 1, 30), 35);

                    
                }
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-CN' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)            //SKS#VSTS:14428
            {
                CNS1 = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCodeCNS1', mSKS_EFT_FileDetail.RecId));
                CNS2 = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCodeCNS2', mSKS_EFT_FileDetail.RecId));

                if(CNS1)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    //                      InstrInf
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/CNS1/' + CNS1, 0, false);
                }
                if(CNS2)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    //                      InstrInf
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/CNS2/' +  CNS2, 0, false);
                }
                if((CNS1 || CNS2) && this.getInvoiceNbrs())
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    //                      InstrInf
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/CNIN/' + this.CharacterReplacement(this.getInvoiceNbrs()), 0, false);
                }
            }
            else if(mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-MO' &&
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392)           //SKS#DevOps:22102
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InstrInfMO', mSKS_EFT_FileDetail.RecId));

                if(value)
                {
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', 'CHEQUE/'+value);
                }
            }
            else if(((mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-CN' ||
                      mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-HK')&&
                      (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT896 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392)) ||
                      (mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-WL-XML-TH'&&
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL))
            {
                if((this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'HK' ||
                    mRemittanceCountryRegionId == 'HK') &&
                    (mSKS_EFT_FileDetail.PaymentCurrencyCode == 'USD'||
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'EUR' ||
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CNY' ||
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RMB'))
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/ACC/RTGS');
                }
                else if(mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-HK' &&
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392)           //SKS#DevOps:15468
                {
                    value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InstrInf', mSKS_EFT_FileDetail.RecId));

                    if(value)
                    {
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/REC/CHEQUE');

                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', this.CharacterReplacement(value));
                    }
                }
            }
            else if ( mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' &&
                      (mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WIRE_WL ||
                       mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WIRE_WL_RC))
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if ( mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' &&
                      (mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WIRE_WL_O ||
                       mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WIRE_WLORC))
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));
                
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/ACC/RMBCITISH');

                if(value)
                {
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(value), 1, 30));

                    if(strLen(value) > 30)
                    {
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(value), 31, 30));
                    }
                }
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PL')
            {
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                this.getBankPurposeCode();

                instrInfvalue = this.CharacterReplacement(bankCodeText);
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 1, 30));

                if(strLen(instrInfvalue) > 30)
                {
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL    &&
                    mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-WL-XML-PK')
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                addressinf = mSKS_EFT_FileDetail_BenBank.BenBankBranch + ' ' +
                             mSKS_EFT_FileDetail_BenBank.BenBankAddr + ' ' +
                             mSKS_EFT_FileDetail_BenBank.BenBankCity + ' ' +
                             this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId);

                if(addressinf)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 1, 30));
                
                    if(strLen(addressinf) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 31, 30));
                    }

                    if(strLen(addressinf) > 60)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 61, 30));
                    }

                    if(strLen(addressinf) > 90)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 91, 30));
                    }

                    if(strLen(addressinf) > 120)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 121, 30));
                    }

                    if(strLen(addressinf) > 150)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 151, 30));
                    }
                }

            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL    &&
                    mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-WL-XML-VN')
            {
                if(msKS_EFT_FileDetail_CreditParty.CrePartyName)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName), 1, 30));

                    instrInfvalue = 'FFC ' + this.CharacterReplacement(msKS_EFT_FileDetail_CreditParty.CrePartyName);

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                if(msKS_EFT_FileDetail_CreditParty.CrePartyAcct)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr('Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct, 1, 30));

                    instrInfvalue = 'Acc No ' + msKS_EFT_FileDetail_CreditParty.CrePartyAcct;

                    if(strLen(instrInfvalue) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(instrInfvalue, 31, 30));
                    }
                }

                addressinf = mSKS_EFT_FileDetail_VendAddress.BeneAddr + ' ' +
                             mSKS_EFT_FileDetail_VendAddress.BeneAddr2 + ' ' +
                             mSKS_EFT_FileDetail_VendAddress.BeneCity + ' ' +
                             mSKS_EFT_FileDetail_VendAddress.BeneState + ' ' +
                             mSKS_EFT_FileDetail_VendAddress.BeneZipPostal + ' ' +
                             this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_VendAddress.BeneCountryRegionId);

                if(addressinf)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 1, 30));

                    if(strLen(addressinf) > 30)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 31, 30));
                    }

                    if(strLen(addressinf) > 60)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 61, 30));
                    }

                    if(strLen(addressinf) > 90)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 91, 30));
                    }

                    if(strLen(addressinf) > 120)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 121, 30));
                    }

                    if(strLen(addressinf) > 150)
                    {
                        //          2.82: InstrForCdtrAgt
                        nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', subStr(this.CharacterReplacement(addressinf), 151, 30));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == #DOM391RT)      //SKG#VSTS:7509
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/REC/SCP');
            }

            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405)
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InstrForCdtrAgt', mSKS_EFT_FileDetail.RecId));
    
                if(value)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/HKLI/'+value);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574)            //SKG#VSTS:10574
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InstrForCdtrAgt', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
    
                if(value)
                {
                    //          2.82: InstrForCdtrAgt
                    nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', value);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR' &&
                    mSKS_EFT_FileFormatPaymSpec.PaymSpec == #SSK853)                    //SKG#VSTS:11518
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
            
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PaymPeriod', mSKS_EFT_FileDetail.RecId));    //SKS_FDD_10590
                if(value)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRSP/'+value);
                }
            
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('StampDutyAmt', mSKS_EFT_FileDetail.RecId));    //SKS_FDD_10590
                if(value)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRSA/'+value, 15);
                }
            
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('UnemploymentAmt', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
                if(value)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRUA/'+value, 15);
                }
            
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('NetpremiumAmt', mSKS_EFT_FileDetail.RecId));   //SKS_FDD_10590
                if(value)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRNA/'+value, 15);
                }

                //this.getLegalEntityPostalAddress();       //SKS_FDD_10590
            
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRLN/'+CompanyInfo::find().Name);     //SKS_FDD_10590
            
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRA1/'+ this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.Addr), 35);        //SKS_FDD_10590
            
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRA2/'+ this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.City), 35);        //SKS_FDD_10590
                    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/TRA3/'+ mSKS_EFT_FileDetail_BankAccount.ZipPostal +' '+ mSKS_EFT_FileDetail_BankAccount.CountryRegionId, 35);     //SKS_FDD_10590
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392 && mSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-JP')
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
                
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/REC/NRT');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555 &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')  //SKS#VSTS:14212
            {
                //          2.82: InstrForCdtrAgt
                nodeInstrForCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('InstrForCdtrAgt'));
                
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeInstrForCdtrAgt, 'InstrInf', '/ILTE/' + this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ILInstrInf', mSKS_EFT_FileDetail.RecId)));
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_IntrmyAgt1</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_IntrmyAgt1(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.71: IntrmyAgt1
        //              FinInstnId
        //                  BIC
        //                  ClrSysMmbId
        //                  PstlAdr
        //              BrnchId
        //                  Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeIntrmyAgt1;
        XmlElement nodeFinInstnId;
        XmlElement nodeBrnchId;
        XmlElement nodeClrSysMmbId;
        str country;

        if((mSKS_EFT_FileDetail_Intermediary.IntBankSwift != '' || mSKS_EFT_FileDetail_Intermediary.IntBankId != '') &&   //SKS_FDD_10590
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BPAY889 )
        {
            //          2.71: IntrmyAgt1
            nodeIntrmyAgt1 = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('IntrmyAgt1'));
    
            //              FinInstnId
            nodeFinInstnId = nodeIntrmyAgt1.appendChild(xmlDoc.createElement('FinInstnId'));
    
            if(mSKS_EFT_FileDetail_Intermediary.IntBankSwift != '' && mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS29)  //SKS_FDD_10590
            {
                //                  BIC
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail_Intermediary.IntBankSwift, 0, false);  //SKS_FDD_10590
            }
    
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574 && mSKS_EFT_FileDetail_Intermediary.IntBankSwift == '' && mSKS_EFT_FileDetail_Intermediary.IntBankName != '')             //SKG#VSTS:10574   //SKS_FDD_10590
            {
                //                  Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_Intermediary.IntBankName), 35, false);   //SKS_FDD_10590
    
                //                  PstlAdr
                this.node_PstlAdr(nodeFinInstnId, mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId, mSKS_EFT_FileDetail_Intermediary.IntBankAddr + '' + mSKS_EFT_FileDetail_Intermediary.IntBankAddr2, '', mSKS_EFT_FileDetail_Intermediary.IntBankCity);   //SKS_FDD_10590
            }
            if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603   ||                     //SKG#VSTS:13377
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392) &&
                mSKS_EFT_FileDetail_Intermediary.IntBankId != ''         &&
                mSKS_EFT_FileDetail_Intermediary.IntBankSwift == '')
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                country = this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId);

                switch(country)
                {
                    case 'AU':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//AU' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'CA':
                        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        }
                        else
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//CC' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        }
                        break;
                    case 'US':
                        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        }
                        else
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//FW' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        }
                        break;
                    case 'PR':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//FW' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        break;
                    case 'GH':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//GH' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'ZA':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//ZA' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'ZM':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//ZM' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'GB':
                        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        }
                        else
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//SC' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        }
                        break;
                    default:
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail_Intermediary.IntBankId, 0, false);
                        break;
                }
            }

            //                  ClrSysMmbId
            else  if(mSKS_EFT_FileDetail_Intermediary.IntBankId != ''           &&   //SKS_FDD_10590
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT604     &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #USFCP821    &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE574     &&     //SKG#VSTS:10574
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392     &&     //SKG#VSTS:10575
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT603      &&     //SKG#VSTS:13377
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #FT499       &&     //SKG#VSTS:13377
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CDFT392)
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail_Intermediary.IntBankId, 0, false);
            }
    
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392  ||     //SKG#VSTS:10575
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603   ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499    ||
               mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' || //SKS_VSTS_13890
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392)
            {
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
                {
                    //                  Nm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(strUpr(mSKS_EFT_FileDetail_Intermediary.IntBankName)), 140, false); //VSTS#12838
                }
                else
                {
                    //                  Nm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_Intermediary.IntBankName), 140, false); //SKS_FDD_10590
                }
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE574)
            {
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
                {
                    //                  PstlAdr
                    this.node_PstlAdr(nodeFinInstnId, mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId, strUpr(mSKS_EFT_FileDetail_Intermediary.IntBankAddr) + '' + strUpr(mSKS_EFT_FileDetail_Intermediary.IntBankAddr2), '', strUpr(mSKS_EFT_FileDetail_Intermediary.IntBankCity)); //VSTS#12838
                }
                else
                {
                    //                  PstlAdr
                    this.node_PstlAdr(nodeFinInstnId, mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId, mSKS_EFT_FileDetail_Intermediary.IntBankAddr + '' + mSKS_EFT_FileDetail_Intermediary.IntBankAddr2, '', mSKS_EFT_FileDetail_Intermediary.IntBankCity);        //SKS_FDD_10590
                }
            }

            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_SEPA  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_DC   &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_KID  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_PG   &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB_WIRE  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_BG   &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT602   &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT603   &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT604  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS28    &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS29    &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #USFCP821 &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH809   &&          //SKG#VSTS:10574
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE574  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH410   &&          //SKG#VSTS:10575`
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE391  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-MX')
            {
                //              BrnchId
                if(mSKS_EFT_FileDetail_Intermediary.IntBankBranch != '')        //SKS_FDD_10590
                {
                    nodeBrnchId = nodeIntrmyAgt1.appendChild(xmlDoc.createElement('BrnchId'));
                    //              Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', this.CharacterReplacement(mSKS_EFT_FileDetail_Intermediary.IntBankBranch));       //SKS_FDD_10590
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_IntrmyAgt1WL</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_IntrmyAgt1WL
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_IntrmyAgt1WL(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.71: IntrmyAgt1
        //              FinInstnId
        //                  BIC
        //                  ClrSysMmbId
        //                  PstlAdr
        //              BrnchId
        //                  Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeIntrmyAgt1;
        XmlElement nodeFinInstnId;
        XmlElement nodeBrnchId;
        XmlElement nodeClrSysMmbId;

        str country;
    
        if((mSKS_EFT_FileDetail_Intermediary.IntBankSwift != '' || mSKS_EFT_FileDetail_Intermediary.IntBankId != '') &&   //SKS_FDD_10590
          ((mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_WL  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE_WL &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_WL  &&          //SKS#VSTS:14271
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_PH_WL) ||       //SKS#DevOps:14542
            (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
            (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BS' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BJ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BM' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BF' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TD' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CY' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DK' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FI' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HK' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HU' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JP' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LB' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LI' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LU' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MU' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MX' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ME' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MM' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NL' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NP' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-OM' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PL' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-QA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RS' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SC' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SK' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SI' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ES' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TT' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UY' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AO' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GE' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LV' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MC' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SZ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TR' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FJ' ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AG' ||          //SKS_VSTS_13672
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BB' ||          //SKS#DevOps:16237
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||          //SKS#DevOps:16940
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO' ||          //SKS_VSTS_13720
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HT'))))         

        {
            //          2.71: IntrmyAgt1
            nodeIntrmyAgt1 = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('IntrmyAgt1'));
    
            //              FinInstnId
            nodeFinInstnId = nodeIntrmyAgt1.appendChild(xmlDoc.createElement('FinInstnId'));
    
            if(mSKS_EFT_FileDetail_Intermediary.IntBankSwift != '')
            {
                //                  BIC
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail_Intermediary.IntBankSwift, 0, false);
            }
            //                  ClrSysMmbId
            else if(mSKS_EFT_FileDetail_Intermediary.IntBankId != '' )
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                country = this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId);

                switch(country)
                {
                    case 'AU':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//AU' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'CA':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//CC' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        break;
                    case 'US':
                    case 'PR':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//FW' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 9));
                        break;
                    case 'GH':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//GH' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'ZA':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//ZA' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'ZM':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//ZM' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    case 'GB':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//SC' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankId, 1, 6));
                        break;
                    default:
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail_Intermediary.IntBankId, 0, false);
                        break;
                }
            }
    
            //                  Nm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_Intermediary.IntBankName), 140, false); //SKS_FDD_10590
            
            //                  PstlAdr
            this.node_PstlAdr(nodeFinInstnId, mSKS_EFT_FileDetail_Intermediary.IntBankCountryRegionId, mSKS_EFT_FileDetail_Intermediary.IntBankAddr + '' + mSKS_EFT_FileDetail_Intermediary.IntBankAddr2, '', mSKS_EFT_FileDetail_Intermediary.IntBankCity);

            //              BrnchId
            if(mSKS_EFT_FileDetail_Intermediary.IntBankBranch != '')        //SKS_FDD_10590
            {
                nodeBrnchId = nodeIntrmyAgt1.appendChild(xmlDoc.createElement('BrnchId'));
                //              Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', this.CharacterReplacement(mSKS_EFT_FileDetail_Intermediary.IntBankBranch));       //SKS_FDD_10590
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_IntrmyAgt1Acct</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_IntrmyAgt1Acct
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_IntrmyAgt1Acct(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.72: IntrmyAgt1Acct
        //              Id
        //                  OthrId
        //                      Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeIntrmyAgt1Acct;
        XmlElement nodeIntrmyAgt1AcctId;
        XmlElement nodeIntrmyAgt1AcctIdOthr;
    
        if(mSKS_EFT_FileDetail_Intermediary.IntBankAcct != '')
        {
        
            if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BS' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BJ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BF' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TD' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FI' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HU' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JP' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LB' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LI' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LU' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MU' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MX' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ME' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NP' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-OM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-QA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RO' ||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' &&
                  mSKS_EFT_FileDetail.PaymentCurrencyCode != 'RUB')                 ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RS' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SC' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SI' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ES' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LV' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MC' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FJ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AG' ||          //SKS_VSTS_13672
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BO' ||          //SKS_VSTS_13867
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO' ||          //SKS_VSTS_13720
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HT'))
            {
                //          2.71: IntrmyAgt1Acct
                nodeIntrmyAgt1Acct = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('IntrmyAgt1Acct'));
                
                //              Id
                nodeIntrmyAgt1AcctId = nodeIntrmyAgt1Acct.appendChild(xmlDoc.createElement('Id'));
    
                //                  Othr
                nodeIntrmyAgt1AcctIdOthr = nodeIntrmyAgt1AcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeIntrmyAgt1AcctIdOthr, 'Id', mSKS_EFT_FileDetail_Intermediary.IntBankAcct);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_PmtTpInf</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_PmtTpInf(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.31 PmtTpInf
        //              LclInstrm
        //                  Cd
        //------------------------------------------------------------------------------------------------------
        XmlElement nodePmtTpInf;
        XmlElement nodeLclInstrm;
        XmlElement nodeCtgyPurp;
        str        value;
        str         ctgyPurpValue;
        boolean printInstrPrty;

        switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
        {
            case 'US-CITICONNECT-XML-PL':
                switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
                {
                    case #CBFT574:
                        printInstrPrty = true;
                        value = 'NORM';
                        break;
                }
                break;
            case 'US-CITICONNECT-XML-PY':
                switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
                {
                    case #INSTPAY:
                        printInstrPrty = true;
                        value = 'HIGH';
                        break;
                }
                break;
        }

        if(printInstrPrty)
        {
            //          2.31 PmtTpInf
            nodePmtTpInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('PmtTpInf'));

            //          2.7: InstrPrty
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtTpInf, 'InstrPrty', value);
        }
        else if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'CCD'  ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'PPD' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WLW571)
        {
            //          2.31 PmtTpInf
            nodePmtTpInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('PmtTpInf'));
    
            //              LclInstrm
            nodeLclInstrm = nodePmtTpInf.appendChild(xmlDoc.createElement('LclInstrm'));
    
            if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WLW571)
            {
                //                  Prtry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeLclInstrm, 'Prtry', 'CITI571');
            }
            else
            {
                //                  Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeLclInstrm, 'Cd', mSKS_EFT_FileFormatPaymSpec.PaymSpec, 0, false);
            }
        }
        else if(mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-WL-XML-AE')
        {
            ctgyPurpValue = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CtgyPurpPrtry', mSKS_EFT_FileDetail.RecId));

            if(ctgyPurpValue)
            {
                nodePmtTpInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('PmtTpInf'));
                //              2.15: CtgyPurp
                nodeCtgyPurp = nodePmtTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                //                  2.16: Prtry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', '/REF/' + ctgyPurpValue);
            }
        }
        else
        {
            if(mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-US' && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499 && mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'ARE')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CtgyPurpPrtry', mSKS_EFT_FileDetail.RecId));

                if(value != '')
                {
                    nodePmtTpInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('PmtTpInf'));
                    nodeCtgyPurp= nodePmtTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', '/REF/' + value);
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Purp</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_Purp(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.88: Purp
        //              Prtry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeId;
        SKS_EFT_FileDetail invSKS_EFT_FileDetail;
        str value;
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH964   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE    ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453    ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454    ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK478   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397    ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL422   ||                //SKG#VSTS:11471
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424 ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410   ||
          (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'&&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555)  ||
          (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL'&&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392))        //SKG#DevOps:16141
        {
            value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Purp', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
        }
        else
        {
            value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DocTypeCd', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
        }
        //SKS_VSTS_11880--->
        if(!value && mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-UY' &&
                     (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT441 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK493 ||
                      mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK494))
        {
            value = '00';
        }
        //SKS_VSTS_11880<---
        else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY)           //DevOps20744 (Port 20684)
        {
            value = SKS_EFT_Format::getCodelookupvalue('DocTypeCode', mSKS_EFT_FileDetail.RecId);
            if (value == '')
            {
                value = '00';
            }
        }
        if(value != '')
        {
            nodeId = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Purp'));

            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848  ||                
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400   ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453    ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE    ||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938 &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL'))       //SKS#DevOps:21041
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeId, 'Cd', value);
            }
            else
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeId, 'Prtry', value);
            }
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE )
        {
            select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId;
            if(invSKS_EFT_FileDetail.InvoiceNumber != '')
            {
                if(invSKS_EFT_FileDetail.InvoiceSettleAmountCur > 0)
                {
                    value = 'CREN';
                }
                else
                {
                    value = 'CINV';
                }
            }
            if(value)
            {
                nodeId = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Purp'));
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeId, 'Cd', value);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RgltryRptg</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_RgltryRptg(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.89: RgltryRptg
        //              Dtls
        //                  Inf
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeRgltryRptg;
        XmlElement nodeDtls;
        str value, cd, purposeCd, refNum, loanRefNum, paymentCtgycd, typeOfPaym, typeOfPayment;
        str shippingLoc, origin, purpFunds; //SKS_VSTS_12567
        int i, pos;
    
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CenBankCode', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
        cd = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('cd', mSKS_EFT_FileDetail.RecId));                                     //SKG#VSTS:7453     //SKS_FDD_10590
        paymentCtgycd = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PaymentCtgyCd', mSKS_EFT_FileDetail.RecId));               //SKG#VSTS:10574        //SKS_FDD_10590
        typeOfPaym = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TypeOfPaym', mSKS_EFT_FileDetail.RecId));                     //SKG#VSTS:11518        //SKS_FDD_10590
        typeOfPayment = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TypeOfPayment', mSKS_EFT_FileDetail.RecId));               //SKG#VSTS:11518        //SKS_FDD_10590
        
        if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY' &&
            (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392        ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393))
        {
            this.getBankPurposeCode();
            purposeCd = subStr(bankCodeText, 1, 140);
        }
        //SKS_VSTS_12567---->
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392 &&
            mSKS_EFT_FileDetail.FormatId =='US-CITICONNECT-XML-JP' )
        {
            shippingLoc = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Origin', mSKS_EFT_FileDetail.RecId));
            origin      = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ShippingLocation', mSKS_EFT_FileDetail.RecId));
            purpFunds  = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpFunds', mSKS_EFT_FileDetail.RecId));
            if(purpFunds)
            {
                nodeRgltryRptg = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RgltryRptg'));
                nodeDtls = nodeRgltryRptg.appendChild(xmlDoc.createElement('Dtls'));
                value = '/MOF/' + mRemittanceCountryRegionId + ' ' + purpFunds;
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', value);
            }
            else if(shippingLoc || origin)
            {
                nodeRgltryRptg = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RgltryRptg'));
                nodeDtls = nodeRgltryRptg.appendChild(xmlDoc.createElement('Dtls'));
                value = '/MOF/' + mRemittanceCountryRegionId + ' '+'0001'+' '+ origin +' '+ shippingLoc;
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', value);
            }
        }
        //SKS_VSTS_12567<`----
        else if(value != '' || cd != '' || purposeCd != '' || paymentCtgycd != '')             //SKG#VSTS:7453
        {
            nodeRgltryRptg = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RgltryRptg'));
            nodeDtls = nodeRgltryRptg.appendChild(xmlDoc.createElement('Dtls'));

            if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AE' &&    //SKG#VSTS:7453
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT574        ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574))
            {
                //                  2.59: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Cd', cd, 0, false);       //SKG#VSTS:7453
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548          ||
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555))
            {
                //                  2.59: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Cd', cd, 0, false);

                //                  2.61: Inf
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', value);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574)                    //SKG#VSTS:10574
            {
                //                  2.59: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Cd', paymentCtgycd, 0, false);
            }
    
            if(purposeCd)
            {
                for(i=0; i<4; i++)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', subStr(purposeCd, pos, 35), 0, false);
                    pos = pos+35;
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574 && paymentCtgycd != '')        //SKG#VSTS:10574
            {
                refNum = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RefNum', mSKS_EFT_FileDetail.RecId));     //SKS_FDD_10590
                loanRefNum = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('LoanRefNum', mSKS_EFT_FileDetail.RecId));     //SKS_FDD_10590
    
                if(refNum || loanRefNum)
                {
                    if(paymentCtgycd == '10301' || paymentCtgycd == '10302' || paymentCtgycd == '10303' || paymentCtgycd == '10304' || paymentCtgycd == '10305' || paymentCtgycd == '10306' ||
                       paymentCtgycd == '10307' || paymentCtgycd == '10308' || paymentCtgycd == '10309' || paymentCtgycd == '10310' || paymentCtgycd == '10311' || paymentCtgycd == '10500' ||
                       paymentCtgycd == '10600' || paymentCtgycd == '10101' || paymentCtgycd == '10102' || paymentCtgycd == '10103' || paymentCtgycd == '10104' || paymentCtgycd == '10105' ||
                       paymentCtgycd == '10106' || paymentCtgycd == '10107' || paymentCtgycd == '10108' || paymentCtgycd == '10109' || paymentCtgycd == '10110' || paymentCtgycd == '10111')
                    {
                        if(paymentCtgycd == '10301' || paymentCtgycd == '10302' || paymentCtgycd == '10303' || paymentCtgycd == '10304' || paymentCtgycd == '10305' || paymentCtgycd == '10306' ||
                           paymentCtgycd == '10307' || paymentCtgycd == '10308' || paymentCtgycd == '10309' || paymentCtgycd == '10310' || paymentCtgycd == '10311' || paymentCtgycd == '10500' || paymentCtgycd == '10600')
                        {
                            //                      Inf
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', refNum, 18, false);
                        }
                        else
                        {
                            //                      Inf
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', refNum, 0, false);
                        }
                    }
    
                    if(paymentCtgycd == '10600' || paymentCtgycd == '30904' || paymentCtgycd == '30905' || paymentCtgycd == '30906' ||
                       paymentCtgycd == '30907' || paymentCtgycd == '80100' || paymentCtgycd == '80200' || paymentCtgycd == '80300' || paymentCtgycd == '80400')
                    {
                        //                      Inf
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', loanRefNum, 14, false);
                    }
                }
            }
            else
            {
                //                  2.61: Inf
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', value, 0, false);
            }
        }
        else if(typeOfPaym || typeOfPayment)
        {
            //                      RgltryRptg
            nodeRgltryRptg = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RgltryRptg'));
            
            //                              Dtls
            nodeDtls = nodeRgltryRptg.appendChild(xmlDoc.createElement('Dtls'));
            
            if(typeOfPaym)
            {
                //                                  Inf
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', typeOfPaym);                
            }
            else if(typeOfPayment)            
            {
                //                                  Inf
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDtls, 'Inf', typeOfPayment);                
            }            
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RltdRmtInf</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_RltdRmtInf(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.91: RltdRmtInf
        //              2.93: RmtLctnMtd
        //              2.94: RmtLctnElctrncAdr
        //------------------------------------------------------------------------------------------------------
        XmlElement              nodeRltdRmtInf;     
        XmlElement              nodeRmtLctnPstlAdr;
        XmlElement              nodeAdr;
        str value, address;
        str SpecHanCodes,AddrLogo,AdvTempNo; //DevOps19140
        boolean printAddr;
    
        value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RmtLctnMtd', mSKS_EFT_FileDetail.RecId));        //SKS_FDD_10590
        SpecHanCodes = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('SpecHanCodes', mSKS_EFT_FileDetail.RecId,SKS_EFT_CodeLookupType::CodeLookup));  // DevOps 19140
        AddrLogo = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('AddrLogo', mSKS_EFT_FileDetail.RecId,SKS_EFT_CodeLookupType::CodeLookup)); //DevOps 19140
        AdvTempNo = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('AdvTempNo', mSKS_EFT_FileDetail.RecId,SKS_EFT_CodeLookupType::CodeLookup));//DevOps19140
            
        //SKS_VSTS_12350--->
        switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
        {
            case 'CHK-19':
                value = '/ADVCD/'+SpecHanCodes+'/'+AddrLogo+'/'+AdvTempNo; //DevOps 19140
                break;
            case 'CHK19CAMAL':
                value = '/ADVCD///TMP04';
                break;
            case 'CHK19USFED':
                value = '/ADVCD/01//TMP01';
                break;
            case 'CHK19CAFED':
                value = '/ADVCD/01//TMP04';
                break;
            case 'CHKUSFED02':
                value = '/ADVCD/02//TMP01';
                break;
            case 'CHKUSFED03':
                value = '/ADVCD/03//TMP01';
                break;
            case 'CHKCAFED02':                  //SKS_VSTS_13397
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)
                {
                    value = '/ADVCD/02//TMP04';
                }
                else
                {
                    value = '/ADVCD/02//TMP03';
                }
                break;
            case 'CHKCAFED03':                  //SKS_VSTS_13397
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)
                {
                    value = '/ADVCD/03//TMP04';
                }
                else
                {
                    value = '/ADVCD/03//TMP03';
                }
                break;
            case 'CHK20CAMAL':                      //SKS_VSTS_13397
                value = '/ADVCD///TMP03';
                break;
            case 'CHK20CAFED':                      //SKS_VSTS_13397
                value = '/ADVCD/01//TMP03';
                break;
            case 'FT-499':
            case #USFCP821:
                printAddr = true;
                break;
        }
        //SKS_VSTS_12350<---
            
        if(value == 'EMAL')      //SKS_FDD_10590, SKS#VSTS:13158
        {
            if(mSKS_EFT_FileDetail_VendAddress.Locator)
            {
                address = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.Locator); //SKS_FDD_10590
            }
        }
        else if(value == 'FAXI' || value == 'FAX')
        {
            if(mSKS_EFT_FileDetail_VendAddress.Fax)
            {
                address = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.Fax); //SKS_FDD_16447
            }
        }
    
        if(address != '' || value != '' || printAddr)
        {
            //          2.91: RltdRmtInf
            nodeRltdRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RltdRmtInf'));
    
            //              2.93: RmtLctnMtd
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)
            {
                //              2.93: RmtLctnMtd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRltdRmtInf, 'RmtId', value, 0, false);
            }
            else if(value)
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRltdRmtInf, 'RmtLctnMtd', value, 0, false);
            }
            if(address)
            {
                //              2.94: RmtLctnElctrncAdr
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRltdRmtInf, 'RmtLctnElctrncAdr', address, 0, false);
            }
            if(printAddr)//DevOps19219
            {
                //              2.95: RmtLctnPstlAdr
                nodeRmtLctnPstlAdr = nodeRltdRmtInf.appendChild(xmlDoc.createElement('RmtLctnPstlAdr'));
                
                //                      Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtLctnPstlAdr, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneName), 35);
                
                //                      Adr
                nodeAdr = nodeRmtLctnPstlAdr.appendChild(xmlDoc.createElement('Adr'));
                
                //                          Ctry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'Ctry', this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_VendAddress.BeneCountryRegionId));

                if(mSKS_EFT_FileDetail_VendAddress.BeneAddr)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'AdrLine',mSKS_EFT_FileDetail_VendAddress.BeneAddr,false);
                }
                if(mSKS_EFT_FileDetail_VendAddress.BeneAddr2)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeAdr, 'AdrLine',mSKS_EFT_FileDetail_VendAddress.BeneAddr2,false);
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_RmtInf(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.98: RmtInf
        //              2.99: Ustrd
        //------------------------------------------------------------------------------------------------------
    
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #ACHCCD:
            case #ACHPPD:
            case #WLW571:
            case #CHK585:
            case #ACH780:
            case #BPAY889:
            case #SSK853:          //SKG#VSTS:11518
            case #VAT984:          //SKG#VSTS:12473
                break;
            case #ACHCTX:
            case #ACH_PG:
            case #ACH_BG:
            case #CHECK416:
            case #IBRS429:
            case #IBRS430:
            case #CHECK427:
            case #ACH_KID:          //SKG#VSTS:7131
            case #CCDP14:
            case #CTX17:
            case #CHK19:
            case #CTX942:
            case #CHK20:
            case #CPS706:
            case #SEPA848:
            case #SEPA939:
            case #PRL398:
            case #DD437:
            case #DOM540:
            case #DFT914:
            case #CHK418:
            case #ATPAY424:
            case #CHK425:
            case #PRL426:
            case #CHK396:
            case #SEPA:             //SKG#VSTS:12473
            case #CDT862:            //SKS#DevOps:17322
            case #TRADE:
            case #CTX950:            //SKS#DevOps:21971
                this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                break;
            case #SEPA938:            //SKS#DevOps:21041
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                {
                    this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                }
                else
                {
                    this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                }
                break;
            case #ACH_SEPA:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-BE')
                {
                    this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                }
                else
                {
                    this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                }
                break;
            case #DOM391:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NZ'  ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU')
                {
                    this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                }
                else
                {
                    this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                }
                break;
            case #BKT393:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KR' ||       //SKS_VSTS_12761
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG')     //SKS_VSTS_12761
                {
                    this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                }
                else
                {
                    this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                }
                break;
            case #CB392:                                                                 //SKS_VSTS_12761
                if (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NZ'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TW'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MO')
                {
                    this.node_CdtTrfTxInf_RmtInf_Strd(_nodeCdtTrfTxInf);
                }
                else
                {
                    this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                }
                break;
            default:
                this.node_CdtTrfTxInf_RmtInf_Ustrd(_nodeCdtTrfTxInf);
                break;
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_RfrdDocInf</Name>
				<Source><![CDATA[
    private void node_CdtTrfTxInf_RmtInf_RfrdDocInf(XmlElement _nodeStrd, SKS_EFT_FileDetail _invSKS_EFT_FileDetail)
    {
        //------------------------------------------------------------------------------------------------------
        //              2.101: RfrdDocInf
        //                  2.102: Tp
        //                      2.103: CdOrPrtry
        //                          2.104: Cd
        //                  2.107: Number
        //                  2.108: RltdDt
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeRfrdDocInf;
        XmlElement nodeTp;
        XmlElement nodeCdOrPrtry;
    
        //              2.101: RfrdDocInf
        nodeRfrdDocInf = _nodeStrd.appendChild(xmlDoc.createElement('RfrdDocInf'));
    
        //                  2.102: Tp
        nodeTp = nodeRfrdDocInf.appendChild(xmlDoc.createElement('Tp'));
    
        //                      2.103: CdOrPrtry
        nodeCdOrPrtry = nodeTp.appendChild(xmlDoc.createElement('CdOrPrtry'));
    
        //                          2.104: Cd
        if(_invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur <= 0)
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdOrPrtry, 'Cd', 'CINV');

            //                  2.107: Number
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'Nb', this.CharacterReplacement(_invSKS_EFT_FileDetail.InvoiceNumber));

            //                  2.108: RltdDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'RltdDt', SKS_PP_StringFormats::strDateYYYYMMDD(_invSKS_EFT_FileDetail.InvoiceDate, DateSeparator::Hyphen));
        }
        else
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdOrPrtry, 'Cd', 'CREN');

            //                  2.107: Number
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'Nb', this.CharacterReplacement(_invSKS_EFT_FileDetail.InvoiceNumber));

            //                  2.108: RltdDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'RltdDt', SKS_PP_StringFormats::strDateYYYYMMDD(_invSKS_EFT_FileDetail.InvoiceDate, DateSeparator::Hyphen));
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_Strd</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_RmtInf_Strd(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.98: RmtInf
        //------------------------------------------------------------------------------------------------------
        SKS_EFT_FileDetail invSKS_EFT_FileDetail;
        XmlElement nodeRmtInf;
        XmlElement nodeStrd;
        XmlElement nodeRfrdDocAmt;
        XmlElement nodeCdtrRefInf;
        XmlElement nodeTp;
        XmlElement nodeCdOrPrtry;       
        XmlElement nodeRfrdDocInf;
        XmlElement currentElement;
        str fik, spclHandlgCd, value;
        boolean firstRec = true;
        LedgerJournalTransTxt   description;
        
        EventHandlerResult result = new EventHandlerResult();

        this.node_CdtTrfTxInf_RmtInf_Strd_delegate(_nodeCdtTrfTxInf, mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, mSKS_EB_CharacterReplacement, xmldoc, result);

        if(!result.result())
        {
            while select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId
            {
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19 ||  //SKS_VSTS_13844
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20)      //SKS_VSTS_13397
                {
                    if(firstRec)
                    {
                        //          2.98: RmtInf
                        nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/GLTG/' + num2str((mSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur) * -1, 0,2,1,0));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/GLTD/' + num2str(mSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1, 0,2,1,0));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/GLTN/' + num2str(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1, 0,2,1,0));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/PMDH/' + CompanyInfo::findDataArea(mSKS_EFT_FileDetail.AccountCompany).Name);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/PMDH/' + (SKS_EFT_Setup::find().APEMReplyToAddr));    //SKS_VSTS_13397

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/NAVC/' + mSKS_EFT_FileDetail.AccountNum);

                        spclHandlgCd = SKS_EFT_Format::getCodelookupvalue('SpclHndlgCode', mSKS_EFT_FileDetail.RecId);      //SKS#DevOps:16756
                        if(spclHandlgCd)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/NASH/' + spclHandlgCd);
                        }
                        value = SKS_EFT_Format::getCodelookupvalue('FormCode', mSKS_EFT_FileDetail.RecId);
                        if(value)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/NAAT/' + value);
                        }

                        firstRec = false;
                    }

                    //              2.100: Strd
                    nodeStrd = nodeRmtInf.appendChild(xmlDoc.createElement('Strd'));

                    //              2.101: RfrdDocInf
                    nodeRfrdDocInf = nodeStrd.appendChild(xmlDoc.createElement('RfrdDocInf'));

                    switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)//SKS_VSTS_13771
                    {
                        case 'CHK-19':
                        case 'CHK19USFED':
                        case 'CHKUSFED02':
                        case 'CHKUSFED03':
                        case 'CHK20CAMAL':
                        case 'CHK20CAFED':
                        case 'CHKCAFED02':
                        case 'CHKCAFED03':
                            //                  2.107: Number
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'Nb', subStr(invSKS_EFT_FileDetail.InvoiceNumber, 1, 20), 0, false);//SKS_VSTS_13771
                            break;
                        default :
                            //                  2.107: Number
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'Nb', invSKS_EFT_FileDetail.InvoiceNumber, 0, false);
                            break;
                    }

                    //                  2.108: RltdDt
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocInf, 'RltdDt', SKS_PP_StringFormats::strDateYYYYMMDD(invSKS_EFT_FileDetail.InvoiceDate, DateSeparator::Hyphen), 0, false);

                    //                 2.109 RfrdDocAmt
                    nodeRfrdDocAmt = nodeStrd.appendChild(xmlDoc.createElement('RfrdDocAmt'));

                    if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CHK19 && (invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1 < 0))    //SKS_DevOps_17711-->
                    {
                        //                  2.111           DscntApldAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'DscntApldAmt', num2str(invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);
                        
                        //                                  CdtNoteAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'CdtNoteAmt', num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);

                        //                                  RmtdAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'RmtdAmt', num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);
                    }
                    else    //SKS_DevOps_17711<---
                    {
                        //                  2.110       DuePyblAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'DuePyblAmt', num2str((invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur) * -1,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);

                        //                  2.111           DscntApldAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'DscntApldAmt', num2str(invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);

                        //                                  RmtdAmt
                        currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRfrdDocAmt, 'RmtdAmt', num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0));
                        SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', invSKS_EFT_FileDetail.PaymentCurrencyCode);
                    }

                    //                                  AddtlRmtInf
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeStrd, 'AddtlRmtInf', this.CharacterReplacement(invSKS_EFT_FileDetail.InvoiceTransactionTxt), 0, false);
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDT862 ||      //SKS#DevOps:17322
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950)      //SKS#DevOps:21971
                {
                    if(invSKS_EFT_FileDetail.InvoiceNumber)
                    {
                        if(firstRec)
                        {
                            //          2.98: RmtInf
                            nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
                            firstRec = false;
                        }
    
                        //              2.100: Strd
                        nodeStrd = nodeRmtInf.appendChild(xmlDoc.createElement('Strd'));

                        //              2.101: RfrdDocInf
                        this.node_CdtTrfTxInf_RmtInf_RfrdDocInf(nodeStrd, invSKS_EFT_FileDetail);
    
                        //              2.109 RfrdDocAmt
                        nodeRfrdDocAmt = nodeStrd.appendChild(xmlDoc.createElement('RfrdDocAmt'));
                        this.node_RmtInf_Amt(nodeRfrdDocAmt, invSKS_EFT_FileDetail);
                    }
                }
                else if(invSKS_EFT_FileDetail.InvoiceNumber != ''                          || 
                    (invSKS_EFT_FileDetail.PaymId                                     &&        //SKG#VSTS:14062
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-BE'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-SE'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-NO'  ||         //SKG#VSTS:7131
                    mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-GB' ||    //SKG#VSTS:7131
                    mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-CZ'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-PL') &&        //SKG#VSTS:12473
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA         ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG            ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_KID           ||         //SKG#VSTS:7131
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848           ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA939           ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938           ||        //SKS#DevOps:21041
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE             ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA)))                     //SKG#VSTS:12473
                {
                    if(firstRec)
                    {
                        //          2.98: RmtInf
                        nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
                        firstRec = false;
                    }
    
                    //              2.100: Strd
                    nodeStrd = nodeRmtInf.appendChild(xmlDoc.createElement('Strd'));
    
                    if(invSKS_EFT_FileDetail.PaymId                                      &&         //SKG#VSTS:14062
                        (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-BE' ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SE'  ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-NO' ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-DE' ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-GB' ||    //SKG#VSTS:7131
                        mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-CZ' ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-PL')&&        //SKG#VSTS:12473
                        (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA        ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG           ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG           ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_KID          ||    //SKG#VSTS:7131
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848          ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA939          ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938          ||     //SKS#DevOps:21041
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE            ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA))                 //SKG#VSTS:12473 
                    {
                        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                        {
                            case #ACH_SEPA:
                                fik = subStr(invSKS_EFT_FileDetail.PaymId, 1, 12);              //SKG#VSTS:14062
                                break;
                            case #ACH_PG:
                            case #ACH_BG:
                            case #ACH_KID:                                                      //SKG#VSTS:7131
                                fik = subStr(invSKS_EFT_FileDetail.PaymId, 1, 25);              //SKG#VSTS:14062
                                break;
                            case #SEPA848:
                            case #SEPA939:
                                fik = subStr(invSKS_EFT_FileDetail.PaymId, 1, 35);              //SKG#VSTS:14062
                                break;
                            case #SEPA:                                                         //SKG#VSTS:12473
                                fik = subStr(invSKS_EFT_FileDetail.PaymId, 1, 35);              //SKG#VSTS:14062
                                break;
                            default:
                                fik = invSKS_EFT_FileDetail.PaymId;                             //SKG#VSTS:14062
                                break;
                        }
    
                        //            2.120: CdtrRefInf
                        nodeCdtrRefInf = nodeStrd.appendChild(xmlDoc.createElement('CdtrRefInf'));
    
                        //              2.121: Tp
                        nodeTp = nodeCdtrRefInf.appendChild(xmlDoc.createElement('Tp'));
    
                        //                  2.122: CdOrPrtry
                        nodeCdOrPrtry = nodeTp.appendChild(xmlDoc.createElement('CdOrPrtry'));
    
                        //                      2.123: Cd
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdOrPrtry, 'Cd', 'SCOR');
    
                        //               2.126: Ref
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrRefInf, 'Ref', fik);
                    }
                    else
                    {
                        //              2.101: RfrdDocInf
                        this.node_CdtTrfTxInf_RmtInf_RfrdDocInf(nodeStrd, invSKS_EFT_FileDetail);
    
                        //              2.109 RfrdDocAmt
                        nodeRfrdDocAmt = nodeStrd.appendChild(xmlDoc.createElement('RfrdDocAmt'));
                        this.node_RmtInf_Amt(nodeRfrdDocAmt, invSKS_EFT_FileDetail);
                    }
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId  == 'US-CITICONNECT-XML-SE' &&
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG ||
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG))
                
                {
                    description = LedgerJournalTrans::findRecId(invSKS_EFT_FileDetail.PaymentLineRecId, false).Txt;

                    if(description)
                    {
                        //          2.98: RmtInf
                        nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(description), 140);
                        break;
                    }
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_Ustrd</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_RmtInf_Ustrd(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.98: RmtInf
        //              2.99: Ustrd
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeRmtInf;
        str invNumbers;
        str value, taxId, rsnForPmt, benId, dob, itrsCode;
        str paymDetails, purpose, idType, prdYear, prdType, prdRange, pmtSymbol, PurpOfPmt, PurCode;
        int i, j, len;
        SKS_EFT_FileDetail invSKS_EFT_FileDetail;
        PaymId ledgerTransPaymId;
        str invDetailsString, purpCodeIN, bankCodeDescription;
        str purpOfPmtMY, purpDescMY;
        
    
        str acctype, pop;
        str ntn, unn, voCode;
        VendBankAccount mVendBankAccount;

        mVendBankAccount = VendBankAccount::findByCompany(mSKS_EFT_FileDetail.AccountCompany, mSKS_EFT_FileDetail.AccountNum, mSKS_EFT_FileDetail.DepBankAccountId);

        idType = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('IdType', mSKS_EFT_FileDetail.RecId));
        prdYear = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PrdYear', mSKS_EFT_FileDetail.RecId));
        prdType = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PrdType', mSKS_EFT_FileDetail.RecId));
        prdRange = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PrdRange', mSKS_EFT_FileDetail.RecId));
        pmtSymbol = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PmtSymbol', mSKS_EFT_FileDetail.RecId));
        purpCodeIN = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCodeIN', mSKS_EFT_FileDetail.RecId));        //SKS#DevOps:17289
        PurCode = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurposeCode', mSKS_EFT_FileDetail.RecId));


        EventHandlerResult result = new EventHandlerResult();

        this.getBankPurposeCode();
    
        this.node_CdtTrfTxInf_RmtInf_Ustrd_delegate(_nodeCdtTrfTxInf,mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_FileDetail_VendAddress, mSKS_EFT_FileDetail_BenBank, mSKS_EFT_FileDetail_Intermediary, msKS_EFT_FileDetail_CreditParty, mVendBankAccount, bankCode, bankCodeText, mRemittanceName, mSKS_EB_CharacterReplacement, mSKS_EFT_VendorPaym, xmldoc, result);
        
        if(!result.result())
        {
            invNumbers = this.getInvoiceNbrs();

            value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RmtOvr', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
        
            //SKG#VSTS:8991
            if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NL' &&
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB_WIRE))||               //SKS#DevOps:16938
               (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821)))     //SKS#DevOps:16937
            {
                ledgerTransPaymId = this.CharacterReplacement(mSKS_EFT_FileDetail.LedgerTrans_PaymId);
            }

            if(invNumbers && 
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555 &&
               mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR')                      //SKG#VSTS:11518
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
            
                if(subStr(invNumbers, 1, 25) != '')
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/INPDC/' + subStr(invNumbers, 1, 25));
                }
                if(subStr(invNumbers, 26, 25) != '')
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/INPDC/' + subStr(invNumbers, 26, 25));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'CB-WIRE' && 
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId=='ARE' && (PurCode || invNumbers)) //DevOps18583
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
                
                if(PurCode)
                {
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/REF/'+ PurCode);
                }
                if(invNumbers)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442 &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CR')                      //SKG#DevOps:17939
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Vendor payment');
            
                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 1, 35), 35, false);

                //                  Ustrd Line 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 36, 35), 35, false);

                //                  Ustrd Line 3
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 71, 35), 35, false);

                //                  Ustrd Line 4
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 105, 35), 35, false);
            }
            else if(invNumbers &&
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541     ||  //SKS#DevOps:15853
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539    ||  //SKS#DevOps:15853
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IFT_CB392))    //SKS#DevOps:15853
            {
                //                  RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                      Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', purpCodeIN, 35, false); //SKS#DevOps:17289

                while select InvoiceNumber, EffectiveDate from invSKS_EFT_FileDetail
                    where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId
                {
                    invDetailsString = strFmt('/PMDD/%1 %2', invSKS_EFT_FileDetail.InvoiceNumber, date2str(invSKS_EFT_FileDetail.EffectiveDate, 123, DateDay::Digits2, DateSeparator::Hyphen, DateMonth::Digits2, DateSeparator::Hyphen, DateYear::Digits4));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invDetailsString, 35, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL')
            {
                if(invNumbers)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET' ||    //SKS#DevOps:18131
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MV' ||    //SKS#DevOps:20079
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IS'))
            {
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(invNumbers || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(rsnForPmt, 1, 35));
                    
                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(invNumbers), 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY')        //SKS#DevOps:18131
            {
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(invNumbers || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(rsnForPmt, 1, 35));

                    //                  Ustrd Line 2
                    if(mSKS_EFT_FileDetail.DepBankTransit)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'TRANSIT CODE '+ subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 8));
                    }
                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(invNumbers), 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BH')         //SKS#DevOps:17213
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpOfPmt', mSKS_EFT_FileDetail.RecId));
                if(invNumbers || value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/REF/'+ value);

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA')         //SKS#DevOps:18212
            {
                pop = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TransactionCode', mSKS_EFT_FileDetail.RecId));
                
                if(invNumbers || pop)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    if(pop)
                    {
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'PYMT TYPE'+ pop);
                    }

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN')         //SKS#DevOps:17213
            {
                pop = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpOfPmtTN', mSKS_EFT_FileDetail.RecId));
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ActivitySector', mSKS_EFT_FileDetail.RecId));
                if(invNumbers || pop || value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/REF/'+ pop + '/' + value);

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MM')     //SKS#DevOps:15473
            {
                itrsCode = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ITRSCode', mSKS_EFT_FileDetail.RecId));
                if(bankCodeText || itrsCode)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(itrsCode, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-QA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MU' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NA' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RS'))
            {
                if(bankCodeText)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                    mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GIB')
            {
                if(bankCodeText || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tel No ' + telNo);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MD')     //SKS_VSTS_14743
            {
                if(bankCodeText || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tel No ' + telNo, 35);
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH')
            {
                

                if(bankCodeText || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tel No ' + telNo);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GE'))
            {
                if(bankCodeText || mSKS_EFT_FileDetail_BenBank.BenBankBranch)       //VSTS#14580
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'RFP' + substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM'   &&       //VSTS#14580
                    mSKS_EFT_FileDetail.DepBankTransit == '' &&
                       mSKS_EFT_FileDetail.DepSwiftNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(mSKS_EFT_FileDetail_BenBank.BenBankBranch, 1, 35), 35, false);       //VSTS#14580
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));

                if(value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(value, 1, 35), 35, false);

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch), 1, 35), 35, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' &&
                    strLen(mRemittanceName) > 35)
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                if(strLen(mRemittanceName) > 35)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Full Bnf name ' + this.CharacterReplacement(subStr(mRemittanceName, 1, 21)), 35);

                    if(strLen(mRemittanceName) > 21)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(subStr(mRemittanceName, 22, 35)), 35);
                    }

                    if(strLen(mRemittanceName) > 56)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(subStr(mRemittanceName, 57, 35)), 35);
                    }

                    if(strLen(mRemittanceName) > 92)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(subStr(mRemittanceName, 92, 35)), 35);
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BA' ||    //SKS#DevOps:16138, 16401
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM'))    //SKS#DevOps:16946
            {
                if(invNumbers)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 1, 35), 35, false);

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 36, 35), 35, false);

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 71, 35), 35, false);

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 105, 35), 35, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG')    //SKS#DevOps:18138
            {
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(invNumbers || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(rsnForPmt, 1, 35));

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 1, 35), 35, false);

                    //                  Ustrd Line 3
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 36, 35), 35, false);

                    //                  Ustrd Line 4
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 71, 35), 35, false);

                    //                  Ustrd Line 5
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(invNumbers, 105, 35), 35, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)               //SKS#DevOps:16428
            {
                this.getEmailandTelephonenumber();
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));
    
                if(telNo  || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', rsnForPmt, 35);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', telNo, 35);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ')
            {
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(rsnForPmt || mRemittanceName)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(rsnForPmt, 1, 35));

                    if(strLen(mRemittanceName) > 35)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Full Bnf name ' + this.CharacterReplacement(subStr(mRemittanceName, 1, 21)), 35);

                        if(strLen(mRemittanceName) > 21)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(subStr(mRemittanceName, 22, 35)), 35);
                        }

                        if(strLen(mRemittanceName) > 56)
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(subStr(mRemittanceName, 57, 35)), 35);
                        }
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ')
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(taxId || rsnForPmt || mSKS_EFT_FileDetail.DepBankTransit || mVendBankAccount.SKS_IHB_WIntBankAcct)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    if(taxId)
                    {
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tax ID' + taxId, 1, 35));
                    }
                    else
                    {
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    if(mSKS_EFT_FileDetail.DepBankTransit)
                    {
                        //                  Ustrd Line 3
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('BIK' + mSKS_EFT_FileDetail.DepBankTransit, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 4
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(mVendBankAccount.SKS_IHB_WIntBankAcct, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO')
            {
                this.getEmailandTelephonenumber();

                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));


                if(bankCodeText || telNo || taxId || (strLen(mSKS_EFT_FileDetail.DepSwiftNo) < 11 && mSKS_EFT_FileDetail_BenBank.BenBankBranch))
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tel No ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 3
                    if(taxId)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tax ID ' + taxId, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    if(strLen(mSKS_EFT_FileDetail.DepSwiftNo) < 11)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                    }
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR')
            {
                this.getEmailandTelephonenumber();

                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));


                if(bankCodeText || telNo || taxId || (!mSKS_EFT_FileDetail.DepBankIBAN && mSKS_EFT_FileDetail_BenBank.BenBankBranch))
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tel No ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 3
                    if(taxId)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tax ID ' + taxId, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    if(!mSKS_EFT_FileDetail.DepBankIBAN)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                    }
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG')
            {
                dob = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DOB', mSKS_EFT_FileDetail.RecId));

                if(dob)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('DOB ' + dob, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL')
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));      //SKS#DevOps:17397

                this.getEmailandTelephonenumber();

                if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
                {
                    acctype = 'Saving Account';
                }
                else
                {
                    acctype = 'Current Account';
                }

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(rsnForPmt, 1, 35));

                //                  Ustrd Line 2
                if(taxId)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tax ID ' + subStr(taxId, 1, 9));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }

                //                  Ustrd Line 3
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', acctype);

                //                  Ustrd Line 4
                if(telNo)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tel No ' + telNo, 1, 35));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN')
            {
                this.getEmailandTelephonenumber();
                this.getBankPurposeCode();

                dob = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DOB', mSKS_EFT_FileDetail.RecId));

                if(invNumbers || telNo || dob || bankCodeText)      //SKS#DevOps:17276
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', bankCodeText);

                    //                  Ustrd Line 2
                    if(dob)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('DOB ' + dob, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                
                    //                  Ustrd Line 3
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tel No ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 4
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE'))
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                if(taxId)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR')
                    {
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'TaxID' + substr(taxId, 1, 12));
                    }
                    else
                    {
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'TaxID' + substr(taxId, 1, 11));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO')
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                this.getEmailandTelephonenumber();

                if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
                {
                    acctype = 'Saving Account';
                }
                else
                {
                    acctype = 'Current Account';
                }

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                if(bankCodeText)
                {
                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'RFP' + substr(bankCodeText, 1, 35));
                }
                else
                {
                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }

                //                  Ustrd Line 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', acctype);

                //                  Ustrd Line 3
                if(telNo)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tel No ' + telNo, 1, 35));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }
                        
                //                  Ustrd Line 4
                if(taxId)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tax ID ' + subStr(taxId, 1, 11));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JM')     //SKS#DevOps:19378
            {
                if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
                {
                    acctype = '/ACC/TYPE SA';
                }
                else
                {
                    acctype = '/ACC/TYPE CA';
                }
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                if(mSKS_EFT_FileDetail_BenBank.BenBankBranch)           //SKS#DevOps:20256
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                }

                //                  Ustrd Line 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', acctype);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH')
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 1, 25));
                
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 26, 25));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 51, 25));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 76, 25));
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT')
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                if(taxId || bankCodeText)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    if(taxId)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Tax ID ' + taxId, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN')
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                bankCode            = SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId);
                bankCodeDescription = this.getCodelookupDescription('PurpCode', mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_VendorPaym.RecId);        //SKS#DevOps:17440

                if(bankCodeDescription || bankCode)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(bankCodeDescription, 1, 35));           //SKS#DevOps:17353

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(this.CharacterReplacement(bankCode), 1, 35));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY')
            {
                this.getEmailandTelephonenumber();
                
                if(purpOfPmtMY || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    if(purpOfPmtMY)
                    {
                        value = strFmt('POP %1 %2', purpOfPmtMY, purpDescMY);
                        //                  Ustrd Line 1
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', value);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                    //                  Ustrd Line 2
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Phone Number ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD'))
            {
                this.getEmailandTelephonenumber();
                
                if(bankCodeText || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Phone Number ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK')
            {
                str purpofPmtPK, relationPK, taxidPK, purposeDesc, relation;

                if(this.getCustomValue_US_CITICONNECT_WL_XM_PK()) //SKS_DevOps_20424
                {
                    ntn = this.CharacterReplacement(this.getCustomValue_US_CITICONNECT_WL_XM_PK());
                }
                else
                {
                    ntn = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('NTN', mSKS_EFT_FileDetail.RecId));
                }

                purpofPmtPK = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpOfPmtPK ', mSKS_EFT_FileDetail.RecId));   //SKS#DevOps:19000
                purposeDesc = this.CharacterReplacement(this.getCodelookupDescription('PurpOfPmtPK ', mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_VendorPaym.RecId));   //SKS#DevOps:19977
                relationPK = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RelationPK ', mSKS_EFT_FileDetail.RecId));   //SKS#DevOps:19000
                relation = this.CharacterReplacement(this.getCodelookupDescription('RelationPK ', mSKS_EFT_FileFormatPaymSpec, mSKS_EFT_VendorPaym.RecId));   //SKS#DevOps:19977
                taxidPK = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('UltRmtTaxID ', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));   //SKS#DevOps:19000

                if(ntn || purpofPmtPK || relationPK || taxidPK)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', purpofPmtPK + ' ' + purposeDesc);   //SKS#DevOps:19977

                    //                  Ustrd Line 2
                    if(ntn)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'NTN' + ntn, 35);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 3
                    if(taxidPK)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'RUID ' + taxidPK, 35);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }

                    //                  Ustrd Line 4
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', relationPK + ' - ' + relation);   //SKS#DevOps:19977
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));

                if(value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'BOP Code ' + subStr(value, 1, 6));
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK')
            {
                if(mSKS_EFT_FileDetail.DepBankTransit || mSKS_EFT_FileDetail_BenBank.BenBankBranch)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Bank Code ' + mSKS_EFT_FileDetail.DepBankTransit + ' ' + 'Branch Code ' + this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch), 35);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW')
            {
                this.getEmailandTelephonenumber();

                if(bankCodeText || telNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(telNo)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('Phone Number ' + telNo, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' &&
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RUB')
            {
                voCode = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('VOCode', mSKS_EFT_FileDetail.RecId));

                if(voCode)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '(VO' + subStr(voCode, 1, 5) + ')');
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BY')
            {
                unn = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                if(unn || bankCodeText)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));
                
                    //                  Ustrd Line 2
                    if(unn)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('UNN' + unn, 1, 35));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));

                if(value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr('/' + value, 1, 35), false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG')
            {
                purpose = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpPmt', mSKS_EFT_FileDetail.RecId));
                
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                for(i =0; i < 4; i++)                         //SKS_VSTS_14837
                {
                    //                  Ustrd Line 1to4
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', purpose, 35);       //SKS#DevOps:15702
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT')
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                if(taxId)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tax ID ' + subStr(taxId, 1, 10));
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL) &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY'))
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                if(taxId || bankCodeText)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(bankCodeText, 1, 35));

                    //                  Ustrd Line 2
                    if(taxId)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tax ID ' + subStr(taxId, 1, 11));
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                    }
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL) &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UZ'))
            {
                if(bankCodeText || invNumbers || (strLen(mSKS_EFT_FileDetail.DepSwiftNo) < 11 && mSKS_EFT_FileDetail_BenBank.BenBankBranch))
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //                  Ustrd Line 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(invNumbers, 1, 35));

                    if(strLen(mSKS_EFT_FileDetail.DepSwiftNo) < 11)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                     (this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'UA' ||
                      this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'AR' ||
                      this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'ZW')))
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId));

                this.getEmailandTelephonenumber();

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                //                  Ustrd Line 2
                if(taxId)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tax ID ' + subStr(taxId, 1, 35));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }

                if(telNo)
                {
                    //                  Ustrd Line 3
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Tel No ' + substr(telNo, 1, 20));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');
                }
            }
            
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                     (this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'EC' ||
                      this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'SV')))
            {
                this.getEmailandTelephonenumber();

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(bankCodeText, 1, 35));

                //                  Ustrd Line 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', substr(telNo, 1, 20));
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                     this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'PS'))
            {
                purpose = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));

                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TaxId', mSKS_EFT_FileDetail.RecId));

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                  Ustrd Line 1
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', purpose);

                //                  Ustrd Line 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', taxId);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY')
            {
                if(bankCode)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(bankCode), 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||    //SKS#DevOps:20293
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GN'))     //SKS#DevOps:21269
            {
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));

                if(rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(rsnForPmt), 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BS' ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SA') )            //SKS_VSTS_14743
            {
                purpose = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpPmt', mSKS_EFT_FileDetail.RecId));
                
                if(purpose)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(purpose), 35);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD')         //SKS#DevOps:15203
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Nationality', mSKS_EFT_FileDetail.RecId));

                if(bankCodeText || value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(bankCodeText), 140);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', value, 140, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&                   
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK')
            {
                if(bankCodeText)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(bankCodeText), 140);
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ') &&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpCode', mSKS_EFT_FileDetail.RecId));
                
                if(value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', value, 140);
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR'  ||
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' &&
                     mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1 > 310000        &&
                     mSKS_EFT_FileDetail.PaymentCurrencyCode == 'PEN')))
            {
                if(mSKS_EFT_FileDetail.VATNum  != '')
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR')
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'TaxID' + this.CharacterReplacement(mSKS_EFT_FileDetail.VATNum), 140);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'TAXID' + this.CharacterReplacement(mSKS_EFT_FileDetail.VATNum), 140);
                    }
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RO' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                if(mSKS_EFT_FileDetail.DepSwiftNo)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'Fiscal Code:'+ mSKS_EFT_FileDetail.DepSwiftNo, 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BY' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TaxId', mSKS_EFT_FileDetail.RecId));
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));
    
                if(taxId  || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', taxId, 70);

                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', rsnForPmt, 70);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' &&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TaxId', mSKS_EFT_FileDetail.RecId));
                rsnForPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RsnForPmt', mSKS_EFT_FileDetail.RecId));
    
                if(taxId  || rsnForPmt)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', rsnForPmt, 70);

                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', taxId, 70);

                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                benId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenId', mSKS_EFT_FileDetail.RecId));
                
                if(benId)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', benId, 140);
                }
            }

            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                dob = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DOB', mSKS_EFT_FileDetail.RecId));
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BudgPaymts', mSKS_EFT_FileDetail.RecId));

                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //              2.99: Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/DTYPE/PORD');

                if(value)
                {
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/BAEREF/'+ value, 140);
                }
                else
                {
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/BAEREF/');
                }
                if(dob)
                {
                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'DOB '+ dob);
                }
            }
            //SKG#VSTS:8991
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PR'     &&
                     mSKS_EFT_FileDetail.PaymSpec == 'PPD')
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RmtInf', mSKS_EFT_FileDetail.RecId));  //SKS_FDD_10590
    
                if(value)
                {
                    //          2.98: RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                    //              2.99: Ustrd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', value, 140);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SIP962)     //SKS#DevOps:14844
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //              2.99: Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '');

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', 'PYMT TYPE0099');
            }               //SKS_VSTS_12761--->
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CN'    ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KR'    ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP'    ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK'    ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG')
            {
                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-XML-CN':
                        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                        {
                            case #CHK402:
                            case #DFT391:
                            case #PLG400:
                                j = 2;
                                break;
                            default:
                                j = 4;
                                break;
                        }
                        break;
                    case 'US-CITICONNECT-XML-KR':
                    case 'US-CITICONNECT-XML-JP':
                    case 'US-CITICONNECT-XML-SG':
                        j = 4;
                        break;
                    case 'US-CITICONNECT-XML-HK':
                        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                        {
                            case #ATPAY403:
                                j = 2;
                                break;
                            case #CHECK405:
                            case #CHK405:
                                j = 3;
                                break;
                            default:
                                j = 4;
                                break;
                        }
                        break;
                }

                //                  RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                i = 1;
                while select InvoiceNumber, InvoiceDate, PaymentCurrencyCode, InvoiceSettleAmountPmtCur from invSKS_EFT_FileDetail
                    where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId
                {
                    if(i <= j)
                    {
                        i++;

                        invDetailsString = strFmt('/PMDD/%1 %2 %3%4', invSKS_EFT_FileDetail.InvoiceNumber, date2str(invSKS_EFT_FileDetail.InvoiceDate, 321, DateDay::Digits2, DateSeparator::Hyphen, DateMonth::Digits2, DateSeparator::Hyphen, DateYear::Digits4), invSKS_EFT_FileDetail.PaymentCurrencyCode, num2Str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1, 0, 2, 1, 0));
                    
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(invDetailsString), 35, false);
                    }
                }
            }                   //SKS_VSTS_12761<----
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN' &&
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 ||
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392))      //SKS#DevOps:16681
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurposeCode', mSKS_EFT_FileDetail.RecId));

                //                  RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                //                      Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(value, 1, 35), 35, false);

                //                      Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(value, 36, 35), 35, false);

                //                      Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(value, 71, 35), 35, false);

                //                      Ustrd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(value, 105, 35), 35, false);
            }
            else if((idType || prdYear || prdType || prdRange || pmtSymbol) &&
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX592 )
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', idType + prdYear + prdType + prdRange + pmtSymbol, 140, false);
            }
            else if((invNumbers || value || ledgerTransPaymId) && mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-MY') //SKG#VSTS:8991
            {
                //          2.98: RmtInf
                nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
    
                //SKG#VSTS:8991
                

                //SKG#VSTS:8629
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AE' &&
                    (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT574 ||
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574))
                {
                    value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Ustrd-Prefix', mSKS_EFT_FileDetail.RecId));    //SKS_FDD_10590

                    if(value)
                    {
                        value = value + invNumbers;
                    }
                }
                //SKG#VSTS:8629
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150)
                {
                    while select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId
                    {                                        
                        value += this.CharacterReplacement(strFmt('%1 %2 ',mSKS_EFT_FileDetail.PaymId,mSKS_EFT_FileDetail.PaymentReference));
                    }
                }
                //              2.99: Ustrd
                if(value)
                {
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(strLRTrim(value)), 25);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(value), 140);
                    }
                }
                else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574        ||
                        (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL'&&          //SKG#VSTS:10574
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555))       &&          //SKG#VSTS:14212
                         invNumbers)
                {
                    for(i=0; i<3; i++)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 35, false);
    
                        invNumbers = strDel(invNumbers,1,35);
                    }
                }
                else if(invNumbers  &&
                        (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391 ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392  ||           //SKG#VSTS:10575
                        ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'||   //SKG#VSTS:12473
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU'||
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO') && //SKG#VSTS:17266
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574)))
                {
                    for(i=0; i<4; i++)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 35, false);
    
                        invNumbers = strDel(invNumbers,1,35);
                    }
                }
                else if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NL'&&
                        (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA ||
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB_WIRE))||    //SKS#DevOps:16938
                        (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US'&&
                        (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP ||
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP ||
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499 ||
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821)))  //SKS#DevOps:16937
                {
                    if(ledgerTransPaymId && invNumbers)
                    {
                        invNumbers = invNumbers + ', ' + ledgerTransPaymId;
                    }
                    else if(ledgerTransPaymId)
                    {
                        invNumbers = ledgerTransPaymId;
                    }
                    for(i=0; i<4; i++)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', invNumbers, 35, false);
    
                        invNumbers = strDel(invNumbers,1,35);
                    }
                }
                else
                {
                    switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                    {
                        case #ACH809:              //SKG#VSTS:10574
                            len = 20;
                            break;
                        case #ACH410:              //SKG#VSTS:10575
                            len = 35;
                            invNumbers = strUpr(invNumbers);
                            break;
                        default:
                            len = 140;
                            break;
                    }
                    if(invNumbers)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', this.CharacterReplacement(invNumbers), len);
                    }
                }
            }
            else
            {
                paymDetails = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PaymDetails', mSKS_EFT_FileDetail.RecId));   //SKS_FDD_10590
    
                if(paymDetails && mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'   &&
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527                 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK415                  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391                  ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392                 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393))
                {
                    //                  RmtInf
                    nodeRmtInf = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('RmtInf'));
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392  ||
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', paymDetails, 35, false);
                    }
                    else
                    {
                        this.getBankPurposeCode();
                        purpose = subStr(bankCodeText,1 ,140);
    
                        for(i=0; i<4; i++)
                        {
                            if(i == 0)
                            {
                                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', paymDetails, 35, false);
                            }
                            else if(i == 1)
                            {
                                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527)
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/PMDD/.', 0, false);
                                }
                                else
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(purpose, 1, 35), 0, false);
                                }
                            }
                            else if(i == 2)
                            {
                                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527)
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/PMDD/' + subStr(invNumbers, 1, 35), 0, false);
                                }
                                else
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(purpose, 36, 35), 0, false);
                                }
                            }
                            else if(i == 3)
                            {
                                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527)
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', '/PMDD/' + subStr(invNumbers, 35, 35), 0, false);
                                }
                                else
                                {
                                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', subStr(purpose, 71, 35), 0, false);
                                }
                            }
                        }
                    }
                }
            }
            if((mSKS_EFT_FileDetail.PaymentCurrencyCode == 'GYD' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'BBD') &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)         //SKS#DevOps:17206
            {
                PurpOfPmt = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PurpOfPmtGYDBBD', mSKS_EFT_FileDetail.RecId));   //SKS_FDD_10590
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRmtInf, 'Ustrd', PurpOfPmt, 140, false);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_GrpHdr_InitgPty_Id</Name>
				<Source><![CDATA[
    protected void node_GrpHdr_InitgPty_Id(XmlElement _nodeInitgPty)
    {
        //------------------------------------------------------------------------------------------------------
        //      1.8: InitgPty
        //          9.1.12: Id
        //              9.1.13: OrgId
        //                  9.1.15: Othr
        //                      9.1.1.16: Id
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeId;
        XmlElement nodeOrgId;
        XmlElement nodeOther;
        XmlElement nodeSchemeNm;
        str InitgPtyId, w02;        //SKS_FDD_10590

        SKS_EFT_FileDetail      locSKS_EFT_FileDetail;      //SKS_VSTS_13549--->

        select * from locSKS_EFT_FileDetail
            where locSKS_EFT_FileDetail.FileRecId == mSKS_EFT_File.RecId &&
                  locSKS_EFT_FileDetail.RecordSection == SKS_EFT_RecordSection::Payments &&
                  locSKS_EFT_FileDetail.RecordSummary != SKS_EFT_RecordSummary::NonSummary;

        while(locSKS_EFT_FileDetail)
        {
            if(!strContains(locSKS_EFT_FileDetail.FormatId, 'WL-XML')   &&
               locSKS_EFT_FileDetail.TransactionCode != #IFT_CB392      &&
               locSKS_EFT_FileDetail.TransactionCode != #RTGS539)           //SKS#DevOps:16696
            {
                next locSKS_EFT_FileDetail;
            }
            else
            {
                break;
            }
        }

        if(locSKS_EFT_FileDetail)
        {
            InitgPtyId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InitgPtyId', locSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));
            if((InitgPtyId)                                              &&      //SKS_FDD_10590
              (locSKS_EFT_FileDetail.FormatId == 'US-CITICONNECT-XML-US' ||
               locSKS_EFT_FileDetail.TransactionCode == #ACH_WL          ||
               locSKS_EFT_FileDetail.TransactionCode == #WIRE_WL         ||
               locSKS_EFT_FileDetail.TransactionCode == #CHK_WL          ||
               locSKS_EFT_FileDetail.TransactionCode == #SEPA_WL         ||
               locSKS_EFT_FileDetail.TransactionCode == #RTGS539         ||     //SKS#DevOps:16696
               locSKS_EFT_FileDetail.TransactionCode == #IFT_CB392)        &&
               (locSKS_EFT_FileDetail.TransactionCode != #CPS28          &&
                locSKS_EFT_FileDetail.TransactionCode != #CPS29           &&
                locSKS_EFT_FileDetail.TransactionCode != #USFCP821))
            {
                //          9.1.12: Id
                nodeId = _nodeInitgPty.appendChild(xmlDoc.createElement('Id'));
    
                //              9.1.13: OrgId
                nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
                //                  9.1.15: Other
                nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
                if(locSKS_EFT_FileDetail.TransactionCode == #ACH_WL   ||
                   locSKS_EFT_FileDetail.TransactionCode == #WIRE_WL  ||
                   locSKS_EFT_FileDetail.TransactionCode == #CHK_WL   ||
                   locSKS_EFT_FileDetail.TransactionCode == #SEPA_WL)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 9);     //SKS_FDD_10590
                }                
                else if(locSKS_EFT_FileDetail.TransactionCode == #RTGS539 ||     //SKS#DevOps:16696
                        locSKS_EFT_FileDetail.TransactionCode == #IFT_CB392) 
                {
                    //                      9.1.1.16: Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 35);
                }
                else
                {
                    //                      9.1.1.16: Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 35);     //SKS_FDD_10590
                }
            }
        }
        else            //SKS_VSTS_13549<----
        {
            // Get SKS_EFT_FileFormatPaymSpec
            this.getSKS_EFT_FileFormatPaymSpec();

            InitgPtyId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('InitgPtyId', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

            w02 = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('FwdgAgtScheme', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

            if(InitgPtyId != ''                                                        &&      //SKS_FDD_10590
               ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL         ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL)        ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL          ||      //SKS#VSTS:14271
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL)         &&   //SKS#DevOps:14542
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS28          &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS29          &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode != #USFCP821))
            {
                //          9.1.12: Id
                nodeId = _nodeInitgPty.appendChild(xmlDoc.createElement('Id'));
    
                //              9.1.13: OrgId
                nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
                //                  9.1.15: Other
                nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL  ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL   ||                  //SKS#VSTS:14271
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL)                   //SKS#DevOps:14542
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 9);     //SKS_FDD_10590
                }
                else if(w02 && InitgPtyId && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE)
                {
                    //                      9.1.1.16: Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 35);

                    if(w02 !='' && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE)
                    {
                        nodeSchemeNm = nodeOther.appendChild(xmlDoc.createElement('SchemeNm'));
        
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchemeNm, 'Prtry', w02, 35);
                    }
                }
                else
                {
                    //                      9.1.1.16: Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(InitgPtyId), 35);     //SKS_FDD_10590
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf</Name>
				<Source><![CDATA[
    protected void node_PmtInf()
    {
        //------------------------------------------------------------------------------------------------------
        //  2.0: PmtInf
        //      2.1: PmtInfId
        //      2.2: PmtMtd
        //      2.4: NbOfTxs
        //      2.5: CtrlSum
        //      2.6: PmtTpInf
        //      2.17: ReqdExctnDt
        //      2.19: Dbtr
        //      2.20: DbtrAcct
        //      2.21: DbtrAgt
        //      2.24 ChrgBr
        //------------------------------------------------------------------------------------------------------
        SKS_EFT_FileDetail tmpSKS_EFT_FileDetail;

        batchCount++;

        // Select count and sum for this bank account
        select COUNT(InvoiceOrigAmountCur), SUM(InvoiceSettleAmountPmtCur) from tmpSKS_EFT_FileDetail
            where
                tmpSKS_EFT_FileDetail.FileRecId == mSKS_EFT_File.RecId &&
                tmpSKS_EFT_FileDetail.RecordSection == SKS_EFT_RecordSection::Payments &&
                tmpSKS_EFT_FileDetail.RecordSummary != SKS_EFT_RecordSummary::NonSummary &&
                tmpSKS_EFT_FileDetail.BankAccountId == mSKS_EFT_FileDetail.BankAccountId &&
                tmpSKS_EFT_FileDetail.EffectiveDate == mSKS_EFT_FileDetail.EffectiveDate &&
                tmpSKS_EFT_FileDetail.PaymMode == mSKS_EFT_FileDetail.PaymMode &&
                tmpSKS_EFT_FileDetail.PaymSpec == mSKS_EFT_FileDetail.PaymSpec &&
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == mSKS_EFT_FileDetail.PaymentCurrencyCode &&
                tmpSKS_EFT_FileDetail.PaymentCompany == mSKS_EFT_FileDetail.PaymentCompany;//SKS_Bug_12510

        //  2.0: PmtInf
        nodePmtInf = nodeRoot.appendChild(xmlDoc.createElement('PmtInf'));

        //      2.1: PmtInfId
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'PmtInfId', SKS_PP_StringFormats::strRight(mSKS_EFT_File.FileNbr + '-' + int2str(batchCount),35));

        //      2.2: PmtMtd
        if(mSKS_EFT_FileDetail.Module == SKS_EFT_Module::AR)
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'PmtMtd', 'DD');
        }
        else if(mSKS_EFT_FileFormatPaymSpec.UseCheckNumber == NoYes::Yes ||
            subStr(mSKS_EFT_FileDetail.PaymSpec, 1, 3) == 'CHK'          ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK427     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK416     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK815     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405)
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'PmtMtd', 'CHK');
        }
        else
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'PmtMtd', 'TRF');
        }

        //      2.4: NbOfTxs
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'NbOfTxs', num2str(tmpSKS_EFT_FileDetail.InvoiceOrigAmountCur,0,0,0,0));

        if(mSKS_EFT_FileDetail.Module == SKS_EFT_Module::AP || mSKS_EFT_FileDetail.Module == SKS_EFT_Module::BTB || mSKS_EFT_FileDetail.Module == SKS_EFT_Module::CNP)
        {
            if((mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XOF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XAF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'XPF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'BIF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KMF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'GNF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'HUF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'ISK' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'IDR' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'JPY' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'LAK' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'PYG' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RWF' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'UGX' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VUV' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'VND' ||
                mSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')&&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)     //SKS#DevOps:17344
            {
                //      2.5: CtrlSum
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'CtrlSum', num2str(tmpSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,0,0,0));
            }
            else
            {
                //      2.5: CtrlSum
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'CtrlSum', num2str(tmpSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0));
            }
        }
        else
        {
            //      2.5: CtrlSum
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'CtrlSum', num2str(tmpSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur,0,2,1,0));
        }

        //      2.6: PmtTpInf
        if((mSKS_EFT_FileFormatPaymSpec.UseCheckNumber == NoYes::No && subStr(mSKS_EFT_FileDetail.PaymSpec, 1, 3) != 'CHK')||
            mSKS_EFT_FileDetail.PaymSpec == #CHK_WL ||
            mSKS_EFT_FileDetail.PaymSpec == #CHK_WL_RC ||
            mSKS_EFT_FileDetail.PaymSpec == #CHK19 ||
            mSKS_EFT_FileDetail.PaymSpec == #CHK950)    //SKS_VSTS_13477
        {
            this.node_PmtInf_PmtTpInf(nodePmtInf);
        }

        if(mSKS_EFT_FileDetail.Module == SKS_EFT_Module::AR)
        {
            //      2.18: ReqdColltnDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'ReqdColltnDt', SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate, DateSeparator::Hyphen));
        }
        else
        {
            //      2.17: ReqdExctnDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtInf, 'ReqdExctnDt', SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate, DateSeparator::Hyphen));
        }

        //For AP
        if(mSKS_EFT_FileDetail.Module == SKS_EFT_Module::AP ||
           mSKS_EFT_FileDetail.Module == SKS_EFT_Module::BTB||
           mSKS_EFT_FileDetail.Module == SKS_EFT_Module::CNP)
        {
            this.node_PmtInf_DbtrNodes(nodePmtInf);
        }

        //For AR
        if(mSKS_EFT_FileFormatPaymSpec.UseWithCustomers && mSKS_EFT_FileDetail.Module == SKS_EFT_Module::AR)
        {
            this.node_PmtInf_CdtrNodes(nodePmtInf);
        }

        //      2.24 ChrgBr
        this.node_PmtInf_ChrgBr(nodePmtInf);
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_GrpHdr</Name>
				<Source><![CDATA[
    protected void node_GrpHdr()
    {
        //------------------------------------------------------------------------------------------------------
        //  1.0: GrpHdr
        //      1.1: MsgId
        //      1.2: CreDtTm
        //      1.6: NbOfTxs
        //      1.7: CtrlSum
        //      1.8: InitgPty
        //          Nm
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeGrpHdr;
        SKS_EFT_FileDetail tmpSKS_EFT_FileDetail;
        real amount;
        boolean isSpecific = true;
    
        // Select count and sum for this file
        while select InvoiceOrigAmountCur, InvoiceSettleAmountPmtCur, PaymentCurrencyCode, TransactionCode from tmpSKS_EFT_FileDetail
            where
                tmpSKS_EFT_FileDetail.FileRecId == mSKS_EFT_File.RecId &&
                tmpSKS_EFT_FileDetail.RecordSection == SKS_EFT_RecordSection::Payments &&
                tmpSKS_EFT_FileDetail.RecordSummary != SKS_EFT_RecordSummary::NonSummary
        {
            if((tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'XOF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'XAF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'XPF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'BIF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'KMF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'GNF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'HUF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'ISK' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'IDR' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'JPY' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'KRW' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'LAK' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'PYG' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'RWF' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'TWD' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'UGX' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'VUV' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'VND' ||
                tmpSKS_EFT_FileDetail.PaymentCurrencyCode == 'CLP')&&
                tmpSKS_EFT_FileDetail.TransactionCode == #WIRE_WL)     //SKS#DevOps:17344
            {
                amount+= str2Num(num2str(tmpSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur,0,0,0,0));
            }
            else
            {
                amount+= str2Num(num2str(tmpSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur,0,2,1,0));
                isSpecific = false;
            }
        }
    
        SKS_EFT_FileDetail tmpSKS_EFT_FileDetail1;

        // Select count and sum for this file
        select COUNT(InvoiceOrigAmountCur) from tmpSKS_EFT_FileDetail1
            where
                tmpSKS_EFT_FileDetail1.FileRecId == mSKS_EFT_File.RecId &&
                tmpSKS_EFT_FileDetail1.RecordSection == SKS_EFT_RecordSection::Payments &&
                tmpSKS_EFT_FileDetail1.RecordSummary != SKS_EFT_RecordSummary::NonSummary;

        //  1.0: GrpHdr
        nodeGrpHdr = nodeRoot.appendChild(xmlDoc.createElement('GrpHdr'));
    
        //      1.1: MsgId
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeGrpHdr, 'MsgId', SKS_PP_StringFormats::strRight(mSKS_EFT_File.FileNbr,35));
    
        //      1.2: CreDtTm
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeGrpHdr, 'CreDtTm', DateTimeUtil::toStr(DateTimeUtil::utcNow()));
    
        //      1.3: Authstn
        this.node_GrpHdr_Authstn(nodeGrpHdr);
    
        //      1.6: NbOfTxs
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeGrpHdr, 'NbOfTxs', num2str(tmpSKS_EFT_FileDetail1.InvoiceOrigAmountCur,0,0,0,0));
    
        
        //      1.7: CtrlSum
        if(isSpecific)
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeGrpHdr, 'CtrlSum', num2str(amount * -1,0,0,0,0));
        }
        else
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeGrpHdr, 'CtrlSum', num2str(amount * -1,0,2,1,0));
        }            
    
        //      1.8: InitgPty
        this.node_GrpHdr_InitgPty(nodeGrpHdr);

        //      FwdgAgt
        this.node_GrpHdr_FwdgAgt(nodeGrpHdr);

    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_BtchBookg</Name>
				<Source><![CDATA[
    protected void node_PmtInf_BtchBookg(XmlElement _BtchBookg)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.3: BtchBookg
        //------------------------------------------------------------------------------------------------------
    
        if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-DE'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-FR'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-FI'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IE'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NL'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IT'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SK'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-GB') &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA         ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC           ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938          ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA939          ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848)
        {
            //              2.3: BtchBookg
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _BtchBookg, 'BtchBookg', 'true');
        }
        else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP'  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391)         //SKG#VSTS:13218
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _BtchBookg, 'BtchBookg', 'False');
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391)         //SKG#VSTS:10575
        {
            if(strUpr(this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BtchBookg', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank))) == 'Y')        //SKS_FDD_10590
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _BtchBookg, 'BtchBookg', 'TRUE');
            }
            else
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _BtchBookg, 'BtchBookg', 'FALSE');
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Cdtr_Id</Name>
				<Source><![CDATA[
    protected void node_PmtInf_Cdtr_Id(XmlElement _nodeCdtr)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.79: Cdtr
        //          Id
        //              OrgId
        //                  Othr
        //                      Id
        //                      SchemeName
        //          or
        //              PrvtId
        //                  Othr
        //                      Id
        //                      SchemeName
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeId;
        XmlElement nodeOrgPvtId;
        XmlElement nodeOthr;
        XmlElement nodeSchmeNm;       
        str CdtrId;
        str TaxID, value, benId;
    
        if(((mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT602  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT603  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT604 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS28   &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CPS29   &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #USFCP821&&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT442 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH_WL  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE_WL &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT827 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK815  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_WL  &&          //SKS#VSTS:14271
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_PH_WL&&         //SKS#DevOps:14542
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BKT547  &&          //SKG#VSTS:10808
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DFT541  &&          //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #RTGS539 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TAX908  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TAX927  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TAX947  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #IFT_CB392&&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CDT862  &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CBFT574 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM789 &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM903 )||
            (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #DOM555 ||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN'))||
            ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO'||
              mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK'||
              mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR'||
              mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ')&&
              mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL))
        {
    
            TaxID = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenTaxId', mSKS_EFT_FileDetail.RecId));        //SKS_FDD_10590
    
            benId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BenId', mSKS_EFT_FileDetail.RecId));       //SKS_FDD_10590

            if(TaxID == '')
            {
                TaxID = mSKS_EFT_FileDetail.VATNum;
            }

            if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950 ||        //SKG#VSTS:13477
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950)          //SKG#VSTS:13477
            {
                //          Id
                nodeId = _nodeCdtr.appendChild(xmlDoc.createElement('Id'));
                nodeOrgPvtId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
                nodeOthr = nodeOrgPvtId.appendChild(xmlDoc.createElement('Othr'));
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.AccountNum, 15);
            }
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950)         //SKS#DevOps:20170
            {
                select firstonly RegCustomerID from lSKS_PP_Setup;
                //          Id
                nodeId = _nodeCdtr.appendChild(xmlDoc.createElement('Id'));

                //              OrgId
                nodeOrgPvtId = nodeId.appendChild(xmlDoc.createElement('OrgId'));

                //                  Othr
                nodeOthr = nodeOrgPvtId.appendChild(xmlDoc.createElement('Othr'));

                if(lSKS_PP_Setup.RegCustomerID == '42767e')     //SKS#DevOps:20170
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', this.getCdtr_ID());
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.AccountNum, 15);
                }
            }
            else if((TaxID != '' || benId != '') &&
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode != #ACH410 &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE391 &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392))
            {
                //          Id
                nodeId = _nodeCdtr.appendChild(xmlDoc.createElement('Id'));
                CdtrId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CdtrId', mSKS_EFT_FileDetail.RecId));         //SKS_FDD_10590
                if(CdtrId == 'PrvtId')
                {
                    nodeOrgPvtId = nodeId.appendChild(xmlDoc.createElement('PrvtId'));
                }
                else
                {
                    nodeOrgPvtId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
                }
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOrgPvtId, 'BICOrBEI', benId);
                }
                else
                {
                    nodeOthr = nodeOrgPvtId.appendChild(xmlDoc.createElement('Othr'));
                
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809)
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', TaxID, 1);
                    }
                    else
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', TaxID);
                    }
    
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE_WL)
                    {
                        nodeSchmeNm = nodeOthr.appendChild(xmlDoc.createElement('SchmeNm'));
    
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'TXID');
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BPAY889)
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BillerCode', mSKS_EFT_FileDetail.RecId));      //SKS_FDD_10590
    
                if(value)
                {
                    //          Id
                    nodeId = _nodeCdtr.appendChild(xmlDoc.createElement('Id'));
    
                    //            OrgId
                    nodeOrgPvtId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
                    //                  Othr
                    nodeOthr = nodeOrgPvtId.appendChild(xmlDoc.createElement('Othr'));
    
                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, 10);
                    //                          SchmeNm
                    nodeSchmeNm = nodeOthr.appendChild(xmlDoc.createElement('SchmeNm'));
    
                    //                      Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', value);
    
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>getCdtr_ID</Name>
				<Source><![CDATA[
    protected str getCdtr_ID()
    {
        //Method added for Nexstar customer
        return '';
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Cdtr_CtctDtls</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_PmtInf_Cdtr_CtctDtls
    /// </summary>
    /// <param name = "_nodeCdtr">_nodeCdtr</param>
    protected void node_PmtInf_Cdtr_CtctDtls(XmlElement _nodeCdtr)
    {
        XmlElement nodeCtctDtls;
        str address;
        
        address = SKS_EFT_Format::getCodelookupvalue('PayPalEmail', mSKS_EFT_FileDetail.RecId);  //SKS#DevOps:14542, 14972

        if(address  && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL)
        {
            //              CtctDtls
            nodeCtctDtls = _nodeCdtr.appendChild(xmlDoc.createElement('CtctDtls'));
            
            //                  EmailAdr
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtctDtls, 'EmailAdr', address, 127);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Cdtr_PstlAdr</Name>
				<Source><![CDATA[
    protected void node_PmtInf_Cdtr_PstlAdr(XmlElement _nodeCdtr)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.19: Cdtr
        //          PstlAdr
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodePstlAdr;
        str address, address1, address2;
        str value,benType,resStatus,transType,transFacilityType;
        str iinbin, eknp,bdcode, iin, kpp;
        VendBankAccount                 mVendBankAccount;

        EventHandlerResult result = new EventHandlerResult();

        this.getBankPurposeCode();

        mVendBankAccount = VendBankAccount::findByCompany(mSKS_EFT_FileDetail.AccountCompany, mSKS_EFT_FileDetail.AccountNum, mSKS_EFT_FileDetail.DepBankAccountId);

        this.node_PmtInf_Cdtr_PstlAdr_delegate(_nodeCdtr,mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, mVendBankAccount, xmldoc, result);
    
        if(!result.result())
        {
            value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ARState', mSKS_EFT_FileDetail.RecId));

            if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL) &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU')
            {
                //      PstlAdr
                nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceAdrLine1, 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', '/' + subStr(mRemittanceCity + '/ /' + mRemittanceZipCode + '/', 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', '/' + subStr(mRemittanceState +'/ /' + 'AU' + '/', 1, 35), 0, false);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US')
            {
                //      PstlAdr
                nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceAdrLine1, 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceCity + ',' + mRemittanceState, 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr('US' +',' + mRemittanceZipCode, 1, 35), 0, false);
            }            
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                    this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'EC')
            {
                mRemittanceAdrLine1 = mRemittanceAdrLine1 + mRemittanceAdrLine2;

                if(strLen(mRemittanceName) > 35)
                {
                    address = address + subStr(mRemittanceName, 36, 105) + ' ADD-';
                }
                if(mRemittanceAdrLine1)
                {
                    address = address + mRemittanceAdrLine1;
                }
                if(mRemittanceZipCode)
                {
                    address = address + ' ' + mRemittanceZipCode;
                }
                if(mRemittanceCountryRegionId)
                {
                    address = address + ' ' + mRemittanceCountryRegionId;
                }
                if(address)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 1, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 36, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 71, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 106, 35)), 0, false);
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392 )&&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')       //SKS#DevOps:16681
            {
                this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 0, mRemittanceAdrline2, mRemittanceState, true);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DE')       //SKS#VSTS:14721
            {
                this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, subStr(mRemittanceAdrline1, 1, 35), mRemittanceZipCode, mRemittanceCity, 0, subStr(mRemittanceAdrline1, 36, 35), mRemittanceState, true);
            }
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BM'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BY'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GE'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HN'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MM'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HT'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MU'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PH'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PL'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RO'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RS'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PY'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG'   ||
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US'  &&
                    (this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'PA' ||
                     this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'AR' ||
                     this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'EI' ||
                     this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'UA' ||
                     this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'ZW'))))       //SKS#DevOps:14656
            {
                if(strLen(mRemittanceName) > 35)
                {
                    address = address + subStr(mRemittanceName, 36, 105) + ' ADD-';
                }
                if(mRemittanceAdrLine1)
                {
                    address = address + mRemittanceAdrLine1;
                }
                if(mRemittanceAdrLine2)
                {
                    address = address + ' ' + mRemittanceAdrLine2;
                }
                if(mRemittanceCity)
                {
                    address = address + ' ' + mRemittanceCity;
                }
                if(mRemittanceCountryRegionId)
                {
                    address = address + ' ' + mRemittanceCountryRegionId;
                }
                if(mRemittanceState)
                {
                    address = address + ' ' + mRemittanceState;
                }
                if(mRemittanceZipCode)
                {
                    address = address + ' ' + mRemittanceZipCode;
                }
                
                if(address)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 1, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 36, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 71, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 106, 35)), 0, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU')
            {
                //      PstlAdr
                nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(this.CharacterReplacement(mRemittanceAdrLine1), 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(this.CharacterReplacement(mRemittanceAdrLine2), 1, 35), 0, false);

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(this.CharacterReplacement(mRemittanceCity) + ', ' + this.CharacterReplacement(mRemittanceState) + ' ' +
                    mRemittanceZipCode + ' ' + this.getLogisticsAddressCountryISO(mRemittanceCountryRegionId), 1, 35), 0, false);
            
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ')
            {
                iinbin = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('IINBIN', mSKS_EFT_FileDetail.RecId));
                eknp = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('EKNP', mSKS_EFT_FileDetail.RecId));
                bdcode = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BudgetCode', mSKS_EFT_FileDetail.RecId));

                if(iinbin || eknp || bdcode)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', 'IIN/BIN' + iinbin, 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', 'EKNP' + eknp, 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', bdcode, 35, false);
                }
            }
            else if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU') &&
                    mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RUB' &&
                    !result.result())
            {
                iin = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('IINBIN', mSKS_EFT_FileDetail.RecId));
                kpp = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('KPP', mSKS_EFT_FileDetail.RecId));

                if(iin || kpp)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', 'INN' + subStr(iin, 1, 12), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', 'KPP ' + kpp, 0, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID')
            {
                benType = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BeneType', mSKS_EFT_FileDetail.RecId));
                resStatus = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('ResStatus', mSKS_EFT_FileDetail.RecId));
                transType = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TransType', mSKS_EFT_FileDetail.RecId));
                transFacilityType = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TransFacilityType', mSKS_EFT_FileDetail.RecId));
                
                if(benType || resStatus || transType || transFacilityType || (strLen(mRemittanceName) > 35))
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    if(strLen(mRemittanceName) > 35)
                    {
                        mRemittanceName = subStr(mRemittanceName, 36, 105);     //SKS#VSTS:13972

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mRemittanceName), 35, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(this.CharacterReplacement(mRemittanceName), 36, 35), 35, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(this.CharacterReplacement(mRemittanceName), 71, 35), 35, false);
                    }

                    address = strFmt('SKN/%1/%2/%3/%4',benType,resStatus,transType,transFacilityType);
                    //          AdrLine
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address), 35, false);
                }
                
            }
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN')       //SKS_VSTS_14722
            {
                if(strLen(mRemittanceName) > 35)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceName, 36, 35), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceName, 71, 35), 0, false);
                }
            }  
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                     (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG' ||
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM' ||       //SKS#DevOps:16946
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY' ||       //SKS#DevOps:18131
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JM' ||       //SKS#DevOps:19378
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MV' ||       //SKS#DevOps:20079
                      mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GM'))        //SKS#DevOps:17970
            {
                this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 35, mRemittanceAdrLine2, mRemittanceState, true);
            }
            //SKS_VSTS_13275<---
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)       //SKS#DevOps:14656
            {
                if(strLen(mRemittanceName) > 35)
                {
                    address = address + subStr(mRemittanceName, 36, 105) + ' ADD-';
                
                    if(mRemittanceAdrLine1)
                    {
                        address = address + mRemittanceAdrLine1;
                    }
                    if(mRemittanceAdrLine2)
                    {
                        address = address + ' ' + mRemittanceAdrLine2;
                    }
                    if(mRemittanceCity)
                    {
                        address = address + ' ' + mRemittanceCity;
                    }
                    if(mRemittanceCountryRegionId)
                    {
                        address = address + ' ' + mRemittanceCountryRegionId;
                    }
                    if(mRemittanceState)
                    {
                        address = address + ' ' + mRemittanceState;
                    }
                    if(mRemittanceZipCode)
                    {
                        address = address + ' ' + mRemittanceZipCode;
                    }
                    if(address)
                    {
                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 1, 35)), 0, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 36, 35)), 0, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 71, 35)), 0, false);

                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address, 106, 35)), 0, false);
                    }
                }
                else
                {
                    this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 35, mRemittanceAdrLine2, mRemittanceState, true);
                }
            }
            //SKS_VSTS_13275<---
            else if (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL)
            {
                if(strLen(mRemittanceName) > 35)
                {
                    mRemittanceAdrLine1 = subStr(mRemittanceName, 36, 105) + ' ADD-' + mRemittanceAdrLine1 + ' ' + mRemittanceAdrLine2 + ' ' + mRemittanceCity + ' ' + mRemittanceCountryRegionId + ' ' + mRemittanceState + ' ' + mRemittanceZipCode;
                }

                if(strlen(mRemittanceName) > 35)
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(mRemittanceAdrLine1, 1, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(mRemittanceAdrLine1, 36, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(mRemittanceAdrLine1, 71, 35)), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(mRemittanceAdrLine1, 106, 35)), 0, false);
                }
                else
                {
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KH'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NA'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PH'   ||
                      (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                       this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'PA'))
                    {
                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));
    
                        //          StrtNm
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'StrtNm', this.CharacterReplacement(mRemittanceAdrline1), 35, false);
    
                        //          BldgNb
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'BldgNb', this.CharacterReplacement(mRemittanceAdrLine2), 35, false);
    
                        //          PstCd
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', mRemittanceZipCode, 16, false);
    
                        //          TwnNm
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(mRemittanceCity), 35, false);
    
                        //          CtrySubDvsn
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'CtrySubDvsn', this.CharacterReplacement(mRemittanceState), 35, false);
    
                        //          Ctry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);
                    }
                    else
                    {
                        this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 35, mRemittanceAdrLine2, mRemittanceState, true);
                    }
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540)
            {
                if(strLen(mRemittanceName) > 35)
                {
                    mRemittanceAdrLine1 = this.CharacterReplacement(subStr(mRemittanceName, 36, 105) + ' ADD-' + mRemittanceAdrLine1 + ' ' + mRemittanceAdrLine2 + ' ' + mRemittanceCity + ' ' + mRemittanceCountryRegionId + ' ' + mRemittanceState + ' ' + mRemittanceZipCode);
                
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceAdrLine1, 1, 35), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceAdrLine1, 36, 35), 0, false);

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', subStr(mRemittanceAdrLine1, 71, 35), 0, false);
                }
                else
                {
                    this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 35, mRemittanceAdrLine2, mRemittanceState, true);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19 ||          //SKS#DevOps:16893
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP)           //SKS#DevOps:17066
            {
                //      PstlAdr
                nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));
    
                //          PstCd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', strRem(mRemittanceZipCode, '-'), 16, false);       //SKS#DevOps:17066
    
                //          TwnNm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(mRemittanceCity), 35, false);
    
                //          CtrySubDvsn
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'CtrySubDvsn', this.CharacterReplacement(mRemittanceState), 35, false);
    
                //          Ctry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);
    
                address1 = mRemittanceAdrline1;
                address2 = mRemittanceAdrline2;

                if(strLen(mRemittanceName) > 35)            //SKS#DevOps:16961
                {
                    address1 = subStr(mRemittanceName, 36, 35);

                    if(strLen(mRemittanceName) > 70)
                    {
                        address2 = subStr(mRemittanceName, 71, 35);
                    }
                    else
                    {
                        address2 = mRemittanceAdrline1;
                    }
                }
                //          AdrLine
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address1), 35, false);
    
                //          AdrLine 2
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address2), 35, false);
            }
            else if((mRemittanceZipCode != '' || mRemittanceCity != '' || mRemittanceCountryRegionId != '' || mRemittanceAdrline1 != '' || mRemittanceAdrline2 != '') ||
               (value != ''))
            {
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AR'  ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17    ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20    ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453    ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454    ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442  ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK478   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451 ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DD437    ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418   ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950   ||       // SKG#VSTS:13477
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950   ||       // SKG#VSTS:13477
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950   ||       // SKG#VSTS:13477
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY  ||       //DevOps20744 (Port 20684)
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MX'  ||
                  (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'&&
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555))
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));
    
                    //          PstCd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', mRemittanceZipCode, 16, false);
    
                    //          TwnNm
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(mRemittanceCity), 35, false);
    
                    //          CtrySubDvsn
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'CtrySubDvsn', this.CharacterReplacement(value), 35, false);
    
                    //          Ctry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);
    
                    //          AdrLine
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mRemittanceAdrline1), 35, false);
    
                    //          AdrLine 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mRemittanceAdrline2), 35, false);
    
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CA'  &&
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603)                             //DevOps18471
                {
                    if(strLen(mRemittanceName) > 35)
                    {
                        address1 = subStr(mRemittanceName, 36, 105) + ' ADD-';
                    
                        address1 = address1 + mRemittanceAdrline1;
    
                        if(mRemittanceAdrline2)
                        {
                            if(address1)
                            {
                                address1 += ' ';              
                            }
                            address1 += mRemittanceAdrline2;
                        }
                        if(mRemittanceCity)
                        {
                            if(address1)
                            {
                                address1 += ' ';              
                            }
                            address1 += mRemittanceCity;
                        }
                        if(mRemittanceState)
                        {
                            if(address1)
                            {
                                address1 += ' ';               
                            }
                            address1 += mRemittanceState;
                        }
                        if(mRemittanceZipCode)
                        {
                            if(address1)
                            {
                                address1 += ' ';               
                            }
                            address1 += mRemittanceZipCode;
                        }
                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                        //          Ctry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);

                        //          AdrLine
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 1, 35)), 35, false);
                        
                        //          AdrLine 2
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 36, 35)), 35, false);

                        //          AdrLine 3
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 71, 35)), 35, false);
                        
                    }
                    else
                    {

                        address1 = mRemittanceAdrline1;
    
                        if(mRemittanceAdrline2)
                        {
                            if(address1)
                            {
                                address1 += ', ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceAdrline2;
                        }

                        address2 = mRemittanceCity;

                        if(mRemittanceState)
                        {
                            if(address2)
                            {
                                address2 += ', ';               //SKS_VSTS_12787
                            }
                            address2 += mRemittanceState;
                        }
                        if(mRemittanceZipCode)
                        {
                            if(address2)
                            {
                                address2 += ' ';               //SKS_VSTS_12787
                            }
                            address2 += mRemittanceZipCode;
                        }

                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                        //          Ctry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);

                        //          AdrLine
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address1), 35, false);

                        //          AdrLine 2
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address2), 35, false);
                    
                    }
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US'  &&
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499)                      //SKS#DevOps:15095
                {
                    if(strLen(mRemittanceName) > 35)
                    {
                        address1 = subStr(mRemittanceName, 36, 105) + ' ADD-';
                    
                        address1 = address1 + mRemittanceAdrline1;
    
                        if(mRemittanceAdrline2)
                        {
                            if(address1)
                            {
                                address1 += ' ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceAdrline2;
                        }
                        if(mRemittanceCity)
                        {
                            if(address1)
                            {
                                address1 += ' ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceCity;
                        }
                        if(mRemittanceState)
                        {
                            if(address1)
                            {
                                address1 += ' ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceState;
                        }
                        if(mRemittanceZipCode)
                        {
                            if(address1)
                            {
                                address1 += ' ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceZipCode;
                        }
                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                        //          Ctry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);

                        //          AdrLine
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 1, 35)), 35, false);

                        //          AdrLine 2
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 36, 35)), 35, false);

                        //          AdrLine 3
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(subStr(address1, 71, 35)), 35, false);
                    }
                    else
                    {
                        address1 = mRemittanceAdrline1;
    
                        if(mRemittanceAdrline2)
                        {
                            if(address1)
                            {
                                address1 += ', ';               //SKS_VSTS_12787
                            }
                            address1 += mRemittanceAdrline2;
                        }

                        address2 = mRemittanceCity;

                        if(mRemittanceState)
                        {
                            if(address2)
                            {
                                address2 += ', ';               //SKS_VSTS_12787
                            }
                            address2 += mRemittanceState;
                        }
                        if(mRemittanceZipCode)
                        {
                            if(address2)
                            {
                                address2 += ' ';               //SKS_VSTS_12787
                            }
                            address2 += mRemittanceZipCode;
                        }

                        //      PstlAdr
                        nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                        //          Ctry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);

                        //          AdrLine
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address1), 35, false);

                        //          AdrLine 2
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address2), 35, false);
                    }
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP')        //SKS#VSTS:14823
                {
                    //      PstlAdr
                    nodePstlAdr = _nodeCdtr.appendChild(xmlDoc.createElement('PstlAdr'));

                    //          Ctry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', mRemittanceCountryRegionId, 2, false);

                    //          AdrLine 1
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mRemittanceAdrline1), 35, false);

                    //          AdrLine 2
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mRemittanceAdrline2), 35, false);

                    //          AdrLine 3
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(strLTrim(mRemittanceZipCode + ' ' + this.CharacterReplacement(mRemittanceCity))), 35, false);
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BFT551  ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL   ||      //SKS#VSTS:14271
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL||     //SKS#DevOps:14542
                       (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK'&&
                         mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393)||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL ||
                        (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555 &&
                         mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'))
                {
                    this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity, 35, mRemittanceAdrLine2, mRemittanceState, true);                    
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
                {
                    this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, strUpr(mRemittanceAdrline1), strUpr(mRemittanceZipCode), strUpr(mRemittanceCity));
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #BPAY889 &&
                        mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-VN')        //SKS_VSTS_14190
                {
                    this.node_PstlAdr(_nodeCdtr, mRemittanceCountryRegionId, mRemittanceAdrline1, mRemittanceZipCode, mRemittanceCity);
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_ChrgBr</Name>
				<Source><![CDATA[
    protected void node_PmtInf_ChrgBr(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.24 ChrgBr
        //------------------------------------------------------------------------------------------------------
    
        //Not used. Overriding base class
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Dbtr_Id</Name>
				<Source><![CDATA[
    protected void node_PmtInf_Dbtr_Id(XmlElement _nodeDbtr)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.19: Dbtr
        //          9.1.12: Id
        //              9.1.13: OrgId
        //                  9.1.15: Othr
        //                      9.1.16: Id
        //                          9.1.17: SchmeNm
        //                              9.1.18: Cd
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeId;
        XmlElement nodeOrgId;
        XmlElement nodeOther;
        XmlElement nodeSchmeNm;
        XmlElement nodePrvtId;
        str     bankId, panId, taxId, dbtrTaxId;
        int len;

        bankId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BankId', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));
        panId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PANID', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));
        taxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

        dbtrTaxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TAXID', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

        if (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP && dbtrTaxId)       //DevOps#21230, 21966
        {
            //          Id
            nodeId = _nodeDbtr.appendChild(xmlDoc.createElement('Id'));
    
            //              OrgId
            nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
            //                  Othr
            nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
            //                      Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(dbtrTaxId));

            //                      SchmeNm
            nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
            //                          Cd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'TXID');
        }

        else if((panId || taxId) &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX908)      //SKS#DevOps:15853
        {
            //          9.1.12: Id
            nodeId = _nodeDbtr.appendChild(xmlDoc.createElement('Id'));
    
            //              9.1.13: OrgId
            nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));

            if(panId)
            {
                //                  9.1.15: Othr
                nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
                //                      9.1.16: Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', panId, 20);
 
                //                          9.1.17: SchmeNm
                nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
                //                              9.1.18: Prtry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'PANID');
            }
            if(taxId)
            {
                //                  9.1.15: Othr
                nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
                //                      9.1.16: Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', taxId, 20);
 
                //                          9.1.17: SchmeNm
                nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
                //                              9.1.18: Prtry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'TXID');
            }
        }    
        else if(mSKS_EFT_FileDetail_BankAccount.WOrdPartyId &&                                         //SKS_FDD_10590
          ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571  ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'PPD'           ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'FT-607'        ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BPAY889 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950  ||          //SKG#VSTS:13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950  ||          //SKG#VSTS:13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950) ||          //SKG#VSTS:13477
           (mSKS_EFT_FileFormatPaymSpec.PaymSpec != 'BKT-440' &&
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-DO')))
        {
            //          9.1.12: Id
            nodeId = _nodeDbtr.appendChild(xmlDoc.createElement('Id'));
    
            //              9.1.13: OrgId
            nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
            //                  9.1.15: Othr
            nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
            switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
            {
                case #CTX950:
                case #CDM950:
                case #CHK950:
                    len = 10;
                    break;
                default:
                    len = 35;
                    break;
            }

            //                      9.1.16: Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', mSKS_EFT_FileDetail_BankAccount.WOrdPartyId, len);     //SKS_FDD_10590
    
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571)
            {
                //                          9.1.17: SchmeNm
                nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
                //                              9.1.18: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'CUST');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BPAY889)
            {
                //                          9.1.17: SchmeNm
                nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));

                //                              9.1.19: Prtry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'CUST');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950||          //SKG#VSTS:13477
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950||          //SKG#VSTS:13477
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950)           //SKG#VSTS:13477
            {
                //                          9.1.17: SchmeNm
                nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
                //                              9.1.18: Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'TXID');
            }
        }
        else if(bankId != '' &&                                                      //SKS_FDD_10590
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_SEPA       ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848         ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA939         ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938         ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548          ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853)         ||                              //SKG#VSTS:11518
               ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR') &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555))
        {
            //          Id
            nodeId = _nodeDbtr.appendChild(xmlDoc.createElement('Id'));
    
            //              OrgId
            nodeOrgId = nodeId.appendChild(xmlDoc.createElement('OrgId'));
    
            //                  Othr
            nodeOther = nodeOrgId.appendChild(xmlDoc.createElement('Othr'));
    
            //                      Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', this.CharacterReplacement(bankId));          //SKS_FDD_10590
            //                      SchmeNm
            nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
            //                          Cd
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585           ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706           ||
              ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'  ||
               mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR')&&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555))
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'TXID');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853)                                      //SKG#VSTS:11518
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'SOSE');
            }
            else
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'BANK');
            }
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #Tax592)
        {
            //          9.1.12: Id
            nodeId = _nodeDbtr.appendChild(xmlDoc.createElement('Id'));
    
            //          PrvtId
            nodePrvtId = nodeId.appendChild(xmlDoc.createElement('PrvtId'));
    
            //                  9.1.15: Othr
            nodeOther = nodePrvtId.appendChild(xmlDoc.createElement('Othr'));
    
            //                      9.1.16: Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id', mSKS_EFT_FileDetail_BankAccount.WOrdPartyId, 14);
    
            //                          9.1.17: SchmeNm
            nodeSchmeNm = nodeOther.appendChild(xmlDoc.createElement('SchmeNm'));
    
            //                              9.1.18: Cd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DbtrId', mSKS_EFT_FileDetail.RecId)));
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Dbtr_Nm</Name>
				<Source><![CDATA[
    protected void node_PmtInf_Dbtr_Nm(XmlElement _nodeDbtr)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.19: Dbtr
        //          Nm
        //------------------------------------------------------------------------------------------------------
        int len;
    
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #ATPAY403:
            case #CHECK405:
            case #DOM391:
            case #CB392:
            case #DE397:
            case #CHK396:
            case #BPAY889:
            case #BKT393:
            case #ACH809:           //SKG#VSTS:10574
            case #WIRE574:          //SKG#VSTS:10574
            case #ACH410:           //SKG#VSTS:10575
            case #WIRE391:          //SKG#VSTS:10575
            case #WIRE392:          //SKG#VSTS:10575
            case #CDFT392:
            case #SIP962:
            case #GIRO421:          //SKG#VSTS:11471
            case #PRL422:           //SKG#VSTS:11471
            case #CHK420:           //SKG#VSTS:11471
            case #CHK423:           //SKG#VSTS:11471
            case #BKT547:           //SKG#VSTS:11518
            case #DOM555:           //SKG#VSTS:11518
            case #SSK853:           //SKG#VSTS:11518
            case #CHK402:           //SKS_VSTS_12162
            case #SEPA:             //SKG#VSTS:12473
            case #XPRS888:          //SKG#VSTS:12473
            case #TAX592:           //SKG#VSTS:12473
            case #VAT984:           //SKG#VSTS:12473
            case #RTGS605:          //SKG#VSTS:14212
            case #RTGS539:          //SKG#DevOps:15853
            case #DFT541:           //SKG#DevOps:15853
            case #TAX927:           //SKG#DevOps:15853
            case #TAX947:           //SKG#DevOps:15853
            case #IFT_CB392:        //SKG#DevOps:15853
            case #CDT862:           //SKG#DevOps:15853
            case #DOM789:           //SKG#DevOps:17266
                len = 35;
                break;
            case #DOM903:           //SKG#DevOps:17266
                len = 30;
                break;
            case #ACH_WL:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU')
                {
                    len = 18;
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA')
                {
                    len = 30;
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG')
                {
                    len = 12;
                }
                else
                {
                    len = 105;
                }
                break;
            case #WIRE_WL:
            case #CHK_WL:
            case #SEPA_WL:
                len = 105;
                break;
            case #DFT391:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')     //SKS#DevOps:16681
                {
                    len = 35;
                }
                else
                {
                    len = 70;
                }
                break;
            case #CBFT574:              //SKG#VSTS:11518
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'  ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ'  ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL'  ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO'  ||     //SKS#DevOps:17266
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU')         //SKS#DevOps:17266
                {
                    len = 35;                    
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')     //SKS#VSTS:14212
                {
                    len = 30;
                }
                else
                {
                    len = 70;
                }
                break;
            case #DFT555:           //SKG#VSTS:12473
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                {
                    len = 35;
                }
                break;
            case #CBFT392:              //SKG#DevOps:16141
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')     //SKS#VSTS:14212
                {
                    len = 30;
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')     //SKS#DevOps:16681
                {
                    len = 35;
                }
                else
                {
                    len = 70;
                }
                break;
            case #CTX950:        // SKG#VSTS:13477
            case #CDM950:        // SKG#VSTS:13477
            case #CHK950:        // SKG#VSTS:13477
                len = 16;
                break;
            case #PPW_WL:       //SKS#VSTS:14271
            case #PPW_PH_WL:       //SKS#DevOps:14542
                len = 140;
                break;
            case #SEPA938:              //SKG#DevOps:21041
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                {
                    len = 35;
                }
                else
                {
                    len = 70;
                }
                break;
            default:
                len = 70;
                break;
        }
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410   ||            //SKG#VSTS:10575
        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391)
        {
            //          Nm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeDbtr, 'Nm', this.CharacterReplacement(strUpr(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName)), len, false);        //SKS_FDD_10590
        }
        else
        {
            //          Nm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeDbtr, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName), len, false);        //SKS_FDD_10590
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Dbtr_PstlAdr</Name>
				<Source><![CDATA[
    protected void node_PmtInf_Dbtr_PstlAdr(XmlElement _nodeDbtr)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.19: Dbtr
        //          PstlAdr
        //------------------------------------------------------------------------------------------------------
        XmlElement nodePstlAdr;
        str address, address1, address2;

        if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_PG  ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG  ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DD437) &&
            (mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode != ''         ||          //SKS_FDD_10590
            mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity != ''             ||
            mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId != ''  ||
            mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr != ''             ||
            mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2 != ''))
        {
            //      PstlAdr
            nodePstlAdr = _nodeDbtr.appendChild(xmlDoc.createElement('PstlAdr'));

            //          PstCd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode, 16, false);            //SKS_FDD_10590

            //          TwnNm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity), 35, false);        //SKS_FDD_10590

            //          Ctry
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId), 2, false);      //SKS_FDD_10590

            //          AdrLine
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr), 35, false);      //SKS_FDD_10590

            //          AdrLine 2
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2), 35, false);     //SKS_FDD_10590
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH208  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM332  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK405  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK436  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG527  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421 ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL  ||          //SKS#VSTS:14271
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL  ||       //SKS#DevOps:14542
                ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP'||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK') &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393)||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555  &&
               (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-KE'||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UA'))||
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN' &&
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391||
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)))            //SKS#DevOps:16681
        {
            this.node_PstlAdr(_nodeDbtr, mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId, mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr, mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode, mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity, 35, mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2, mSKS_EFT_FileDetail_BankAccount.WOrdPartyState, true);       //SKS_FDD_10590
        }
        else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US'  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499)                  //SKS_VSTS_12702
        {
            address1 = mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr;
    
            if(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2)
            {
                if(address1)
                {
                    address1 += ', ';               //SKS_VSTS_12787
                }
                address1 += mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2;
            }

            address2 = mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity;

            if(mSKS_EFT_FileDetail_BankAccount.WOrdPartyState)
            {
                if(address2)
                {
                    address2 += ', ';               //SKS_VSTS_12787
                }
                address2 += mSKS_EFT_FileDetail_BankAccount.WOrdPartyState;
            }
            if(mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode)
            {
                if(address2)
                {
                    address2 += ' ';               //SKS_VSTS_12787
                }
                address2 += mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode;
            }

            //      PstlAdr
            nodePstlAdr = _nodeDbtr.appendChild(xmlDoc.createElement('PstlAdr'));

            //          Ctry
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId), 2, false);

            //          AdrLine
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address1), 35, false);

            //          AdrLine 2
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(address2), 35, false);
        }
        else
        {
            address = mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr;      //SKS_FDD_10590
    
            if(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2)
            {
                address += ' ' + mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2;      //SKS_FDD_10590
            }
    
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
            {
                this.node_PstlAdr(_nodeDbtr, strUpr(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId), strUpr(address), strUpr(mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode), strUpr(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity), 75);     //SKS_FDD_10590
            }
            else
            {
                this.node_PstlAdr(_nodeDbtr, mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId, address, mSKS_EFT_FileDetail_BankAccount.WOrdPartyZipCode, mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity, 75);     //SKS_FDD_10590
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrAcct</Name>
				<Source><![CDATA[
    protected void node_PmtInf_DbtrAcct(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.20: DbtrAcct
        //          Id
        //              IBAN
        //              Othr
    
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeDbtrAcct;
        XmlElement nodeDbtrAcctId;
        XmlElement nodeOthr;
        XmlElement nodeSchmeNm;
        int length;
    
        //      2.20: DbtrAcct
        nodeDbtrAcct = nodePmtInf.appendChild(xmlDoc.createElement('DbtrAcct'));
    
        //          Id
        nodeDbtrAcctId = nodeDbtrAcct.appendChild(xmlDoc.createElement('Id'));
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392 &&
           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CN')     //SKS#DevOps:16703
        {
            if(mSKS_EFT_FileDetail.BankBankAcct)
            {
                //              Othr
                nodeOthr = nodeDbtrAcctId.appendChild(xmlDoc.createElement('Othr'));
    
                //                  Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.BankBankAcct, 35);
    
                //                  SchmeNm
                nodeSchmeNm = nodeOthr.appendChild(xmlDoc.createElement('SchmeNm'));
    
                //                      Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Cd', 'BBAN');
            }
            else if(mSKS_EFT_FileDetail.BankBankIBAN)
            {
                //              IBAN
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtrAcctId, 'IBAN', mSKS_EFT_FileDetail.BankBankIBAN);
            }
        }
        else if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-RO' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HU'  ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')&&
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574       ||       //SKG#DevOps:17266
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938))               //SKG#DevOps:21041
        {
            if(mSKS_EFT_FileDetail.BankBankAcct)
            {
                //              Othr
                nodeOthr = nodeDbtrAcctId.appendChild(xmlDoc.createElement('Othr'));
    
                //                  Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.BankBankAcct, 10);
            }
        }
        else if((!(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #FT499     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT500    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CACH460   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DC417     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK416  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS429   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS430   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK427  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT602    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT604   ||            
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS29     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM317    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM325    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM332    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH208    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK478    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK405    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #LLG408    ||            
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK436    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DD437     ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG527    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL426    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574   ||                                     //SKG#VSTS:10574
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410    ||                                     //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391   ||                                     //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392   ||                                     //SKG#VSTS:10575
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK415    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405  ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK396    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BPAY889   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK815    ||                                     //SKG#VSTS:10808       
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL422    ||                                     //SKG#VSTS:11471
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK420    ||                                     //SKG#VSTS:11471
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853    ||                                     //SKG#VSTS:11518
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK423    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BFT551    ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK402    ||                                    //SKS_VSTS_12162
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #XPRS888   ||      //SKG#VSTS:12473
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS605   ||      //SKG#VSTS:14212
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950    ||      //SKS_VSTS_13477
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950    ||      //SKS_VSTS_13477
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950    ||      //SKS_VSTS_13477
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT547    ||            
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541    ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539   ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX908    ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX927    ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX947    ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IFT_CB392 ||      //SKG#DevOps:15853
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDT862    ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY'     ||  //DevOps20744 (Port 20684)
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC)   &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-MX' &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN' &&      //SKS#DevOps:16681
                mSKS_EFT_FileDetail.BankBankIBAN != '')|| //SKG#VSTS:7287 & SKG#VSTS:7390
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY' && 
                mSKS_EFT_FileFormatPaymSpec.TransactionCode != #INSTPAY)   ||        //DevOps20744 (Port 20684)
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG    && mSKS_EFT_FileDetail.BankBankAcct == '')||
                ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574    &&
                 mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)    &&            //SKG#DevOps:16141
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-IL')    ||                                 //SKG#VSTS:14212
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555    &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR')    ||
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391    &&
                 mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-SG'&&
                 mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-CN'&&
                 mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN')   ||                                //SKG#VSTS:13142
                (mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-CZ'&&                                //SKG#VSTS:12473
                  mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT555)       ||
                 (mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-GB'&&
                  mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC         &&
                  mSKS_EFT_FileDetail.BankBankIBAN != ''))                        //SKS#DevOps:14844
        {
            //              IBAN
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtrAcctId, 'IBAN', mSKS_EFT_FileDetail.BankBankIBAN);
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPD ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCD     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM391     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CB392      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DC417      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK416   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS429    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IBRS430    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK427   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH964     ||      //SKG#VSTS:7287
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK815   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK804     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT574    ||      //SKG#VSTS:7453
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT574     ||         //SKG#VSTS:7453
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CACH460    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT602     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT604    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS28      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS29      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #USFCP821   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCCP     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHPPP     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CCDP14     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX17      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK585     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX942     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK20      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CPS706     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH780     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM317     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA848    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA939    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH208     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM303     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM325     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM332     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM789     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH150     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA938    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT440     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM441     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH809     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE574    ||      //SKG#VSTS:10574
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410     ||      //SKG#VSTS:10575
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE391    ||      //SKG#VSTS:10575
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE392    ||      //SKG#VSTS:10575
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RT453      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DL454      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT442    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK478     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #LLG408     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK405     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK436     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL398     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DD437      ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM540     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT914     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT410     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL414     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK418     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO421    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG527     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL426     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #GIRO527    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK415     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405   ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK396     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BPAY889    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BFT551     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDFT392    ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SIP962     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK815     ||                     //SKG#VSTS:10808
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT547     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL422     ||      //SKG#VSTS:11471
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK420     ||      //SKG#VSTS:11471
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK423     ||      //SKG#VSTS:11471
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT547     ||      //SKG#VSTS:11518
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853     ||      //SKG#VSTS:11518
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950     ||      //SKS_VSTS_13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDM950     ||      //SKS_VSTS_13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK950     ||      //SKS_VSTS_13477
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS605    ||      //SKG#VSTS:14212
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT541     ||      //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #RTGS539    ||       //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX908     ||       //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX927     ||       //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX947     ||       //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #IFT_CB392  ||       //SKG#DevOps:15853
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_DC     ||       //SKG#DevOps:16877
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CDT862     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM903     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INSTPAY    ||       //DevOps20744 (Port 20684)
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MX' ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY' ||  //SKS_VSTS_11880
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY' ||  //SKS_VSTS_12158
          ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391     ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392)   &&
            (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'||
            (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392   &&
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN') ||     //SKS#DevOps:16681
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')) ||//SKG#DevOps:16141
           (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391     &&
            (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG'||
             mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')))     //SKS#DevOps:16681
        {
            //          Othr
            nodeOthr = nodeDbtrAcctId.appendChild(xmlDoc.createElement('Othr'));
    
            switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
            {
                case #DOM391:
                    length = ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY' ||
                               mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK')? 34 : 35);
                    break;
                case #LLG408:
                case #DFT914:
                case #BKT410:
                case #BFT551:
                case #TAX927:       //SKS#DevOps:15853
                case #TAX947:       //SKS#DevOps:15853
                    length = 35;
                    break;
                case #BKT393:
                    length = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-NZ' ? 35 : 34);
                    break;
                case #CB392:
                    length = ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TW' ||
                                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'||
                                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG'||
                                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-HK') ? 34 : 35);
                    break;
                case #IBRS429:
                case #IBRS430:
                case #CHECK427:
                case #DE397:
                case #PLG400:
                case #ATPAY403:
                case #CHK405:
                case #CHK436:
                case #PRL398:
                case #PRL401:
                case #DD437:
                case #DOM540:
                case #PRL414:
                case #PLG527:
                case #CHK418:
                case #GIRO421:
                case #PRL422:               //SKG#VSTS:11471
                case #CHK420:               //SKG#VSTS:11471
                case #CHK423:               //SKG#VSTS:11471
                case #ATPAY424:
                case #PRL426:
                case #CHECK405:
                case #BPAY889:
                case #DFT541:               //SKS#DevOps:15853
                case #RTGS539:              //SKS#DevOps:15853
                case #TAX908:               //SKS#DevOps:15853
                case #IFT_CB392:            //SKS#DevOps:15853
                case #CDT862:               //SKS#DevOps:15853
                case #TRADE:                //DevOps 18498
                    length = 34;
                    break;
                case #ACH964:
                case #CHECK815:
                    length = 30;
                    break;
                case #DC417:
                case #CHECK416:
                case #DFT555:
                case #CHK804:               //SKG#VSTS:7453
                case #CBFT574:              //SKG#VSTS:7453
                case #DFT574:               //SKG#VSTS:7453
                case #ACH780:  
                case #DOM317:   
                case #DOM555: 
                case #SEPA848:        
                case #SEPA939:
                case #ACH208:
                case #DOM303:
                case #DOM332:
                case #DOM789:
                case #DOM548:
                case #ACH150:
                case #SEPA938:
                case #ACH809:
                case #WIRE574:              //SKG#VSTS:10574
                case #DOM325:
                case #DOM441:
                case #RT453:
                case #DL454:
                case #CHK478:
                case #TLPAY451:
                case #CHK815:                         //SKG#VSTS:10808
                case #BKT547:                         //SKG#VSTS:11518
                case #CDFT392:
                case #SIP962:
                case #CHK493:                         //SKS_VSTS_11880
                case #CHK494:                         //SKS_VSTS_11880
                case #SEPA:                 //SKG#VSTS:12473
                case #XPRS888:              //SKG#VSTS:12473
                case #TAX592:               //SKG#VSTS:12473
                case #VAT984:               //SKG#VSTS:12473
                case #RTGS605:              //SKG#VSTS:14212
                case #DOM903:              //SKS#DevOps:17266
                    length = 10;
                    break;
                case #BKT440:               //SKS#DevOps:14956
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CR')
                    {
                        length = 22;
                    }
                    else
                    {
                        length = 10;
                    }
                    break;
                case #CBFT392:              //SKG#DevOps:16141
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')
                    {
                        length = 10;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')   //SKS#DevOps:16681
                    {
                        length = 34;
                    }
                    break;
                case #ACHCCP:
                case #ACHPPP:
                case #CCDP14:
                case #CTX17:
                case #CHK19:
                case #CHK585:
                case #CTX942:
                case #CHK20:
                case #CPS706:
                    length = 17;
                    break;
                case #CHK396:
                case #ACH410:               //SKG#VSTS:10575
                case #WIRE391:              //SKG#VSTS:10575
                case #WIRE392:              //SKG#VSTS:10575
                case #INSTPAY:              //DevOps20744 (Port 20684)
                    length = 35;
                    break;
                case #DFT391:               //SKG#VSTS:11471
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')         //SKS#DevOps:16681
                    {
                        length = 34;
                    }
                    break;
                case #CBFT442:              //SKS_VSTS_11880
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY' ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY')         //SKS_VSTS_12158
                    {
                        length = 10;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CR')         //SKS#DevOps:14956
                    {
                        length = 22;
                    }
                    else
                    {
                        length = 34;
                    }
                    break;
                case #DFT441:            //SKS_VSTS_12158
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY' ||
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY')
                    {
                        length = 10;
                    }
                    else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CR')            //SKS#DevOps:14956
                    {
                        length = 22;
                    }
                    else
                    {
                        length = 34;
                    }
                    break;
                default:
                    length = 0;
                    break;

            }
            //              Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.BankBankAcct, length);
        }
        else
        {
            //              Othr
            this.node_PmtInf_DbtrAcct_Id_Othr(nodeDbtrAcctId);
        }
    
        if((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WLW571 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603 ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE) ||
            (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391     &&
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-SG'))
        {
            //          Ccy
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtrAcct, 'Ccy', mSKS_EFT_FileDetail.CurrencyCode);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrAcct_Id_Othr</Name>
				<Source><![CDATA[
    protected void node_PmtInf_DbtrAcct_Id_Othr(XmlElement _nodeAcctId)
    {
        //------------------------------------------------------------------------------------------------------
        //              Othr
        //                  Id
        //                  SchmeNm
        //                      Cd
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeOthr;
        XmlElement nodeSchmeNm;

        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_BG)
        {
            //              Othr
            nodeOthr = _nodeAcctId.appendChild(xmlDoc.createElement('Othr'));

            //                  Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.BankBankAcct, 10);       //SKG#VSTS:7312

            //                  SchmeNm
            nodeSchmeNm = nodeOthr.appendChild(xmlDoc.createElement('SchmeNm'));

            //                          Prtry
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'BGNR');
        }
        else
        {
            super(_nodeAcctId);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrAgt</Name>
				<Source><![CDATA[
    protected void node_PmtInf_DbtrAgt(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.21: DbtrAgt
        //          FinInstnId
        //              BIC
        //              ClrSysMmbId
        //                  MmbId
        //              PstlAdr
        //                  Ctry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeDbtrAgt;
        XmlElement nodeFinInstnId;
        XmlElement nodeClrSysMmBId;
        XmlElement nodePstlAdr;
        XmlElement nodeBrnchId;
        str country;
        str value;
        str branchId, registryNo;
    
        select firstonly RegCustomerID from lSKS_PP_Setup;

        branchId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('DbtrAgtBranchId', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));
        registryNo = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RegistryNo', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

        select msks_EFT_FileDetail_BankAddress where
                msks_EFT_FileDetail_BankAddress.RefRecId == mSKS_EFT_FileDetail.RecID
                && msks_EFT_FileDetail_BankAddress.AddressType == SKS_EFT_AddressType::BankAddress;

        if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == #TRADE && msks_EFT_FileDetail_BankAddress.Name)
        {
            //      2.21: DbtrAgt
            nodeDbtrAgt = nodePmtInf.appendChild(xmlDoc.createElement('DbtrAgt'));
    
            //          FinInstnId
            nodeFinInstnId = nodeDbtrAgt.appendChild(xmlDoc.createElement('FinInstnId'));

            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', msks_EFT_FileDetail_BankAddress.Name, 0, false);
        }
        else
        {
            //      2.21: DbtrAgt
            nodeDbtrAgt = nodePmtInf.appendChild(xmlDoc.createElement('DbtrAgt'));
    
            //          FinInstnId
            nodeFinInstnId = nodeDbtrAgt.appendChild(xmlDoc.createElement('FinInstnId'));

            switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
            {
                case #ACHCCD:
                case #ACHPPD:
                case #CACH460:
                case #ACHCCP:
                case #ACHPPP:
                case #CCDP14:
                case #CTX17:
                case #CHK585:
                case #CTX942:
                case #CHK20:
                case #ACH780:
                case #FT499:
                case #CHK19:
                case 'CAMAL':
                case 'CHK19USFED':
                case 'CHK19CAFED':
                case 'CHKUSFED02':
                case 'CHKUSFED03':
                case 'CHKCAFED02':
                case 'CHKCAFED03':
                case #CTX950:        //SKG#VSTS:13477
                case #CDM950:        //SKG#VSTS:13477
                case #CHK950:        //SKG#VSTS:13477
                    value = mSKS_EFT_FileDetail.BankBankTransit;
                    break;
                case #ACHCTX:
                    if((mSKS_EFT_FileDetail.BankBankSwiftNo != '' || mSKS_EFT_FileDetail.BankBankTransit)&&
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACHCTX &&
                        mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
                        lSKS_PP_Setup.RegCustomerID == 'fc3ce6')            //SKS#DevOps:19784
                    {
                        //                  BIC
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.BankBankSwiftNo, 0, false);

                        if(mSKS_EFT_FileDetail.BankBankTransit)
                        {
                            //              ClrSysMmbId
                            nodeClrSysMmBId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));
    
                            //                  MmbId
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmBId, 'MmbId', mSKS_EFT_FileDetail.BankBankTransit, 0, false);
                        }
                    }
                    else
                    {
                        value = mSKS_EFT_FileDetail.BankBankTransit;
                    }
                    break;
                case #TRADE:
                    value ='';
                    break;
                default:
                    //              BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.BankBankSwiftNo, 0, false);
                    break;
            }
    
            switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
            {
                case #ACH502:
                case #ACH503:
                case #WLW571:
                case #FT499:
                case #BKT500:
                case #FT607:
                case #CPS29:            
                    value = mSKS_EFT_FileDetail.BankBankTransit;
                    break;
                case #CPS706:
                case #DOM555:
                    value = (mSKS_EFT_FileDetail.BankBankSwiftNo == '' ? mSKS_EFT_FileDetail.BankBankTransit : '');
                    break;
            }
    
            if(value != '')
            {
                //              ClrSysMmbId
                nodeClrSysMmBId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));
    
                //                  MmbId
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmBId, 'MmbId', value, 0, false);
            }
    
            if(mSKS_EFT_FileFormatPaymSpec.PaymSpec == #FT607     ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CHK487   ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #DFT391   ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CBFT392  ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CB_WIRE  ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CHECK815 ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CBFT574  ||          //SKG#VSTS:7453
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CHK804   ||          //SKG#VSTS:7453
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #INSTPAY  ||          //DevOps20744 (Port 20684)
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #DFT574   ||          //SKG#VSTS:7453
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #DOM317   ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #ACH208   ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #DOM903   ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #ATPAY403 ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #CDFT392  ||
                mSKS_EFT_FileFormatPaymSpec.PaymSpec == #WIRE574  ||          //SKG#VSTS:10574
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU'||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'||                 //SKG#VSTS:7453)
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP'||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK402)         //SKS_VSTS_12162
            {            
    
                switch(mSKS_EFT_FileDetail.FormatId)
                {
                    case 'US-CITICONNECT-XML-PR':
                        country = 'PR';
                        break;
                    case 'US-CITICONNECT-XML-CN':
                        country = 'CN';
                        break;
                    case 'US-CITICONNECT-XML-DK':
                        country = 'DK';
                        break;
                    case 'US-CITICONNECT-XML-GB':
                        country = 'GB';
                        break;
                    case 'US-CITICONNECT-XML-JO':
                        country = 'JO';
                        break;
                    case 'US-CITICONNECT-XML-AE':               //SKG#VSTS:7453
                        country = 'AE';
                        break;
                    case 'US-CITICONNECT-XML-CZ':
                        country = 'CZ';
                        break;
                    case 'US-CITICONNECT-XML-HU':
                        country = 'HU';
                        break;
                    case 'US-CITICONNECT-XML-MY':
                        country = 'MY';
                        break;
                    case 'US-CITICONNECT-XML-HK':
                        country = 'HK';
                        break;
                    case 'US-CITICONNECT-XML-AU':
                        country = 'AU';
                        break;
                    case 'US-CITICONNECT-XML-ZA':               //SKG#VSTS:10574
                        country = 'ZA';
                        break;
                    case 'US-CITICONNECT-XML-JP':               //SKG#VSTS:10575
                        country = 'JP';
                        break;
                    case 'US-CITICONNECT-XML-TR':               //SKG#VSTS:11518
                        country = 'TR';
                        break;
                    case 'US-CITICONNECT-XML-VN':               //SKG#DevOps:16681
                        country = 'VN';
                        break;
                    case 'US-CITICONNECT-XML-PY':               //DevOps20744 (Port 20684)
                        country = 'PY';
                        break;
                    default:
                        country = '';
                        break;
                }
    
                if(country != '')
                {
                    //              PstlAdr
                    nodePstlAdr = nodeFinInstnId.appendChild(xmlDoc.createElement('PstlAdr'));
    
                    //                  Ctry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', country, 0, false);
                }
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-MY'  ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY403         ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHECK405         ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK402           ||          //SKS_VSTS_12162
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DE397            ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK396           ||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853          &&          //SKG#VSTS:10575
                    registryNo)                                              ||          //SKG#VSTS:11518
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-AU' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #BKT393))
                {
                    //                  BrnchId
                    nodeBrnchId = nodeDbtrAgt.appendChild(xmlDoc.createElement('BrnchId'));
    
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SSK853)
                    {
                        //                         Id
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Nm', registryNo);
                    }
                    else                
                    {
                        //                         Id
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', branchId, 3, false);
                    }
                }
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_PmtTpInf</Name>
				<Source><![CDATA[
    protected void node_PmtInf_PmtTpInf(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.6: PmtTpInf
        //          2.8: SvcLvl
        //              2.9: Cd
        //          2.11: LclInstrm
        //              2.13: Prtry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodePmftTpInf;
        XmlElement nodeLclInstrm;
        XmlElement nodeCtgyPurp;
        str value;
        str ctgyPurpValue;      //SKS_VSTS_13807
        
    
        //      2.6: PmtTpInf
        nodePmftTpInf = _nodePmtInf.appendChild(xmlDoc.createElement('PmtTpInf'));
    
        //          2.7: InstrPrty
        this.node_PmtInf_PmtTpInf_InstrPrty(nodePmftTpInf);

        if(mSKS_EFT_FileDetail.PaymSpec != #WLW571      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHECK427    &&
           mSKS_EFT_FileDetail.PaymSpec != #CPS28       &&
           mSKS_EFT_FileDetail.PaymSpec != #CPS29       &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK585      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK436      &&
           mSKS_EFT_FileDetail.PaymSpec != #DFT914      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK418      &&
           mSKS_EFT_FileDetail.PaymSpec != #CBFT827     &&
           mSKS_EFT_FileDetail.PaymSpec != #DIT828      &&
           mSKS_EFT_FileDetail.PaymSpec != #DPRL831     &&
           mSKS_EFT_FileDetail.PaymSpec != #DPENS832    &&
           mSKS_EFT_FileDetail.PaymSpec != #BKT833      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK834      &&
           mSKS_EFT_FileDetail.PaymSpec != #BWPMT835    &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK_WL      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK_WL_RC   &&
           mSKS_EFT_FileDetail.PaymSpec != #TRADE       &&
           mSKS_EFT_FileDetail.PaymSpec != #BFT551      &&
           mSKS_EFT_FileDetail.PaymSpec != #CHK950      &&             //SKG#VSTS:13477
           mSKS_EFT_FileDetail.PaymSpec != #CDM950)                    //SKG#VSTS:13477
        {
            //          2.8: SvcLvl
            this.node_PmtInf_PmtTpInf_SvcLvl(nodePmftTpInf);
        }
    
        switch(mSKS_EFT_FileDetail.PaymSpec)
        {
            case #DFT391:
            case #DOM391:
            case #DOM391RT:         //SKG#VSTS:7509
                value = 'CITI391';
                break;
            case #TRADE:
                value= 'TRAD';
                break;
            case #CB_WIRE:
            case #CBFT392:
            case #CB392:
            case #CDFT392:
                value = 'CITI392';
                break;
            case #CACH460:
                value = 'CITI783';
                break;
            case #FT499:
                value = 'CITI499';
                break;
            case #BKT500:
                value = 'CITI500';
                break;
            case #OTC894:
                value = 'CITI894';
                break;
            case #CBFT896:
                value = 'CITI896';
                break;
            case #ACHCCD:
            case #ACHPPD:
            case #ACHCTX:
            case #ACHCCP:
            case #ACHPPP:           
                value = subStr(mSKS_EFT_FileFormatPaymSpec.TransactionCode, strLen(mSKS_EFT_FileFormatPaymSpec.TransactionCode), -3);
                break;
            case #ACH502:
                value = 'CITI502';
                break;
            case #ACH503:
                value = 'CITI503';
                break;
            case #WLW571:
                value = 'CITI571';
                break;
            case #ACH_KID:
                value = '0412';
                break;
            case #ACH_PG:
                value = '0500';
                break;
            case #ACH_BG:
                value = '0014';
                break;
            case #DC417:
                value = 'CITI417';
                break;
            case #CHECK416:
                value = 'CITI416';
                break;
            case #BKT393:
                value = 'CITI393';
                break;
            case #CHK402:
                value = 'CITI402';
                break;
            case #IBRS429:
                value = 'CITI429';
                break;
            case #IBRS430:
                value = 'CITI430';
                break;
            case #CHECK427:
                value = 'CITI427';
                break;
            case #ACH964:
                value = 'CITI964';
                break;
            case #CHK804:
                value = 'CITI804';
                break;
            case #BKT602:
            case #DFT603:
            case #CBFT604:
            case #USFCP821:
            case #CHK585:
            case #CTX942:
            case #CPS706:
            case #ACH780:
            case #BKT440:            
            case #RT453:
            case #DL454:
            case #CBFT442:
            case #CHK478:
            case #DE397:
            case #PLG400:
            case #ATPAY403:
            case #CHK405:
            case #LLG408:
            case #CHK436:
            case #TLPAY451:
            case #PRL398:
            case #PRL401:
            case #DOM540:
            case #DFT914:
            case #BKT410:
            case #PRL414:
            case #PLG527:
            case #CHK418:
            case #GIRO421:
            case #ATPAY424:
            case #CHK425:
            case #PRL426:
            case #CHK496:
            case #CHK834:
            case #BWPMT835:
            case #DFT441:
            case #CBFT827:
            case #DIT828:
            case #DPRL831:
            case #DPENS832:
            case #BKT833:
            case #CHECK405:
            case #BPAY889:
            case #BKT547:                   //SKG#VSTS:10808
            case #ACH809:                   //SKG#VSTS:10574
            case #ACH410:                   //SKG#VSTS:10575
            case #WIRE391:                  //SKG#VSTS:10575
            case #WIRE392:                  //SKG#VSTS:10575
            case #SIP962:
            case #PRL422:                   //SKG#VSTS:11471
            case #CHK420:                   //SKG#VSTS:11471
            case #CHK423:                   //SKG#VSTS:11471
            case #SSK853:                   //SKG#VSTS:11518
            case #BFT551:
            case #CTX950:                   // SKG#VSTS:13477
            case #CHK950:                   // SKG#VSTS:13477
            case #RTGS605:                  //SKG#VSTS:14212
            case #DFT541:                   //SKS#DevOps:15853
            case #RTGS539:                  //SKS#DevOps:15853
            case #TAX908:                   //SKS#DevOps:15853
            case #TAX927:                   //SKS#DevOps:15853
            case #TAX947:                   //SKS#DevOps:15853
            case #IFT_CB392:                //SKS#DevOps:15853
            case #CDT862:                   //SKS#DevOps:15853
            case #DOM789:                   //SKS#DevOps:17266
            case #DOM903:                   //SKS#DevOps:17266
            case #DFT555:                   //SKS#DevOps:21738
                value = 'CITI' + subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -3);
                break;
            case #DOM441:
                value = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UY' ? '' : 'CITI441');
                break;
            case #DFT574:                   //SKG#VSTS:7453
            case #CBFT574:                  //SKG#VSTS:7453,14212
                value = 'CITI574';
                break;
            case #CPS28:
            case #CPS29:
            case #CTX17:
                value = 'CITI' + subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2);
                break;
            case #CCDP14:
                value = 'CITI14';
                break;
            case #SEPA939:
            case #SEPA938:
                value = 'SDCL';
                break;
            case #GIRO527:
                value = 'CITI527';
                break;
            case #DOM555:                         //SKG#VSTS:10808
            case #VAT984:                   //SKG#VSTS:12473
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TN'  ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL'  ||          //SKS#DevOps:21738
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')             //SKG#VSTS:14212
                {
                    value = 'CITI' + subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -3);
                }
                break;
            case #ACH_WL:                    //SKG#VSTS:11537
            case #WIRE_WL:
            case #CHK_WL:
            case #SEPA_WL:
            case #ACH_WL_RC:
            case #WIRE_WL_RC:
            case #CHK_WL_RC:
            case #SEPA_WL_RC:
            case #WIRE_WL_O:
            case #WIRE_WLORC:
            case #WIRE_WL_I:
            case #WIRE_WLIRC:
            case #WIRE_WL_IC:      //SKG#DevOps:17359
            case #WIREWLICRC:      //SKG#DevOps:17359
            case #WIRE_WL_IS:       //SKG#DevOps:17359
            case #WIREWLISRC:      //SKG#DevOps:17359
            case #WIRE_WL_IP:      //SKG#DevOps:17359
            case #WIREWLIPRC:      //SKG#DevOps:17359
                value = 'CITI949';
                break;
            //SKS_VSTS_12350--->
            case 'CHK19CAMAL':
            case 'CHK19USFED':
            case 'CHK19CAFED':
                value = 'CITI19';
                break;
            //SKS_VSTS_12350<---
            //SKS_VSTS_13844--->
            case 'CHKUSFED02':
            case 'CHKUSFED03':
            case #CHK19:
                value = 'CITI19';
                break;
            //SKS_VSTS_13844<---
            //SKS_VSTS_13397--->
            case 'CHKCAFED02':
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)
                {
                    value = 'CITI19';
                }
                else
                {
                    value = 'CITI20';
                }
                break;
            case 'CHKCAFED03':
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK19)
                {
                    value = 'CITI19';
                }
                else
                {
                    value = 'CITI20';
                }
                break;
            case 'CHK20CAMAL':
            case 'CHK20CAFED':
                value = 'CITI20';
                break;
            //SKS_VSTS_13397<---
            case #ACH_SEPA:
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ' ||
                   mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')
                {
                    value = 'CITI795';
                }
                break;
            case #CDM950:           //SKG#VSTS:13477
                value = 'CDM';
                break;
            case #PPW_WL:               //SKS#VSTS:14271
            case #PPW_PH_WL:               //SKS#DevOps:14542
                value = 'WLTT';
                break;
            case #INSTPAY:              //DevOps20744 (Port 20684)
                value = 'CITI993';
                break;
            default:
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('LclInstrm', mSKS_EFT_FileDetail.RecId));   //SKS_FDD_10590
                break;
        }
    
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX592)      //SKS#DevOps:21738
        {
            //              2.15: CtgyPurp
            nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
            //                  2.16: Cd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', 'TAXS');
        }
        else if(value)
        {
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CB_WIRE  && 
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #TRADE)
            {
                //          2.11: LclInstrm
                nodeLclInstrm = nodePmftTpInf.appendChild(xmlDoc.createElement('LclInstrm'));
    
                switch(mSKS_EFT_FileDetail.PaymSpec)
                {
                    case #ACHCCD:
                    case #ACHPPD:
                    case #ACHCTX:
                    case #ACH_KID:
                    case #ACH_PG:
                    case #ACHCCP:                        
                    case #ACHPPP:
                    case #SEPA938:
                    case #SEPA939:
                    case #ACH_BG:
                    case #CDM950:       //SKS_VSTS_13477
                        //              2.12: Cd
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeLclInstrm, 'Cd', value);
                        break;
                    default:
                        //              2.13: Prtry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeLclInstrm, 'Prtry', value);
                        break;
                }
            }
            switch(value)
            {
                case 'TRAD':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
        
                    //                  2.16: Cd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', value);
                    break;
                case 'CITI894':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'ROTC');
                    break;
                case 'CACH460':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', '460');
                    break;
                case 'CITI392':
                case 'CITI827':
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-SG' && 
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-GB' &&
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN' &&
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-IL' &&       //SKS#DevOps:16141
                       mSKS_EFT_FileFormatPaymSpec.TransactionCode != #WIRE392)
                    {
                        //              2.15: CtgyPurp
                        nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                        //                  2.16: Prtry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'INTC');
                    }
                    break;
                case 'CITI984':
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL')     //SKS#DevOps:21738
                    {
                        //              2.15: CtgyPurp
                        nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                        //                  2.16: Prtry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', 'VATX');
                    }
                    break;
                case 'CITI391':
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-SG' &&
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-GB' &&
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-CN' &&
                       mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-XML-VN')
                    {
                        //              2.15: CtgyPurp
                        nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                        //                  2.16: Prtry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'INTC');
                    }
                    break;
                case 'CITI429':
                case 'CITI430':
                case 'CITI804':
                case 'CITI19':
                case 'CITI317':
                case 'CITI425':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));

                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'CASH');
                    break;
                case 'CITI547':                           //SKG#VSTS:10808
                case 'CITI574':
                    if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TN')
                    {
                        //              2.15: CtgyPurp
                        nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));

                        //                  2.16: Cd
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', 'CASH');                        
                    }
                    break;
                case 'CITI332':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));

                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'TAXS');
                    break;
                case 'CITI398':
                case 'CITI426':
                case 'CITI831':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));

                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'SALA');
                    break;
                case 'CITI832':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'PENS');
                    break;
                case 'CITI889':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'BPAY');
                    break;
                case 'CITI949':
                    if(mSKS_EFT_FileDetail.TransactionCode == #WIRE_WL &&  mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-AE')               //SKS#DevOps:14963
                    {
                        ctgyPurpValue = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CtgyPurpPrtry', mSKS_EFT_FileDetail.RecId));

                        if(ctgyPurpValue)
                        {

                            //              2.15: CtgyPurp
                            nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                            //                  2.16: Prtry
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', '/REF/' + ctgyPurpValue);
                        }
                    }
                    break;
                case 'CITI499':
                    if(mSKS_EFT_FileDetail.TransactionCode == #FT499 &&(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId != 'ARE' ))                 //SKS#DevOps:17857//DevOPs 18306
                    {
                        ctgyPurpValue = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CtgyPurpPrtry', mSKS_EFT_FileDetail.RecId));

                        if(ctgyPurpValue)
                        {

                            //              2.15: CtgyPurp
                            nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));        //SKS#DevOps:17968
    
                            //                  2.16: Prtry
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', '/REF/' + ctgyPurpValue);
                        }
                    }
                    break;
                case 'CITI809':                  //SKG#VSTS:10574
                    value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('CtgyPurp', mSKS_EFT_FileDetail.RecId)); //SKS_FDD_10590
                    if(value)
                    {
                        //              2.15: CtgyPurp
                        nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                        //                  2.16: Prtry
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', value, 2);
                    }
                    break;
                case 'CITI962':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'SIP');
                    break;
                case 'CITI422':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'SALA');
                    break;
                case 'CITI853':
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    
                    //                  2.16: Cd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', 'SSBE');
                    break;
                case 'CITI927':         //SKS#DevOps:15853
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'INCD');
                    break;
                case 'CITI947':         //SKS#DevOps:15853
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    
                    //                  2.16: Prtry
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Prtry', 'INPT');
                    break;
                case 'CITI862':         //SKS#DevOps:15853
                    //              2.15: CtgyPurp
                    nodeCtgyPurp = nodePmftTpInf.appendChild(xmlDoc.createElement('CtgyPurp'));
                    
                    //                  2.15: Cd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCtgyPurp, 'Cd', 'TRAD');
                    break;
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_GrpHdr_FwdgAgt</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_GrpHdr_FwdgAgt
    /// </summary>
    /// <param name = "_nodeFwdgAgt"></param>
    protected void node_GrpHdr_FwdgAgt(XmlElement _nodeFwdgAgt)
    {
        XmlElement nodeFwdgAgt;
        XmlElement nodeFinInstnId;
        XmlElement nodeOther;
        XmlElement nodeSchemeNm;
        str w02;

        this.getSKS_EFT_FileFormatPaymSpec();
        this.getSKS_EFT_Bank();

        w02 = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('FwdgAgtScheme', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank));

        if(w02 !='' &&
           mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-US' &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TRADE)
        {
            //          FwdgAgt
            nodeFwdgAgt = _nodeFwdgAgt.appendChild(xmlDoc.createElement('FwdgAgt'));

            //              FinInstnId
            nodeFinInstnId = nodeFwdgAgt.appendChild(xmlDoc.createElement('FinInstnId'));

            //                  9.1.15: Other
            nodeOther = nodeFinInstnId.appendChild(xmlDoc.createElement('Othr'));

            //                      9.1.1.16: Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOther, 'Id','CITISUPLFIN');

            nodeSchemeNm = nodeOther.appendChild(xmlDoc.createElement('SchemeNm'));

            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchemeNm, 'Prtry', w02, 35);

        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_PmtTpInf_SvcLvl_Cd</Name>
				<Source><![CDATA[
    protected void node_PmtInf_PmtTpInf_SvcLvl_Cd(XmlElement _nodeSvcLvl)
    {
        //------------------------------------------------------------------------------------------------------
        //              2.9: Cd
        //------------------------------------------------------------------------------------------------------
        str value;
    
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #OTC894:
            case #CBFT896:
            case #WIRE574:              //SKG#VSTS:10574
                value = 'WIRE';
                break;
            case #DFT391:
            case #CBFT392:
            case #FT499:
            case #CB_WIRE:
            case #CB392:
            case #CBFT574:              //SKG#VSTS:7453
            case #DFT603:
            case #CBFT604:
            case #USFCP821:
            case #RT453:
            case #CBFT442:
            case #DFT441:
            case #WIRE_WL:
            case #WIRE392:              //SKG#VSTS:10575
            case #XPRS888:              //SKG#VSTS:12473
            case #RTGS605:              //SKG#VSTS:14212
            case #PPW_WL:               //SKS#VSTS:14271
            case #PPW_PH_WL:            //SKS#DevOps:14542
            case #RTGS539:              //SKS#DevOps:15853
            case #TAX927:               //SKS#DevOps:15853
            case #TAX947:               //SKS#DevOps:15853
            case #IFT_CB392:            //SKS#DevOps:15853
            case #CDT862:               //SKS#DevOps:15853
                value = 'URGP';
                break;
            case #CACH460:
            case #ACHCCD:
            case #ACHPPD:
            case #ACHCTX:
            case #ACH502:
            case #ACH503:
            case #ACH_KID:
            case #ACH_PG:
            case #ACH_BG:
            case #DC417:
            case #CHECK416:
            case #IBRS430:
            case #ACH964:
            case #CHECK815:
            case #DFT574:               //SKG#VSTS:7453
            case #ACHCCP:
            case #ACHPPP:
            case #CCDP14:
            case #CTX17:
            case #CHK19:
            case #CTX942:
            case #CPS706:
            case #ACH780:
            case #DOM317:
            case #DOM555:
            case #ACH208:
            case #DOM303:
            case #DOM903:
            case #DOM325:
            case #DOM332:
            case #DOM789:
            case #DOM548:
            case #ACH150:
            case #DOM441:
            case #DE397:
            case #PLG400:
            case #ATPAY403:
            case #CHK405:
            case #LLG408:
            case #TLPAY451:
            case #PRL398:
            case #PRL401:
            case #BKT410:
            case #PRL414:
            case #PLG527:
            case #GIRO421:
            case #ATPAY424: 
            case #CHK425:
            case #PRL426:
            case #CHK496:
            case #CHK834:
            case #BWPMT835:
            case #GIRO527:
            case #CHECK405:
            case #BPAY889:
            case #ACH_WL:
            case #ACH410:               //SKG#VSTS:10575
            case #WIRE391:              //SKG#VSTS:10575
            case #PRL422:               //SKG#VSTS:11471
            case #SSK853:               //SKG#VSTS:11518
            case #TAX592:               //SKG#VSTS:12473
            case #VAT984:               //SKG#VSTS:12473
            case #CTX950:               //SKG#VSTS:13477
            case #TAX908:               //SKG#VSTS:15853
                value = 'NURG';
                break;
            case #BKT500:
            case #BKT393:
            case #BKT602:
            case #BKT440:
            case #BKT547:                             //SKG#VSTS:10808
                value = 'BKTR';
                break;
            case #ACH_DC:
                value = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IT' ? 'SEPA' : 'NURG');
                break;
            case #ACH_SEPA:
            case #SEPA848:
            case #SEPA939:
            case #SEPA938:
            case #SEPA_WL:
            case #SEPA:
                value = 'SEPA';
                break;
            case #ACH809:
            case #DL454:
                value = 'SDVA';
                break;
            case #IBRS429:
            case #DOM540:
            case #SIP962:
            case #DFT541:           //SKS#DevOps:15853
            case #INSTPAY:          //DevOps20744 (Port 20684)
                value = 'URNS';
                break;
            case #DOM391:
                value = (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-JP' ? 'NURG' : 'URGP');
                break;
            case #DFT555:
                value = ((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-CZ' ||
                          mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PL') ? 'NURG' : 'URGP');
                break;
            case #CDFT392:      //SKS#DevOps:17871
                if(this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'GB')
                {
                    value = 'BKTR';
                }
                else
                {
                    value = 'URGP';
                }
                break;
            default:
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('SvcLvlCd', mSKS_EFT_FileDetail.RecId));    //SKS_FDD_10590
                break;
        }
    
        //              2.9: Cd
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeSvcLvl, 'Cd', value);
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_RmtInf_Amt</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_RmtInf_Amt
    /// </summary>
    /// <param name = "_nodeRfrdDocAmt">_nodeRfrdDocAmt</param>
    /// <param name = "_invSKS_EFT_FileDetail">_invSKS_EFT_FileDetail</param>
    protected void node_RmtInf_Amt(XmlElement _nodeRfrdDocAmt, SKS_EFT_FileDetail _invSKS_EFT_FileDetail)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.42: Amt
        //              2.43: InstdAmt
        //------------------------------------------------------------------------------------------------------
        XmlElement  currentElement;
        AmountMST   gross = _invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + _invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;
        AmountMST   Remitted;
        AmountMST   CreditNote;

        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CTX950)      //SKS#DevOps:21971
        {
            //      2.110
            currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DuePyblAmt', '0.00');
            SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);

            //      2.111
            currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DscntApldAmt', num2str(this.getPositiveAmount(_invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur) * 1,0,2,1,0));
            SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);

            //      RmtdAmt
            currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'RmtdAmt', num2str(this.getPositiveAmount(_invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur),0,2,1,0));
            SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);
        }
        else
        {
            if(_invSKS_EFT_FileDetail.InvoiceSettleAmountCur > 0)
            {
                Remitted = 0;
                CreditNote = _invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;
                //      2.110
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DuePyblAmt', num2str(gross * 1,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);

                //      2.111
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DscntApldAmt', num2str(_invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * 1,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);
            }
            else
            {
                Remitted = _invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1;
                CreditNote = 0;
                //      2.110
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DuePyblAmt', num2str(gross * -1,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);

                //      2.111
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'DscntApldAmt', num2str(_invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);
            }

            if(Remitted != 0)
            {
                //      RmtdAmt
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'RmtdAmt', num2str(Remitted,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);
            }
            else
            {
                //      CdtNoteAmt
                currentElement = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeRfrdDocAmt, 'CdtNoteAmt', num2str(CreditNote,0,2,1,0));
                SKS_EFT_Format::xmlsetAttributeText(currentElement, 'Ccy', _invSKS_EFT_FileDetail.PaymentCurrencyCode);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_InstrForDbtrAgt</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_InstrForDbtrAgt
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_InstrForDbtrAgt(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.82: InstrForDbtrAgt
        //------------------------------------------------------------------------------------------------------
        EventHandlerResult result = new EventHandlerResult();

        
        this.node_CdtTrfTxInf_InstrForDbtrAgt_delegate(_nodeCdtTrfTxInf,mSKS_EFT_FileDetail, mSKS_EFT_FileFormatPaymSpec, xmldoc, result);

        if(!result.result())
        {
            this.getBankPurposeCode();

            if(bankCodeText &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PLG400   ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TLPAY451 ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PRL401  )
            {
                //          2.85: InstrForDbtrAgt
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeCdtTrfTxInf, 'InstrForDbtrAgt', this.CharacterReplacement(bankCodeText));
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Tax</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_Tax
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_Tax(XmlElement _nodeCdtTrfTxInf)    
    {
        XmlElement  nodeTax;
        XmlElement  nodeRcrd;
        XmlElement  nodeTaxAmt;
        XmlElement  nodeTtlAmt;
        XmlElement  nodeTtlTaxAmt;
        XmlElement  nodeTaxblBaseAmt;
        XmlElement  nodeDbtr;
        XmlElement  nodeCdtr;
        str         value, certificateNumber;
        str regnId, type, FrmsCd, beneTaxId, admstnZn, refNb;
        AmountMST   taxAmt;
        XmlElement  nodeFrToDt;
        XmlElement  nodePrd;
        SKS_EFT_TH_WithHoldingTaxFields     mSKS_EFT_TH_WithHoldingTaxFields;        
        SKS_EFT_FileDetail_TaxWHTrans       sks_EFT_FD_TaxWHTrans; // SKS_FDD_10590
        PeriodStart start;       //SKS#DevOps:15853
        PeriodEnd End;

        start = FiscalCalendarYear::findYearByCalendarDate(Ledger::fiscalCalendar(CompanyInfo::find().RecId), DateTimeUtil::getSystemDate(DateTimeUtil::getUserPreferredTimeZone())).StartDate;
        End = FiscalCalendarYear::findYearByCalendarDate(Ledger::fiscalCalendar(CompanyInfo::find().RecId), DateTimeUtil::getSystemDate(DateTimeUtil::getUserPreferredTimeZone())).enddate;

        mSKS_EFT_TH_WithHoldingTaxFields = new SKS_EFT_TH_WithHoldingTaxFields();
        
        mSKS_EFT_TH_WithHoldingTaxFields.getSKS_EFT_TH_WithHoldingTaxFields(mSKS_EFT_FileDetail.PaymentLineRecId);        
        certificateNumber   = mSKS_EFT_TH_WithHoldingTaxFields.CertificateNumber();
               
        
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX908)     //SKS#DevOps:15853
        {
            //          Tax
            nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

            //              TtlTaxAmt
            nodeTtlTaxAmt = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'TtlTaxAmt', num2str(this.getTotalTaxAmount(),0,2,0,0), 12, false);
            SKS_EFT_Format::xmlsetAttributeText(nodeTtlTaxAmt, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);

            //              Rcrd
            nodeRcrd = nodeTax.appendChild(xmlDoc.createElement('Rcrd'));

            //                  CertId
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'CertId', SKS_EFT_Format::getCodelookupvalue('CertId', mSKS_EFT_FileDetail.RecId), 0, false);

            //              Prd
            nodePrd = nodeRcrd.appendChild(xmlDoc.createElement('Prd'));

            //                  FrToDt
            nodeFrToDt = nodePrd.appendChild(xmlDoc.createElement('FrToDt'));

            //                  FrDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFrToDt, 'FrDt', int2str(year(start)) + '-' + subStr(int2str(year(End)),3,4), 0, false);

            //                  ToDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFrToDt, 'ToDt', int2str(year(start)) + '-' + subStr(int2str(year(End)),3,4), 0, false);


            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'AddtlInf',
                '/INTA/'
                + this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TaxHeadCode', mSKS_EFT_FileDetail.RecId)) + '/'
                + this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('TaxMinorHeadCode', mSKS_EFT_FileDetail.RecId))+ '/'
                , 0, false);
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'AddtlInf','/INTV///////', 0, false);
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX927)     //SKS#DevOps:15853
        {
            //          Tax
            nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

            //          Dbtr
            nodeDbtr = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Dbtr'));

            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtr, 'TaxId', SKS_EFT_Format::getCodelookupvalue('IECode', mSKS_EFT_FileDetail.RecId), 0, false);

            //              Rcrd
            nodeRcrd = nodeTax.appendChild(xmlDoc.createElement('Rcrd'));

            //                  Ctgy
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'Ctgy', SKS_EFT_Format::getCodelookupvalue('PortCode', mSKS_EFT_FileDetail.RecId), 35, false);

            //                  CertId
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'CertId', SKS_EFT_Format::getCodelookupvalue('ChallanNumber', mSKS_EFT_FileDetail.RecId), 35, false);

            //                  FrmsCd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'FrmsCd', SKS_EFT_Format::getCodelookupvalue('BOENumber', mSKS_EFT_FileDetail.RecId), 35, false);
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX947)     //SKS#DevOps:15853
        {
            //          Tax
            nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

            //          Dbtr
            nodeDbtr = nodeTax.appendChild(xmlDoc.createElement('Dbtr'));

            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtr, 'TaxId', SKS_EFT_Format::getCodelookupvalue('SRINOrTINNumber', mSKS_EFT_FileDetail.RecId), 0, false);

            //              Rcrd
            nodeRcrd = nodeTax.appendChild(xmlDoc.createElement('Rcrd'));

            //                  Tp
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'Tp', SKS_EFT_Format::getCodelookupvalue('TaxState', mSKS_EFT_FileDetail.RecId), 35, false);

            //                  CertId
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'CertId', SKS_EFT_Format::getCodelookupvalue('VRNOrTRNNumber', mSKS_EFT_FileDetail.RecId), 20, false);

            //                  FrmsCd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'FrmsCd', SKS_EFT_Format::getCodelookupvalue('TextLabelValue', mSKS_EFT_FileDetail.RecId), 35, false);

            //              Prd
            nodePrd = nodeRcrd.appendChild(xmlDoc.createElement('Prd'));

            //                  FrToDt
            nodeFrToDt = nodePrd.appendChild(xmlDoc.createElement('FrToDt'));

            //                  FrDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFrToDt, 'FrDt', SKS_PP_StringFormats::strDateYYYYMMDD(start, DateSeparator::Hyphen), 0, false);

            //                  ToDt
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFrToDt, 'ToDt', SKS_PP_StringFormats::strDateYYYYMMDD(End, DateSeparator::Hyphen), 0, false);
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548   ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424 ||
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425   ||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555   &&
               (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR'||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UA')))
        {
            //          Tax
            nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424 ||
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425)
            {
                //              Mtd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'Mtd', SKS_EFT_Format::getCodelookupvalue('Mtd', mSKS_EFT_FileDetail.RecId), 0, false);  //SKS_FDD_10590

                //              SeqNb
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'SeqNb', certificateNumber, 0, false);
            }
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548)
            {
                //              TtlTaxAmt
                nodeTtlTaxAmt = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'TtlTaxAmt', num2str(this.getTotalWithholdTaxAmount(mSKS_EFT_FileDetail.RecId), 0, 2, 1, 0), 0, false);
                SKS_EFT_Format::xmlsetAttributeText(nodeTtlTaxAmt, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);
            }                                      
            while select sks_EFT_FD_TaxWHTrans where sks_EFT_FD_TaxWHTrans.RefRecId == mSKS_EFT_FileDetail.RecId // SKS_FDD_10590
            {
                //              Rcrd
                nodeRcrd = nodeTax.appendChild(xmlDoc.createElement('Rcrd'));
                

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424 ||
                   mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425 )
                {
                    //              Tp
                    if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424 &&
                       sks_EFT_FD_TaxWHTrans.TaxWithholdAmount < 0)// SKS_FDD_10590
                    {
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'Tp', 'CREN');
                    }
                    
                    //                    Ctgy
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'Ctgy', sks_EFT_FD_TaxWHTrans.TaxWithholdRevenueCode, 0, false);// SKS_FDD_10590
                    
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'CtgyDtls', this.CharacterReplacement(sks_EFT_FD_TaxWHTrans.TWHItemGrpHeading_TH_Name), 35, false);// SKS_FDD_10590
                    
                    //                  CertId
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'CertId', certificateNumber, 0, false);
                    
                    //                  FrmsCd
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'FrmsCd', this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('FrmsCd', mSKS_EFT_FileDetail.RecId)), 0, false);    //SKS_FDD_10590
                }                

                //                  TaxAmt
                nodeTaxAmt = nodeRcrd.appendChild(xmlDoc.createElement('TaxAmt'));
                
                taxAmt = sks_EFT_FD_TaxWHTrans.TaxWithholdAmount;

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548)
                {
                    value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Rate', mSKS_EFT_FileDetail.RecId));   //SKS_FDD_10590
                    if(value == '04')
                    {
                        taxAmt = 0;
                    }
                    //                      Rate
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTaxAmt, 'Rate', value, 0, false);
                }
                
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424    ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425)
                {
                    //                      Rate
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTaxAmt, 'Rate', num2str(sks_EFT_FD_TaxWHTrans.TaxWithholdValue, 0, 0, 0, 0), 0, false);
                    
                    //                      TaxblBaseAmt                                        
                    nodeTaxblBaseAmt = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTaxAmt, 'TaxblBaseAmt', num2str(sks_EFT_FD_TaxWHTrans.InvoiceCurUpdatedWithholdBaseAmount, 0, 2, 1, 0), 0, false);
                    
                    SKS_EFT_Format::xmlsetAttributeText(nodeTaxblBaseAmt, 'Ccy', Currency::currencyCodeISO(sks_EFT_FD_TaxWHTrans.InvoiceCurrency));
                }

                //                      TtlAmt
                nodeTtlAmt = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTaxAmt, 'TtlAmt', num2str(this.getPositiveAmount(taxAmt), 0, 2, 1, 0), 0, false);
                
                SKS_EFT_Format::xmlsetAttributeText(nodeTtlAmt, 'Ccy', Currency::currencyCodeISO(sks_EFT_FD_TaxWHTrans.InvoiceCurrency));

                //                   AddtlInf
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM548   ||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DOM555 &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-UA'||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-TR')))
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'AddtlInf', this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('AddtlInf', mSKS_EFT_FileDetail.RecId)), 0, false);    //SKS_FDD_10590
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ATPAY424    ||
                        mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK425)
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'AddtlInf', this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('WHTFormDetails', mSKS_EFT_FileDetail.RecId)), 0, false);  //SKS_FDD_10590
                }
            }           
        }
        else
        {
            regnId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('RegnId', mSKS_EFT_FileDetail.RecId));
            type = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('Type', mSKS_EFT_FileDetail.RecId));
            FrmsCd = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('FrmsCd', mSKS_EFT_FileDetail.RecId));
            beneTaxId = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BeneTaxId', mSKS_EFT_FileDetail.RecId));
            admstnZn = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('AdmstnZn', mSKS_EFT_FileDetail.RecId));

            if(( regnId|| type || FrmsCd)  &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #TAX592)                  //SKG#VSTS:12473
            {
                //          Tax
                nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

                //                  Dbtr
                nodeDbtr = nodeTax.appendChild(xmlDoc.createElement('Dbtr'));

                //                              RegnId
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtr, 'RegnId', regnId, 34);

                //                  Rcrd
                nodeRcrd = nodeTax.appendChild(xmlDoc.createElement('Rcrd'));

                //                      Tp
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'Tp', type, 35);

                //                      FrmsCd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeRcrd, 'FrmsCd', FrmsCd, 7);
            }

            else if((beneTaxId || admstnZn || refNb) &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #VAT984)                  //SKG#VSTS:12473
            {
                //          Tax
                nodeTax = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('Tax'));

                if(beneTaxId)
                {
                    //                  Cdtr
                    nodeCdtr = nodeTax.appendChild(xmlDoc.createElement('Cdtr'));

                    //                              TaxId
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtr, 'TaxId', beneTaxId, 14);
                }

                //                              AdmstnZn
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'AdmstnZn', admstnZn, 1, false);

                //                              RefNb
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'RefNb', this.getInvoiceNbrs(), 35, false);

                //                              TotalTaxAmount
                nodeTtlTaxAmt = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeTax, 'TtlTaxAmt', num2str(this.getTotalTaxAmount(),0,2,0,0), 12, false);
                SKS_EFT_Format::xmlsetAttributeText(nodeTtlTaxAmt, 'Ccy', mSKS_EFT_FileDetail.PaymentCurrencyCode);
            }
        }


    }

]]></Source>
			</Method>
			<Method>
				<Name>getTotalWithholdTaxAmount</Name>
				<Source><![CDATA[
    private AmountMST getTotalWithholdTaxAmount(RefRecId _fileDetailRecId)
    {
        SKS_EFT_FileDetail_TaxWHTrans   sks_EFT_FD_TaxWHTrans;
       
        select sum(TaxWithholdAmount) from sks_EFT_FD_TaxWHTrans
            where sks_EFT_FD_TaxWHTrans.RefRecId == _fileDetailRecId;

        return sks_EFT_FD_TaxWHTrans.TaxWithholdAmount;

    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrNodes</Name>
				<Source><![CDATA[
    protected void node_PmtInf_DbtrNodes(XmlElement _nodePmtInf)
    {
        //      2.19: Dbtr
        this.node_PmtInf_Dbtr(_nodePmtInf);
    
        if((subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'WL') ||
            (subStr(mSKS_EFT_FileDetail.PaymSpec, strLen(mSKS_EFT_FileDetail.PaymSpec), -2) == 'RC') ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-O' ||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-I' ||            //SKS_VSTS_13659
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-IC'||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-IS'||
            mSKS_EFT_FileFormatPaymSpec.PaymSpec == 'WIRE-WL-IP')        //SKS#DevOps:21462
        {
            //      2.20: DbtrAcct
            this.node_PmtInf_DbtrAcctWL(_nodePmtInf);
    
            //      2.21: DbtrAgt
            this.node_PmtInf_DbtrAgtWL(_nodePmtInf);
        }
        else
        {
            //      2.20: DbtrAcct
            this.node_PmtInf_DbtrAcct(_nodePmtInf);
    
            //      2.21: DbtrAgt
            this.node_PmtInf_DbtrAgt(_nodePmtInf);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrAcctWL</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_PmtInf_DbtrAcctWL
    /// </summary>
    /// <param name = "_nodePmtInf">_nodePmtInf</param>
    protected void node_PmtInf_DbtrAcctWL(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.20: DbtrAcct
        //          Id
        //              IBAN
        //              Othr
    
        //------------------------------------------------------------------------------------------------------
        XmlElement nodeDbtrAcct;
        XmlElement nodeDbtrAcctId;
        XmlElement nodeOthr;
        int length;
    
        if(mSKS_EFT_FileDetail.BankBankAcct || mSKS_EFT_FileDetail.BankBankIBAN)
        {
            //      2.20: DbtrAcct
            nodeDbtrAcct = nodePmtInf.appendChild(xmlDoc.createElement('DbtrAcct'));
    
            //          Id
            nodeDbtrAcctId = nodeDbtrAcct.appendChild(xmlDoc.createElement('Id'));
        
            if(mSKS_EFT_FileDetail.BankBankAcct != '')
            {
                //          Othr
                nodeOthr = nodeDbtrAcctId.appendChild(xmlDoc.createElement('Othr'));
    
                switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
                {
                    case #ACH_WL:
                    case #WIRE_WL:
                    case #CHK_WL:
                    case #SEPA_WL:
                    case #PPW_WL:      //SKS#VSTS:14271
                    case #PPW_PH_WL:   //SKS#DevOps:14542
                        length = 16;
                        break;
                    default:
                        length = 34;
                        break;
                }
                //              Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', mSKS_EFT_FileDetail.BankBankAcct, length);
            }

            else if(mSKS_EFT_FileDetail.BankBankIBAN != '')
            {
                //              IBAN
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtrAcctId, 'IBAN', mSKS_EFT_FileDetail.BankBankIBAN);
            }
        
            //          Ccy
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeDbtrAcct, 'Ccy', mSKS_EFT_FileDetail.CurrencyCode);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_DbtrAgtWL</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_PmtInf_DbtrAgtWL
    /// </summary>
    /// <param name = "_nodePmtInf">_nodePmtInf</param>
    protected void node_PmtInf_DbtrAgtWL(XmlElement _nodePmtInf)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.21: DbtrAgt
        //          FinInstnId
        //              BIC
        //              ClrSysMmbId
        //                  MmbId
        //              PstlAdr
        //                  Ctry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeDbtrAgt;
        XmlElement nodeFinInstnId;
        XmlElement nodeOthr;
        str value;
    
        value = SKS_EFT_Format::getCodelookupvalue('InitgPtyId', mSKS_EFT_FileDetail.RecId, SKS_EFT_CodeLookupType::CodeLookupBank);
        //      2.21: DbtrAgt
        nodeDbtrAgt = nodePmtInf.appendChild(xmlDoc.createElement('DbtrAgt'));
    
        //          FinInstnId
        nodeFinInstnId = nodeDbtrAgt.appendChild(xmlDoc.createElement('FinInstnId'));

        if(mSKS_EFT_FileDetail.BankBankSwiftNo)
        {
            //              BIC
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.BankBankSwiftNo, 11, false);
        }
        if(value)
        {
            //          Othr
            nodeOthr = nodeFinInstnId.appendChild(xmlDoc.createElement('Othr'));

            //              Id
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeOthr, 'Id', this.CharacterReplacement(value), 9);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAgtWL</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_CdtrAgtWL
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_CdtrAgtWL(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.77: CdtrAgt
        //              FinInstnId
        //                  BIC
        //                  ClrSysMmbId
        //                  Nm
        //                  PstlAdr
        //              BrnchId
        //                  Id
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeCdtrAgt;
        XmlElement nodeFinInstnId;
        XmlElement nodeClrSysMmbId;
        XmlElement nodeBrnchId;
        int len;
        
        if((mSKS_EFT_FileDetail.DepSwiftNo != '' || mSKS_EFT_FileDetail.DepBankTransit != '') &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_WL &&
           mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_PH_WL)           //SKS#DevOps:14542
        {
            //          2.77: CdtrAgt
            nodeCdtrAgt = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('CdtrAgt'));

            //              FinInstnId
            nodeFinInstnId = nodeCdtrAgt.appendChild(xmlDoc.createElement('FinInstnId'));

            if(mSKS_EFT_FileDetail.DepSwiftNo       &&
                mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BY' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||              //SKG#VSTS:13094
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AG' ||              //SKS_VSTS_13672
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO' ||              //SKS_VSTS_13720
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HT' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FJ' ||              //SKS_VSTS_13821
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BO' ||              //SKS_VSTS_13867
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG' ||
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IS' ||              //SKS_VSTS_14051
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||              //SKS_VSTS_14743
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK' ||              //SKS#DevOps:16428
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BB' ||              //SKS#DevOps:16237
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG' ||              //SKS#DevOps:16946
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||              //SKS#DevOps:16946
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM' ||              //SKS#DevOps:16946
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NI' ||              //SKS#DevOps:19613
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GM' ||              //SKS#DevOps:17970
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JM' ||              //SKS#DevOps:19378
                (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                  (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GGY' ||
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'JEY' ||
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'IMN' ||
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GIB'))))
            {
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                  (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GGY' ||
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'JEY' ||
                   mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'IMN'))
                {
                    nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepSwiftNo);
                }
                else
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 11, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD' &&
                     mSKS_EFT_FileDetail.DepBankTransit)                  //SKS_VSTS_14743
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, 9);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                    mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GBR'        &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
            {
                if(mSKS_EFT_FileDetail.DepBankTransit && mSKS_EFT_FileDetail.DepBankAcct)
                {
                    nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//SC' + mSKS_EFT_FileDetail.DepBankTransit);
                }
                else if(mSKS_EFT_FileDetail.DepSwiftNo && mSKS_EFT_FileDetail.DepBankIBAN)
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 11, false);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MV'||         //SKS#DevOps:20079
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GN'))         //SKS#DevOps:21269
            {
                if(mSKS_EFT_FileDetail.DepSwiftNo)
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 11, false);
                }
                else if(mSKS_EFT_FileDetail.DepBankTransit)
                {
                    //          ClrSysMmbId
                    nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                    //                  MmbId
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, 35);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM')         //SKS#VSTS:14580
            {
                if(mSKS_EFT_FileDetail.DepBankTransit)
                {
                    //          ClrSysMmbId
                    nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                    //                  MmbId
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//ZM' + subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 6));
                }
                else if(mSKS_EFT_FileDetail.DepSwiftNo)
                {
                    //                  BIC
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 11, false);
                }
            }
            else if(mSKS_EFT_FileDetail.DepBankTransit  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN' ||
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' &&
                      mSKS_EFT_FileDetail.PaymentCurrencyCode == 'RUB')                 ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FJ' ||      //SKS_VSTS_13821
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AG' ||      //SKS_VSTS_13672
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BB' ||      //SKS#DevOps:16237
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NI' ||      //SKS#DevOps:19613
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO'))       //SKS_VSTS_13720
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-ID':
                        len = 7;
                        break;
                    case 'US-CITICONNECT-WL-XML-IN':
                        len = 11;
                        break;
                    case 'US-CITICONNECT-WL-XML-IL':
                        len = 5;
                        break;                    
                    case 'US-CITICONNECT-WL-XML-AU':
                        len = 6;
                        break;
                    case 'US-CITICONNECT-WL-XML-CA':
                    case 'US-CITICONNECT-WL-XML-US':
                        len = 9;
                        break;
                    case 'US-CITICONNECT-WL-XML-BB':    //SKS#DevOps:16237
                    case 'US-CITICONNECT-WL-XML-NI':        //SKS#DevOps:19613
                        len = 35;
                        break;
                }

                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-AU':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//AU' + subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 6));
                        break;
                    case 'US-CITICONNECT-WL-XML-CA':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//CC' + subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, len));
                        break;
                    case 'US-CITICONNECT-WL-XML-RU':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', 'RU' + subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 9) + '.' + subStr(mSKS_EFT_FileDetail_Intermediary.IntBankAcct, 1, 20));
                        break;
                    case 'US-CITICONNECT-WL-XML-US':
                        if(this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'PS')
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, 5);
                        }
                        else
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//FW' + subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 9));
                        }
                        break;
                    case 'US-CITICONNECT-WL-XML-GH':
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//GH' + mSKS_EFT_FileDetail.DepBankTransit);
                        break;
                    case 'US-CITICONNECT-WL-XML-GB':
                        if(this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId) == 'GB' &&
                           this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCountryRegionId) == 'GB')
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//GB' + mSKS_EFT_FileDetail.DepBankTransit);
                        }
                        else
                        {
                            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', '//SC' + mSKS_EFT_FileDetail.DepBankTransit);
                        }
                        break;
                    default:
                        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, len);
                        break;
                }
            }
            else if(mSKS_EFT_FileDetail.DepBankTransit  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA'))
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-SE':
                        len = 14;
                        break;
                    case 'US-CITICONNECT-WL-XML-TH':
                    case 'US-CITICONNECT-WL-XML-CR':
                    case 'US-CITICONNECT-WL-XML-GT':
                    case 'US-CITICONNECT-WL-XML-ID':
                    case 'US-CITICONNECT-WL-XML-IL':
                    case 'US-CITICONNECT-WL-XML-SG':
                        len = 7;
                        break;
                    case 'US-CITICONNECT-WL-XML-US':
                    case 'US-CITICONNECT-WL-XML-CA':
                        len = 9;
                        break;
                    case 'US-CITICONNECT-WL-XML-DO':
                    case 'US-CITICONNECT-WL-XML-PE':
                        len = 3;
                        break;
                    case 'US-CITICONNECT-WL-XML-IN':
                        len = 11;
                        break;
                    case 'US-CITICONNECT-WL-XML-ZA':
                    case 'US-CITICONNECT-WL-XML-GB':
                        len = 6;
                        break;
                }
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA')
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, len));
                }
                else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU')  //SKG#VSTS:13168
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 3) + '-' +  subStr(mSKS_EFT_FileDetail.DepBankTransit, 4, 3));
                }
                else
                {
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, len));
                }
            }
            else if(mSKS_EFT_FileDetail_BenBank.BenBankBranch  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL')
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch), 5);
            }
            else if(mSKS_EFT_FileDetail.DepSwiftNo       &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IS'))
            {
                //                  BIC
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 11, false);
            }

            else if(mSKS_EFT_FileDetail.DepBankTransit != ''                 &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL   &&
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL   ||
                   (mSKS_EFT_FileDetail.DepSwiftNo == '' && mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID')))
            {
                nodeClrSysMmbId = nodeFinInstnId.appendChild(xmlDoc.createElement('ClrSysMmbId'));

                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL)
                {
                    switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                    {
                        case 'US-CITICONNECT-WL-XML-SG':
                            len = 7;
                            break;
                        case 'US-CITICONNECT-WL-XML-CA':
                        case 'US-CITICONNECT-WL-XML-US':
                            len = 9;
                            break;
                        case 'US-CITICONNECT-WL-XML-GB':
                            len = 6;
                            break;
                    }
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
                {
                    switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                    {
                        case 'US-CITICONNECT-WL-XML-IN':
                            len = 11;
                            break;
                        case 'US-CITICONNECT-WL-XML-ID':
                            len = 7;
                            break;
                        default:
                            len = 35;
                            break;
                    }
                }
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeClrSysMmbId, 'MmbId', mSKS_EFT_FileDetail.DepBankTransit, len, false);
            }

            else if(mSKS_EFT_FileDetail.DepSwiftNo != ''        &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL   &&
                   ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-ZM') ||
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL))
            {
                //                  BIC
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'BIC', mSKS_EFT_FileDetail.DepSwiftNo, 0, false);
            }
            
            if((mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL   &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL   &&
               mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-ZM')||
              (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM'&&                //SKS#VSTS:14580
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL           &&
               mSKS_EFT_FileDetail.DepSwiftNo                                    &&
               mSKS_EFT_FileDetail.DepBankTransit == ''))
            {
                //                  Nm
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeFinInstnId, 'Nm', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankName), 35, false);
            }
            
            if(mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-ZM')
            {
                //                  PstlAdr
                this.node_CdtTrfTxInf_CdtrAgt_PstlAdr(nodeFinInstnId);
            }

            if(mSKS_EFT_FileDetail_BenBank.BenBankBranch != ''                     &&
               ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL     &&
                 mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU')||
                (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL    &&
                 (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD'||
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY'||
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LV'||
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW'||
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK'||        //SKS#DevOps:16428
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM'||         //SKS#DevOps:16940
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG'||
                  mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML'))))
            {
                //              BrnchId
                nodeBrnchId = nodeCdtrAgt.appendChild(xmlDoc.createElement('BrnchId'));

                //              Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeBrnchId, 'Id', this.CharacterReplacement(mSKS_EFT_FileDetail_BenBank.BenBankBranch));
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAgt_PstlAdr</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_CdtrAgt_PstlAdr(XmlElement _nodeCdtrAgt)
    {
        //------------------------------------------------------------------------------------------------------
        //      2.77: CdtrAgent
        //          PstlAdr
        //------------------------------------------------------------------------------------------------------
        SKS_EB_Address          addressBldgNb, addressStrtNm, addressPstCd, addressCtrySubDvsn;
        container               address;

        if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CA'  ||            
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MR'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SC'  ||
            mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG') &&
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
        {
            if(strScan(mSKS_EFT_FileDetail_BenBank.BenBankAddr, ';', 1, strLen(mSKS_EFT_FileDetail_BenBank.BenBankAddr)))     //SKS_FDD_10590
            {
                address = this.addressSplit(mSKS_EFT_FileDetail_BenBank.BenBankAddr);      //SKS_FDD_10590
                addressStrtNm = conpeek(address,1);
                addressBldgNb = conpeek(address,2);
                addressPstCd  = conpeek(address,3);
                addressCtrySubDvsn  = conpeek(address,4);
            }
            else
            {
                addressStrtNm = mSKS_EFT_FileDetail_BenBank.BenBankAddr;       //SKS_FDD_10590
            }
            if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL'   ||
               mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE')
            {
                this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, addressStrtNm, addressPstCd, mSKS_EFT_FileDetail_BenBank.BenBankCity, 0, addressBldgNb, addressCtrySubDvsn, true);        //SKS_FDD_10590
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LA'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MN'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MR'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW'  ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SC')
            {
                this.node_PstlAdr_StrdUstrd(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, addressStrtNm, addressPstCd, mSKS_EFT_FileDetail_BenBank.BenBankCity, 0, addressBldgNb, addressCtrySubDvsn);        //SKS_FDD_10590
            }
            else
            {
                this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, addressStrtNm, addressPstCd, mSKS_EFT_FileDetail_BenBank.BenBankCity, 0, addressBldgNb, '', true);        //SKS_FDD_10590
            }
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL      ||
               (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL     &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-CD'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-CN'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-ET'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-GE'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-KR'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-LK'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MY'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MX'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MD'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MZ'  &&
                mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-NA'))
        {
            this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, mSKS_EFT_FileDetail_BenBank.BenBankAddr, '', mSKS_EFT_FileDetail_BenBank.BenBankCity, 0, '', '', true);      //SKS_FDD_10590
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CHK_WL)
        {
            this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, '', '', '');       //SKS_FDD_10590
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH410)
        {
            this.node_PstlAdr(_nodeCdtrAgt, strUpr(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId), strUpr(mSKS_EFT_FileDetail_BenBank.BenBankAddr), '', ''); // Zip and City not used at this time       //VSTS#12838
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT391 &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN' &&
                (strLen(mSKS_EFT_FileDetail_BenBank.BenBankName + mSKS_EFT_FileDetail_BenBank.BenBankBranch) > 35))       // SKS#DevOps:16681
        {
            this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, substr(mSKS_EFT_FileDetail_BenBank.BenBankName + mSKS_EFT_FileDetail_BenBank.BenBankBranch, 36, 35), '', '', 35, mSKS_EFT_FileDetail_BenBank.BenBankAddr, '');      //SKS#DevOps:16681
        }
        else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #CBFT392 &&
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-VN')       // SKS#DevOps:16681
        {
            if(mSKS_EFT_FileDetail.DepSwiftNo == '')
            {
                this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, mSKS_EFT_FileDetail_BenBank.BenBankAddr, '', mSKS_EFT_FileDetail_BenBank.BenBankCity, 0, '', '', true);
            }
        }
        else
        {
            this.node_PstlAdr(_nodeCdtrAgt, mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId, mSKS_EFT_FileDetail_BenBank.BenBankAddr, '', ''); // Zip and City not used at this time       //SKS_FDD_10590
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_CdtrAcctWL</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_CdtrAcctWL
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    protected void node_CdtTrfTxInf_CdtrAcctWL(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.80: CdtrAcct
        //              Id
        //                  Othr
        //                  Id
        //              Tp/Ptry
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodeCdtrAcct;
        XmlElement nodeCdtrAcctId;
        XmlElement nodeCdtrAcctIdOthr;
        XmlElement nodeCdtrAcctTp;
        XmlElement nodeSchmeNm;
        str value;
        int length, leadZero;
    
        if((mSKS_EFT_FileDetail.DepBankIBAN ||
            mSKS_EFT_FileDetail.DepBankAcct ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL ||
            mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL) &&   //SKS#DevOps:14972
            mSKS_EFT_FileFormatPaymSpec.TransactionCode != #CHK_WL)
        {
            //          2.80: CdtrAcct
            nodeCdtrAcct = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('CdtrAcct'));
    
            //              Id
            nodeCdtrAcctId = nodeCdtrAcct.appendChild(xmlDoc.createElement('Id'));

            if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN' &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL            &&
               mSKS_EFT_FileDetail.DepBankIBAN)                                              //SKS#DevOps:15473
            {
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN, 24);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
               mSKS_EFT_FileDetail.DepBankAcct &&
               (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AU' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CL' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CN' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CO' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KR' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MY' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PE' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TW' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-VN' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZM' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DZ' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CD' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TH' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TN' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TG' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UG' ||
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-FJ' ||         //SKS_VSTS_13821
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AG' ||        //SKS_VSTS_13672
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BO' ||        //SKS_VSTS_13867
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BB' ||        //SKS#DevOps:16237
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ML' ||        //SKS#DevOps:16946
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KM' ||        //SKS#DevOps:16946
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GM' ||         //SKS#DevOps:17970
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NI' ||        //SKS#DevOps:16946
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MO' ||         //SKS_VSTS_13720
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JM' ||        //SKS#DevOps:19378
                mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-HT'))
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-PE':
                    case 'US-CITICONNECT-WL-XML-RU':
                    case 'US-CITICONNECT-WL-XML-DZ':
                    case 'US-CITICONNECT-WL-XML-TN':
                        length = 20;
                        break;
                    case 'US-CITICONNECT-WL-XML-LK':
                        length = 12;
                        break;
                    case 'US-CITICONNECT-WL-XML-ZM':
                        length = 13;
                        break;
                    case 'US-CITICONNECT-WL-XML-CD':
                        length = 23;
                        break;
                    case 'US-CITICONNECT-WL-XML-GM':        //SKS#DevOps:17970
                        length = 18;
                        break;
                    case 'US-CITICONNECT-WL-XML-SN':
                    case 'US-CITICONNECT-WL-XML-TG':
                        length = 24;
                        break;
                    case 'US-CITICONNECT-WL-XML-BB':        //SKS#DevOps:16237
                    case 'US-CITICONNECT-WL-XML-ML':        //SKS#DevOps:16946
                    case 'US-CITICONNECT-WL-XML-KM':        //SKS#DevOps:16946
                        length = 35;
                        break;
                }

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, length);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GN' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL && mSKS_EFT_FileDetail.DepBankAcct)                    //SKS#DevOps:21269
            {
                str bankCodeGN  = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('BankCodeGN', mSKS_EFT_FileDetail.RecId));
                str agencyCode  = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('AgencyCode', mSKS_EFT_FileDetail.RecId));
                str keyGN       = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('KeyGN', mSKS_EFT_FileDetail.RecId));

                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', bankCodeGN + agencyCode + subStr(mSKS_EFT_FileDetail.DepBankAcct, 1, 10) + keyGN, 18);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL)
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', 'EMAIL');

                nodeSchmeNm = nodeCdtrAcctIdOthr.appendChild(xmlDoc.createElement('SchmeNm'));
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'EMAIL');

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Issr', 'PAYPAL');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL)          //SKS#DevOps:14542
            {
                value = this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('PayPalPhone', mSKS_EFT_FileDetail.RecId));

                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', '+' + value);

                nodeSchmeNm = nodeCdtrAcctIdOthr.appendChild(xmlDoc.createElement('SchmeNm'));
    
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeSchmeNm, 'Prtry', 'PHON');

                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Issr', 'PAYPAL');
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GBR')
            {
                if(mSKS_EFT_FileDetail.DepBankTransit && mSKS_EFT_FileDetail.DepBankAcct)
                {
                    //                  Othr
                    nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, 8);
                }
                else if(mSKS_EFT_FileDetail.DepSwiftNo && mSKS_EFT_FileDetail.DepBankIBAN)
                {
                    //                  IBAN
                    nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN, 22);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL            &&
                    mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'UKR')                        //SKS#VSTS:14702
            {
                if(mSKS_EFT_FileDetail.DepBankIBAN)     //SKS_VSTS_14743
                {
                    //                  IBAN
                    nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileDetail_Intermediary.IntBankAcct                         &&
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU')
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail_Intermediary.IntBankAcct, 20);
            }
            else if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MG' &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)                        //SKS#DevOps:16940
            {
                if(mSKS_EFT_FileDetail.DepBankIBAN)
                {
                    //                  IBAN
                    nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN, 27);
                }
                else if(mSKS_EFT_FileDetail.DepBankAcct)
                {
                    //                  Othr
                    nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, 35);
                }
            }
            else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  &&
                    mSKS_EFT_FileDetail.DepBankIBAN &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CR' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GT' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PK' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BA' ||      //SKS#DevOps:16138
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK' ||      //SKS#DevOps:16428
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                      (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GGY' ||
                       mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'JEY' ||
                       mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'IMN' ||
                       mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GIB'))   ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BY' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-JO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IS' ||       //SKS_VSTS_14051
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EG' ||       //SKS_VSTS_14743
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MV' ||       //SKS#DevOps:20079
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' &&      //SKS_VSTS_13857
                    mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'PSE')))
            {
                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-AL':
                    case 'US-CITICONNECT-WL-XML-AZ':
                    case 'US-CITICONNECT-WL-XML-GT':
                    case 'US-CITICONNECT-WL-XML-BY':
                        length = 28;
                        break;
                    case 'US-CITICONNECT-WL-XML-BR':
                        length = 29;
                        break;
                    case 'US-CITICONNECT-WL-XML-BG':
                    case 'US-CITICONNECT-WL-XML-CR':
                        length = 22;
                        break;
                    case 'US-CITICONNECT-WL-XML-GB':
                        if(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GIB')
                        {
                            length = 23;
                        }
                        else if(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GGY' ||
                                mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'JEY' ||
                                mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'IMN')
                        {
                            length = 22;
                        }
                        break;
                    case 'US-CITICONNECT-WL-XML-IL':
                    case 'US-CITICONNECT-WL-XML-AE':
                        length = 23;
                        break;
                    case 'US-CITICONNECT-WL-XML-KZ':
                    case 'US-CITICONNECT-WL-XML-BA':        //SKS#DevOps:16138
                        length = 20;
                        break;
                    case 'US-CITICONNECT-WL-XML-PK':
                    case 'US-CITICONNECT-WL-XML-SE':
                        length = 24;
                        break;
                    case 'CM':
                        length = 27;
                        break;
                    case 'US-CITICONNECT-WL-XML-JO':
                        length = 30;
                        break;
                    case 'US-CITICONNECT-WL-XML-MZ':
                        length = 25;
                        break;
                    case 'US-CITICONNECT-WL-XML-IS':
                        length = 26;
                        break;
                    case 'US-CITICONNECT-WL-XML-MK':        //SKS#DevOps:16428
                        length = 19;
                        break;
                    case 'US-CITICONNECT-WL-XML-MV':        //SKS#DevOps:20079
                        length = 35;
                        break;
                }

                if((mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB' &&
                      (mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'GGY' ||
                       mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'JEY'||
                       mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId == 'IMN'))        ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MZ'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CM'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-AO'   ||
                       mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-CI')
                {
                    //                  Othr
                    nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankIBAN, length);
                }
                else
                {
                    //                  IBAN
                    nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN, length);
                }
            }
            else if(mSKS_EFT_FileDetail.DepBankAcct  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SE' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-DO' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IN' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ID' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-IL' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RU' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ZA' ||
                     mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GB'))
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));

                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-SE':
                    case 'US-CITICONNECT-WL-XML-ID':
                        length = 16;
                        break;
                    case 'US-CITICONNECT-WL-XML-US':
                        length = 17;
                        break;
                    case 'US-CITICONNECT-WL-XML-IL':
                        length = 9;
                        break;
                    case 'US-CITICONNECT-WL-XML-RU':
                        length =20;
                        break;
                    case 'US-CITICONNECT-WL-XML-SG':
                    case 'US-CITICONNECT-WL-XML-GB':
                        length  =11;
                        break;
                    case 'US-CITICONNECT-WL-XML-ZA':
                        length  = 13;
                        break;
                }
                //                      Id
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, length);
            }
            else if(mSKS_EFT_FileDetail.DepBankIBAN  &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL)
            {
                switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                {
                    case 'US-CITICONNECT-WL-XML-SE':
                        length = 24;
                        break;
                    case 'US-CITICONNECT-WL-XML-BG':
                    case 'US-CITICONNECT-WL-XML-GB':
                        length = 22;
                        break;
                    case 'US-CITICONNECT-WL-XML-CR':
                        length = 17;
                        break;
                    case 'US-CITICONNECT-WL-XML-GT':
                        length = 28;
                        break;
                    case 'US-CITICONNECT-WL-XML-IS':
                        length = 26;
                        break;
                }

                //                  IBAN
                nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN, length);
            }

            else if(mSKS_EFT_FileDetail.DepBankAcct &&
                    mSKS_EFT_FileFormatPaymSpec.TransactionCode != #SEPA_WL   &&
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL    ||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL   &&  mSKS_EFT_FileDetail.DepBankIBAN == '')||
                   (mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL              &&
                   (mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-US'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BD'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BJ'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BW'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BN'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BF'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-EG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-ET'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GH'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GW'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-GY'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-KE'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MX'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NZ'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NE'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-NG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-OM'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-PH'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-LK'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TZ'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TG'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MW'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-RW'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-SN'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-TT'   ||
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-BA'   || //SKS#DevOps:16138
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-MK'   || //SKS#DevOps:16428
                    mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-WL-XML-UY'))))
            {
                //                  Othr
                nodeCdtrAcctIdOthr = nodeCdtrAcctId.appendChild(xmlDoc.createElement('Othr'));
                
                if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL)
                {
                    switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                    {
                        case 'US-CITICONNECT-WL-XML-AU':
                            length = 9;
                            break;
                        case 'US-CITICONNECT-WL-XML-CA':
                            length = 12;
                            break;
                        case 'US-CITICONNECT-WL-XML-SG':
                        case 'US-CITICONNECT-WL-XML-GB':
                            length = 11;
                            break;
                        case 'US-CITICONNECT-WL-XML-US':
                            length = 17;
                            break;
                        default:
                            length = 0;
                            break;
                    }
                }
                else if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL)
                {
                    switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
                    {
                        case 'US-CITICONNECT-WL-XML-BF':
                        case 'US-CITICONNECT-WL-XML-GW':
                        case 'US-CITICONNECT-WL-XML-HU':
                        case 'US-CITICONNECT-WL-XML-NE':
                        case 'US-CITICONNECT-WL-XML-TG':
                            length = 24;
                            break;
                        case 'US-CITICONNECT-WL-XML-CM':
                        case 'US-CITICONNECT-WL-XML-TD':
                        case 'US-CITICONNECT-WL-XML-GA':
                            length = 23;
                            break;
                        case 'US-CITICONNECT-WL-XML-MZ':
                            length = 21;
                            break;
                        case 'US-CITICONNECT-WL-XML-TN':
                            length = 20;
                            break;
                        case 'US-CITICONNECT-WL-XML-MX':
                            length = 18;
                            break;
                        case 'US-CITICONNECT-WL-XML-CR':
                            length = 12;
                            break;
                        case 'US-CITICONNECT-WL-XML-NG':
                            length = 10;
                            break;
                        case 'US-CITICONNECT-WL-XML-MU':
                            length = 9;
                            break;
                        case 'US-CITICONNECT-WL-XML-GT':
                            leadZero = 20;
                            break;
                        case 'US-CITICONNECT-WL-XML-MK':        //SKS#DevOps:16428
                        case 'US-CITICONNECT-WL-XML-MV':        //SKS#DevOps:20079
                            length = 34;
                            break;
                        default:
                            length = 35;
                            break;
                    }
                }
                if(length)
                {
                    //                      Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', mSKS_EFT_FileDetail.DepBankAcct, length);
                }
                else
                {
                    //                         Id
                    SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctIdOthr, 'Id', SKS_PP_StringFormats::strFill(leadZero, mSKS_EFT_FileDetail.DepBankAcct, SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
                }
            }
    
            else if(mSKS_EFT_FileDetail.DepBankIBAN != ''   &&
                   ((mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL &&
                    (mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-US' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-BD' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-BJ' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-BW' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-BN' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-BF' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-EG' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-ET' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-GH' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-GW' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-GY' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-KE' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MX' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-NZ' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-NE' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-NG' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-OM' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-PG' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-PH' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-SG' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-LK' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-TZ' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-TG' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MW' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-RW' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-SN' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-TT' &&
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-TN' &&  // SKG#VSTS:13168
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-MK' &&  // SKG#VSTS:16428
                     mSKS_EFT_FileFormatPaymSpec.FormatId != 'US-CITICONNECT-WL-XML-UY'))||
                     mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL))
            {
                //                  IBAN
                nodeCdtrAcctId = SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctId, 'IBAN', mSKS_EFT_FileDetail.DepBankIBAN);
            }

            if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
            {
                value = 'SVGS';
            }
            else
            {
                value = 'CACC';
            }
            
            if((value == 'SVGS' || value == 'CACC') &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_WL &&
               mSKS_EFT_FileFormatPaymSpec.TransactionCode != #PPW_PH_WL)       //SKS#DevOps:14542
            {
                //              Tp
                nodeCdtrAcctTp = nodeCdtrAcct.appendChild(xmlDoc.createElement('Tp'));

                //                  Cd
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodeCdtrAcctTp, 'Cd', value);
            }
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_PmtId</Name>
				<Source><![CDATA[
    protected void node_CdtTrfTxInf_PmtId(XmlElement _nodeCdtTrfTxInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.28: PmtId
        //              2.29: InstrId
        //              2.30: EndToEndId
        //------------------------------------------------------------------------------------------------------
    
        XmlElement nodePmtId;
        int length;
    
        //          2.28: PmtId
        nodePmtId = _nodeCdtTrfTxInf.appendChild(xmlDoc.createElement('PmtId'));
        
        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #ACH_WL   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #WIRE_WL  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #SEPA_WL  ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #DFT603   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_WL   ||
           mSKS_EFT_FileFormatPaymSpec.TransactionCode == #PPW_PH_WL)    //SKS#DevOps:14542
        {
            //              2.29: InstrId
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtId, 'InstrId', SKS_PP_StringFormats::strRight(mSKS_EFT_FileDetail.PaymentReference, 35));
        }
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #DOM555:
            case #RTGS605:
            case #CBFT574:       //SKS#VSTS:14212
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')
                {
                    length = 16;
                }
                else
                {
                    length = 35;
                }
                break;
            case #DFT441:       //SKS_VSTS_12158
            case #CBFT442:      //SKS_VSTS_12158
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-PY')
                {
                    length= 15;
                }
                else
                {
                    length = 35;
                }
                break;
            case #CBFT392:       //SKS#DevOps:16141
                if(mSKS_EFT_FileFormatPaymSpec.FormatId == 'US-CITICONNECT-XML-IL')
                {
                    length = 16;
                }
                else
                {
                    length = 35;
                }
                break;
            default:
                length = 35;
                break;
        }
        //              2.30: EndToEndId
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePmtId, 'EndToEndId', SKS_PP_StringFormats::strRight(mSKS_EFT_FileDetail.PaymentReference, length));
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PstlAdr_StrdUstrd</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_PstlAdr_StrdUstrd
    /// </summary>
    /// <param name = "_node">_node</param>
    /// <param name = "_countryId">_countryId</param>
    /// <param name = "_address">_address</param>
    /// <param name = "_postalCode">_postalCode</param>
    /// <param name = "_city">_city</param>
    /// <param name = "_length">_length</param>
    /// <param name = "_address2">_address2</param>
    /// <param name = "_state">_state</param>
    protected void node_PstlAdr_StrdUstrd(XmlElement _node,
                                AddressCountryRegionId _countryId,
                                SKS_EB_Address _address,
                                AddressZipCodeId _postalCode,
                                AddressCity _city,
                                int _length = 35,
                                SKS_EB_Address _address2 = '',
                                AddressCountryRegionName  _state = '')
    {
        //------------------------------------------------------------------------------------------------------
        //          PstlAdr
        //              Ctry
        //              AdrLine
        //              AdrLine
        //------------------------------------------------------------------------------------------------------
        XmlElement nodePstlAdr;
        LogisticsAddressCountryRegionISOCode countryRegion;
    
        countryRegion = this.getLogisticsAddressCountryISO(_countryId);
    
        //      PstlAdr
        nodePstlAdr = _node.appendChild(xmlDoc.createElement('PstlAdr'));
    
        //          StrtNm
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'StrtNm', this.CharacterReplacement(_address), 70, false);
    
        //          BldgNb
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'BldgNb', this.CharacterReplacement(_address2), 16, false);
    
        //          PstCd
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', _postalCode, 16, false);
    
        //          TwnNm
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(_city), 35, false);
    
        //          Ctry
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', countryRegion, 2, false);

        //          AdrLine
        SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(_state), 35, false);
    }

]]></Source>
			</Method>
			<Method>
				<Name>selectPaymentRecords</Name>
				<Source><![CDATA[
    [SuppressBPWarning('BPErrorSelectUsingFirstOnly', 'The buffer is used in next statement or in a datasource query loop.')]
    protected void selectPaymentRecords()
    {
        //------------------------------------------------------------------------------------------------------
        // Standard payment selction
        // Override if different selection is need for a format
        //------------------------------------------------------------------------------------------------------
    
        //Order by clause must match the clause in the SKS_EFT_Processing.SumByPayment
        select * from mSKS_EFT_FileDetail
            join mSKS_EFT_FileDetail_VendAddress
            join mSKS_EFT_FileDetail_BenBank
            join mSKS_EFT_FileDetail_Intermediary
            join mSKS_EFT_FileDetail_CreditParty
            join msKS_EFT_FileDetail_Instructions
              order by mSKS_EFT_FileDetail.PaymentCompany, //SKS_VSTS_12798
                   mSKS_EFT_FileDetail.RecordSection,
                   mSKS_EFT_FileDetail.PaymMode,
                   mSKS_EFT_FileDetail.BankAccountId,
                   mSKS_EFT_FileDetail.PaymentCurrencyCode,
                   mSKS_EFT_FileDetail.PaymSpec,
                   mSKS_EFT_FileDetail.EffectiveDate,
                   mSKS_EFT_FileDetail.DepCountryRegionId,
                   mSKS_EFT_FileDetail.RecordType,
                   mSKS_EFT_FileDetail.AccountNum,
                   mSKS_EFT_FileDetail.PaymentReference,
                   mSKS_EFT_FileDetail.RecId
          where mSKS_EFT_FileDetail.FileRecId == mSKS_EFT_File.RecId &&
                mSKS_EFT_FileDetail.RecordSection == SKS_EFT_RecordSection::Payments &&
                mSKS_EFT_FileDetail.RecordSummary != SKS_EFT_RecordSummary::NonSummary &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_VendAddress.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_BenBank.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_Intermediary.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_CreditParty.RefRecId &&
                mSKS_EFT_FileDetail.RecId == msKS_EFT_FileDetail_Instructions.RefRecId;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getRemittanceAddress</Name>
				<Source><![CDATA[
    void getRemittanceAddress(boolean UseCheckNum)
    {
        EventHandlerResult result = new EventHandlerResult();       //SKS_VSTS_12574
        LedgerJournalTrans      lLedgerJournalTrans;
        LogisticsLocation       lLogisticsLocation;
        LogisticsPostalAddress  lRemittancePostalAddress;
        Array vendAddrArray = new Array(Types::String);
    
        if(UseCheckNum && mSKS_EFT_FileDetail.PaymentLineRecId != 0)            //SKS#DevOps:14706,15451
        {
            select firstonly crosscompany RemittanceLocation from lLedgerJournalTrans
                where lLedgerJournalTrans.Recid == mSKS_EFT_FileDetail.PaymentLineRecId
                join lRemittancePostalAddress
                where lRemittancePostalAddress.Location == lLedgerJournalTrans.RemittanceLocation;
    
            lLogisticsLocation = LogisticsLocation::find(lLedgerJournalTrans.RemittanceLocation);
    
            //Populate Remittance Information
            mRemittanceName = lLogisticsLocation.Description;
    
            vendAddrArray = SKS_PP_50000Bas::StreetToAddressLineArray(lRemittancePostalAddress.Street,2);
    
            mRemittanceAdrLine1 = '';
            mRemittanceAdrLine2 = '';
    
            if(vendAddrArray.exists(1))
            {
                mRemittanceAdrLine1 = vendAddrArray.value(1);
                if (vendAddrArray.exists(2))
                {
                    mRemittanceAdrLine2 = vendAddrArray.value(2);
                }
            }
            mRemittanceCity = this.CharacterReplacement(lRemittancePostalAddress.City);
            mRemittanceState = this.CharacterReplacement(lRemittancePostalAddress.State);
            mRemittanceZipCode = this.CharacterReplacement(lRemittancePostalAddress.ZipCode);
            mRemittanceCountryRegionId = this.getLogisticsAddressCountryISO(lRemittancePostalAddress.CountryRegionId);
            mRemittanceStreet = lRemittancePostalAddress.Street;
        }
        else
        {
            //Populate Remittance Information from Vendor eBanking details
            mRemittanceName = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneName);
            mRemittanceAdrLine1 = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr);
            mRemittanceAdrLine2 = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr2);
            mRemittanceCity = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneCity);
            mRemittanceState = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneState);
            mRemittanceZipCode = this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneZipPostal);
            mRemittanceCountryRegionId = this.getLogisticsAddressCountryISO(mSKS_EFT_FileDetail_VendAddress.BeneCountryRegionId);
        }
        //SKS_VSTS_12574--->
        this.getRemittanceAddress_delegate(mSKS_EFT_FileDetail, result);

        if(result.result())
        {
            mRemittanceName = this.CharacterReplacement(result.result());
        }
        //SKS_VSTS_12574<---
    }

]]></Source>
			</Method>
			<Method>
				<Name>formatStructure</Name>
				<Source><![CDATA[
    protected void formatStructure()
    {
        CompanyBankAccountId    prevBankAccountId;
        PaymMode                prevPaymMode;
        PaymSpec                prevPaymSpec;
        CurrencyCode            prevCurrency;
        SKS_EB_Date             prevEffectiveDate;
        DataAreaId              prevPaymCompany;//SKS_Bug_12510
    
        xmlDoc = XmlDocument::newBlank(this.getEncoding());
    
        this.node_MessageRoot();
    
        this.node_GrpHdr();
    
        while(mSKS_EFT_FileDetail)
        {
            // Get SKS_EFT_FileFormatPaymSpec
            this.getSKS_EFT_FileFormatPaymSpec();

            //Get getSKS_EFT_VendorPaym
            this.getSKS_EFT_VendorPaym();

            mSKS_EFT_FileDetail_BankAccount = SKS_EFT_FileDetail_BankAccount::find(mSKS_EFT_FileDetail.RecId);
    
            if(prevBankAccountId != mSKS_EFT_FileDetail.BankAccountId ||
               prevPaymMode != mSKS_EFT_FileDetail.PaymMode ||
               prevPaymSpec != mSKS_EFT_FileDetail.PaymSpec ||
               prevCurrency != mSKS_EFT_FileDetail.PaymentCurrencyCode ||
               prevEffectiveDate != mSKS_EFT_FileDetail.EffectiveDate  ||
               prevPaymCompany != mSKS_EFT_FileDetail.PaymentCompany//SKS_Bug_12510
               )
            {
                this.node_PmtInf();
    
                prevBankAccountId = mSKS_EFT_FileDetail.BankAccountId;
                prevPaymMode = mSKS_EFT_FileDetail.PaymMode;
                prevPaymSpec = mSKS_EFT_FileDetail.PaymSpec;
                prevCurrency = mSKS_EFT_FileDetail.PaymentCurrencyCode;
                prevEffectiveDate = mSKS_EFT_FileDetail.EffectiveDate;
                prevPaymCompany   = mSKS_EFT_FileDetail.PaymentCompany;//SKS_Bug_12510
            }
    
            // Get RemittanceAddress
            this.getRemittanceAddress((mSKS_EFT_FileFormatPaymSpec.UseCheckNumber || subStr(mSKS_EFT_FileDetail.PaymSpec, 1, 3) == 'CHK'));
    
            //Get Addenda information
            this.setAddenda();
    
            //For AP
            this.node_CdtTrfTxInf();
            
            email = '';
            telNo = '';
            bankCodeText = '';
            bankCode = '';

            next mSKS_EFT_FileDetail;
        }
        this.fileWrite(xmlDoc.toString());
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_InstrForDbtrAgt_delegate</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_InstrForDbtrAgt_delegate
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    /// <param name = "_sKS_EFT_FileDetail">_sKS_EFT_FileDetail</param>
    /// <param name = "_sKS_EFT_FileFormatPaymSpec">_sKS_EFT_FileFormatPaymSpec</param>
    /// <param name = "_xmldoc">_xmldoc</param>
    /// <param name = "_result">_result</param>
    delegate void node_CdtTrfTxInf_InstrForDbtrAgt_delegate(XmlElement _nodeCdtTrfTxInf, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_Ustrd_delegate</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_CdtTrfTxInf_RmtInf_Ustrd_delegate
    /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    /// <param name = "_sKS_EFT_FileDetail">_sKS_EFT_FileDetail</param>
    /// <param name = "_sKS_EFT_FileFormatPaymSpec">_sKS_EFT_FileFormatPaymSpec</param>
    /// <param name = "_sKS_EFT_FileDetail_VendAddress">_sKS_EFT_FileDetail_VendAddress</param>
    /// <param name = "_sKS_EFT_FileDetail_BenBank">_sKS_EFT_FileDetail_BenBank</param>
    /// <param name = "_sKS_EFT_FileDetail_Intermediary">_sKS_EFT_FileDetail_Intermediary</param>
    /// <param name = "_sKS_EFT_FileDetail_CreditParty">_sKS_EFT_FileDetail_CreditParty</param>
    /// <param name = "_vendBankAccount">_vendBankAccount</param>
    /// <param name = "_bankCode">_bankCode</param>
    /// <param name = "_bankCodeText">_bankCodeText</param>
    /// <param name = "_mRemittanceName">_mRemittanceName</param>
    /// <param name = "_mSKS_EB_CharacterReplacement">_mSKS_EB_CharacterReplacement</param>
    /// <param name = "_mSKS_EFT_VendorPaym">_mSKS_EFT_VendorPaym</param>
    /// <param name = "_xmldoc">_xmldoc</param>
    /// <param name = "_result">_result</param>
    delegate void node_CdtTrfTxInf_RmtInf_Ustrd_delegate(XmlElement _nodeCdtTrfTxInf, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec, SKS_EFT_FileDetail_VendAddress _sKS_EFT_FileDetail_VendAddress, SKS_EFT_FileDetail_BenBank _sKS_EFT_FileDetail_BenBank, SKS_EFT_FileDetail_Intermediary _sKS_EFT_FileDetail_Intermediary, SKS_EFT_FileDetail_CreditParty _sKS_EFT_FileDetail_CreditParty, VendBankAccount _vendBankAccount, str _bankCode,  str _bankCodeText, str _mRemittanceName, SKS_EB_CharacterReplacement _mSKS_EB_CharacterReplacement, SKS_EFT_VendorPaym _mSKS_EFT_VendorPaym, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_InstrForCdtrAgt_delegate</Name>
				<Source><![CDATA[
   /// <summary>
    /// node_CdtTrfTxInf_InstrForCdtrAgt_delegate
   /// </summary>
    /// <param name = "_nodeCdtTrfTxInf">_nodeCdtTrfTxInf</param>
    /// <param name = "_sKS_EFT_FileDetail">_sKS_EFT_FileDetail</param>
    /// <param name = "_sKS_EFT_FileFormatPaymSpec">_sKS_EFT_FileFormatPaymSpec</param>
    /// <param name = "_sKS_EFT_FileDetail_BenBank">_sKS_EFT_FileFormatPaymSpec</param>
    /// <param name = "_sKS_EFT_FileDetail_CreditParty">_sKS_EFT_FileDetail_CreditParty</param>
    /// <param name = "_vendBankAccount">_vendBankAccount</param>
    /// <param name = "_xmldoc">_xmldoc</param>
    /// <param name = "_result">_result</param>
    delegate void node_CdtTrfTxInf_InstrForCdtrAgt_delegate(XmlElement _nodeCdtTrfTxInf, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec, SKS_EFT_FileDetail_BenBank _sKS_EFT_FileDetail_BenBank, SKS_EFT_FileDetail_CreditParty _sKS_EFT_FileDetail_CreditParty, VendBankAccount _vendBankAccount, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_Cdtr_PstlAdr_delegate</Name>
				<Source><![CDATA[
    /// <summary>
    /// node_PmtInf_Cdtr_PstlAdr_delegate
    /// </summary>
    /// <param name = "_nodeCdtr">_nodeCdtr</param>
    /// <param name = "_sKS_EFT_FileDetail">_sKS_EFT_FileDetail</param>
    /// <param name = "_sKS_EFT_FileFormatPaymSpec">_sKS_EFT_FileFormatPaymSpec</param>
    /// <param name = "_vendBankAccount">_vendBankAccount</param>
    /// <param name = "_xmldoc">_xmldoc</param>
    /// <param name = "_result">_result</param>
    delegate void node_PmtInf_Cdtr_PstlAdr_delegate(XmlElement _nodeCdtr, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec,  VendBankAccount _vendBankAccount, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>getTotalTaxAmount</Name>
				<Source><![CDATA[
    private Amount getTotalTaxAmount()
    {
        SKS_EFT_FileDetail invSKS_EFT_FileDetail;
        VendInvoiceJour  vendinvoicejour;
        Amount taxamount;
        
        select InvoiceNumber from invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId;
        
        while(invSKS_EFT_FileDetail)
        {
            if(invSKS_EFT_FileDetail.InvoiceNumber == '')
            {
                // If no invoice number, go to next record
                next invSKS_EFT_FileDetail;
                continue;
            }
            select SumTax from vendinvoicejour where vendinvoicejour.InvoiceId == invSKS_EFT_FileDetail.InvoiceNumber;
            taxamount += vendinvoicejour.SumTax;
            
            next invSKS_EFT_FileDetail;
        }
        return taxamount;
    }

]]></Source>
			</Method>
			<Method>
				<Name>getCodelookupDescription</Name>
				<Source><![CDATA[
    private str getCodelookupDescription(SKS_EB_CodeId _FormatFieldID, SKS_EFT_FileFormatPaymSpec _SKS_EFT_FileFormatPaymSpec, RefRecId _VendPaymRecId)
    {
        SKS_EFT_FileFormatPaymSpecFields lSKS_EFT_FileFormatPaymSpecFields;
        SKS_EB_CodeLookupValues lSKS_EB_CodeLookupValues;
        SKS_EFT_VendorPaymLookup lSKS_EFT_VendorPaymLookup;
        str ret = '';
    
        select FileFormatPaymSpecRecId, FormatFieldID, RecId, FieldType, FixedValue from lSKS_EFT_FileFormatPaymSpecFields
                                                                                   where lSKS_EFT_FileFormatPaymSpecFields.FileFormatPaymSpecRecId == _SKS_EFT_FileFormatPaymSpec.RecId &&
                                                                                         lSKS_EFT_FileFormatPaymSpecFields.FormatFieldID == _FormatFieldID join CodeLookupValuesRecId, FixedValue, FileFormatPaymSpecFieldsRecId
                                                                                    from lSKS_EFT_VendorPaymLookup
                                                                                   where lSKS_EFT_VendorPaymLookup.FileFormatPaymSpecFieldsRecId == lSKS_EFT_FileFormatPaymSpecFields.RecId
                                                                                      && lSKS_EFT_VendorPaymLookup.VendorPaymRecId == _VendPaymRecId;

        if(lSKS_EFT_FileFormatPaymSpecFields.FieldType == SKS_EFT_CodeFieldType::CodeLookup)
        {
            select DisplayValue, RecId from lSKS_EB_CodeLookupValues where lSKS_EB_CodeLookupValues.RecId == lSKS_EFT_VendorPaymLookup.CodeLookupValuesRecId;
            ret =  lSKS_EB_CodeLookupValues.DisplayValue;
        }
    
        return ret;
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_GrpHdr_InitgPty_Nm</Name>
				<Source><![CDATA[
    protected void node_GrpHdr_InitgPty_Nm(XmlElement _nodeInitgPty)
    {
        //------------------------------------------------------------------------------------------------------
        //      1.8: InitgPty
        //          Nm
        //------------------------------------------------------------------------------------------------------
        Name companyName;
        int length;
    
        companyName = CompanyInfo::find().Name();

        switch(mSKS_EFT_FileDetail.PaymSpec)
        {
            case 'ACH-410':
                length = 70;
                break;
            //SKS_VSTS_13477--->
            case #CTX950:
            case #CDM950:
            case #CHK950:
                length = 16;
                break;
            //SKS_VSTS_13477<---
            default:
                length = 70;
                break;
        }

        if(mSKS_EFT_FileDetail.PaymSpec == 'ACH-410')
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeInitgPty, 'Nm', this.CharacterReplacement(strUpr(companyName)), length, false);
        }
        else
        {
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodeInitgPty, 'Nm', this.CharacterReplacement(companyName), length, false);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PstlAdr</Name>
				<Source><![CDATA[
    protected void node_PstlAdr(XmlElement _node,
                                AddressCountryRegionId _countryId,
                                SKS_EB_Address _address,
                                AddressZipCodeId _postalCode,
                                AddressCity _city,
                                int _length = 35,
                                SKS_EB_Address _address2 = '',
                                AddressCountryRegionName  _state = '',
                                boolean isStructured = false)
    {
        //------------------------------------------------------------------------------------------------------
        //          PstlAdr
        //              Ctry
        //              AdrLine
        //              AdrLine
        //------------------------------------------------------------------------------------------------------
        XmlElement nodePstlAdr;
        LogisticsAddressCountryRegionISOCode countryRegion;
    
        countryRegion = this.getLogisticsAddressCountryISO(_countryId);
    
        if(!isStructured)
        {
            if(countryRegion || _address || _postalCode || _city)
            {
                //      PstlAdr
                nodePstlAdr = _node.appendChild(xmlDoc.createElement('PstlAdr'));
    
                //          Ctry
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', countryRegion, 2, false);
    
                //          AdrLine
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', this.CharacterReplacement(_address), _length, false);
    
                //          AdrLine
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'AdrLine', strLTrim(_postalCode + ' ' + this.CharacterReplacement(_city)), _length, false);
            }
        }
        else
        {
            //      PstlAdr
            nodePstlAdr = _node.appendChild(xmlDoc.createElement('PstlAdr'));
    
            //          StrtNm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'StrtNm', this.CharacterReplacement(_address), 70, false);
    
            _address2=strRem(strRem(_address2, '\r'), '\n');
            if(_address2 !='')
            {
                //          BldgNb
                SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'BldgNb', this.CharacterReplacement(_address2), 16, false);
            }

            //          PstCd
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'PstCd', _postalCode, 16, false);
    
            //          TwnNm
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'TwnNm', this.CharacterReplacement(_city), 35, false);
    
            //          CtrySubDvsn
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'CtrySubDvsn', this.CharacterReplacement(_state), 35, false);
    
            //          Ctry
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, nodePstlAdr, 'Ctry', countryRegion, 2, false);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_Cdtr_Nm_delegate</Name>
				<Source><![CDATA[
    delegate void node_CdtTrfTxInf_Cdtr_Nm_delegate(SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec,EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_Strd_delegate</Name>
				<Source><![CDATA[
    delegate void node_CdtTrfTxInf_RmtInf_Strd_delegate(XmlElement _nodeCdtTrfTxInf, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec, SKS_EB_CharacterReplacement _mSKS_EB_CharacterReplacement, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_CdtTrfTxInf_RmtInf_CdtrAgt_delegate</Name>
				<Source><![CDATA[
    delegate void node_CdtTrfTxInf_RmtInf_CdtrAgt_delegate(XmlElement _nodeCdtTrfTxInf, SKS_EFT_FileDetail _sKS_EFT_FileDetail,SKS_EFT_FileFormatPaymSpec  _sKS_EFT_FileFormatPaymSpec, SKS_EFT_FileDetail_BenBank _sKS_EFT_FileDetail_BenBank,  SKS_EB_CharacterReplacement _mSKS_EB_CharacterReplacement, XmlDocument _xmldoc, EventHandlerResult _result)
    {
    }

]]></Source>
			</Method>
			<Method>
				<Name>node_PmtInf_PmtTpInf_InstrPrty</Name>
				<Source><![CDATA[
    protected void node_PmtInf_PmtTpInf_InstrPrty(XmlElement _nodePmftTpInf)
    {
        //------------------------------------------------------------------------------------------------------
        //          2.7: InstrPrty
        //------------------------------------------------------------------------------------------------------
    
        boolean printInstrPrty;
        str value;

        switch(mSKS_EFT_FileFormatPaymSpec.FormatId)
        {
            case 'US-CITICONNECT-XML-US':
                switch(mSKS_EFT_FileFormatPaymSpec.PaymSpec)
                {
                    case #ACHCTX:
                        printInstrPrty = true;
                        value = 'NORM';
                        break;
                }
                break;
        }

        if(printInstrPrty)
        {
            //          2.7: InstrPrty
            SKS_EFT_Format::xmlAppendChildNodeText(xmlDoc, _nodePmftTpInf, 'InstrPrty', value);
        }
    }

]]></Source>
			</Method>
			<Method>
				<Name>getCustomValue_US_CITICONNECT_WL_XM_PK</Name>
				<Source><![CDATA[
    public str getCustomValue_US_CITICONNECT_WL_XM_PK()
    {
        return '';
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>