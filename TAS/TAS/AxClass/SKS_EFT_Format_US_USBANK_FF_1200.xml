<?xml version="1.0" encoding="utf-8"?>
<AxClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	<Name>SKS_EFT_Format_US_USBANK_FF_1200</Name>
	<SourceCode>
		<Declaration><![CDATA[
/// <summary>
/// SKS_EFT_Format_US_USBANK_FF_1200
/// </summary>
class SKS_EFT_Format_US_USBANK_FF_1200  extends SKS_EFT_Format
{
    #define.FormatVersion('20230329')
    #define.ACH_CCD('ACH-CCD')
    #define.ACH_CCDP('ACH-CCDP')
    #define.ACH_PPD('ACH-PPD')
    #define.ACH_CTX('ACH-CTX')
    #define.CHK('CHK')
    #define.FED_WIRE('FED-WIRE')
    #define.INTL_WIRE('INTL-WIRE')              //SKS#DevOps:20209

    int             mPaymentCount;
    AmountMST       mPaymentAmount;

}
]]></Declaration>
		<Methods>
			<Method>
				<Name>getFormatVersion</Name>
				<Source><![CDATA[
    protected str getFormatVersion()
    {
        return #FormatVersion;
    }

]]></Source>
			</Method>
			<Method>
				<Name>formatStructure</Name>
				<Source><![CDATA[
    protected void formatStructure()
    {
        SKS_EFT_FileDetail invSKS_EFT_FileDetail;

        //Header
        this.rec_Header();
    
        while(mSKS_EFT_FileDetail)
        {
            //  getSKS_EFT_FileFormatPaymSpec
            this.getSKS_EFT_FileFormatPaymSpec();

            //Detail
            switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
            {
                case #ACH_CCD:
                case #ACH_CCDP:
                case #ACH_CTX:
                case #ACH_PPD:        //SKS#DevOps:20090
                    this.rec_ACHDetail();
                    while select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId && invSKS_EFT_FileDetail.InvoiceNumber != ''
                    {
                        //Remittance Record
                        this.rec_ACHRemittance(invSKS_EFT_FileDetail);      //SKS#DevOps:20090
                    }
                    break;
                case #CHK:
                    this.rec_CHKDetail();
                    while select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId
                    {
                        //Remittance Record
                        this.rec_CHKRemittance(invSKS_EFT_FileDetail);      //SKS#DevOps:20011
                    }
                    break;
                case #FED_WIRE:
                case #INTL_WIRE:        //SKS#DevOps:20209
                    this.rec_WIREDetail();
                    while select invSKS_EFT_FileDetail where invSKS_EFT_FileDetail.RecordSummaryRecId == mSKS_EFT_FileDetail.RecId && invSKS_EFT_FileDetail.InvoiceNumber != ''
                    {
                        //Remittance Record
                        this.rec_WIRERemittance(invSKS_EFT_FileDetail);      //SKS#DevOps:20090
                    }
                    break;
            }
            
    
            next mSKS_EFT_FileDetail;
        }
        //Trailer
        this.rec_Trailer();
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_ACHDetail</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_ACHDetail
    /// </summary>
    /// <returns>true</returns>
    boolean rec_ACHDetail()
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length  Position
        //1    Record Type                          1        1
        //2    Payment Type                         3       2-4
        //3    Individual ID Number                 15      5-19
        //4    Customer Name                        30      20-49
        //5    Originating Routing & Transit        9       50-58
        //6    Originating Account Number           17      59-75
        //7    Transaction Code                     2       76-77
        //8    Effective Date                       8       78-85
        //9    Filler                               10      86-95
        //10    Payment Amount                      14      96-109
        //11    Payee Name                          50      110-159
        //12    Supplier ID                         50      160-209
        //13    Filler                              265     210-474
        //14    Receiver Routing & Transit          11      475-485
        //15    Receiver Account Number             35      486-520
        //16    Filler                              25      521-545
        //17    ACH Standard Entry Class            3       546-548
        //18    ACH Company ID                      10      549-558
        //19    Filler                              642     559-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        mPaymentCount++;
        mPaymentAmount += mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1    Record Type                          1        1
        sb.Append('P');

        //2    Payment Type                         3       2-4
        sb.Append('ACH');

        //3    Individual ID Number                 15      5-19
        sb.Append(SKS_PP_StringFormats::strFill(15, this.CharacterReplacement(mSKS_EFT_FileDetail.PaymentReference), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
        
        //4    Customer Name                        30      20-49
        sb.Append(SKS_PP_StringFormats::strFill(30, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //5    Originating Routing & Transit        9       50-58
        sb.Append(SKS_PP_StringFormats::strFill(9, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankTransit), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //6    Originating Account Number           17      59-75
        sb.Append(SKS_PP_StringFormats::strFill(17, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankAcct), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //7    Transaction Code                     2       76-77
        if(mSKS_EFT_FileDetail.DepBankAcctType == BankAccountType::SavingsAccount)
        {
            sb.Append('32');
        }
        else
        {
            sb.Append('22');
        }

        //8    Effective Date                       8       78-85        
        sb.Append(SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate));

        //9    Filler                               10      86-95
        sb.Append(SKS_PP_StringFormats::strFill(10, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //10    Payment Amount                      14      96-109
        sb.Append(SKS_PP_StringFormats::strFill(14, num2str(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //11    Payee Name                          50      110-159
        sb.Append(SKS_PP_StringFormats::strFill(50, this.CharacterReplacement(subStr(mSKS_EFT_FileDetail_VendAddress.BeneName, 1, 22)), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //12    Supplier ID                         50      160-209
        sb.Append(SKS_PP_StringFormats::strFill(50, mSKS_EFT_FileDetail.AccountNum, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //13    Filler                              265     210-474
        sb.Append(SKS_PP_StringFormats::strFill(265, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //14    Receiver Routing & Transit          11      475-485
        sb.Append(SKS_PP_StringFormats::strFill(11, this.CharacterReplacement(mSKS_EFT_FileDetail.DepBankTransit), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //15    Receiver Account Number             35      486-520
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail.DepBankAcct), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //16    Filler                              25      521-545
        sb.Append(SKS_PP_StringFormats::strFill(25, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //17    ACH Standard Entry Class            3       546-548
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #ACH_CCD:
            case #ACH_CCDP:
                sb.Append('CCD');
                break;
            case #ACH_PPD:                  //SKS#DevOps:20090
                sb.Append('PPD');
                break;
            case #ACH_CTX:
                sb.Append('CTX');
                break;
        }
        //18    ACH Company ID                      10      549-558
        sb.Append(SKS_PP_StringFormats::strFill(10, mSKS_EFT_FileDetail.FileACHCompanyId, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //19    Filler                              642     559-1200
        sb.Append(SKS_PP_StringFormats::strFill(642, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_CHKDetail</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_CHKDetail
    /// </summary>
    /// <returns>true</returns>
    boolean rec_CHKDetail()
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length  Position
        //1     Record Type                         1       1
        //2     Payment Type                        3       2-4
        //3     Filler                              15      5-19
        //4     Customer Name                       30      20-49
        //5     Originating Routing & Transit       9       50-58
        //6     Originating Account Number          17      59-75
        //7     Filler                              2       76-77
        //8     Check Date                          8       78-85
        //9     Check Number                        10      86-95
        //10    Payment Amount                      14      96-109
        //11    Payee Name                          50      110-159
        //12    Joint Payee Name                    50      160-209
        //13    Payee Address Line 1                100     210-309
        //14    Payee Address Line 2                100     310-409
        //15    Payee City                          30      410-439
        //16    Payee State/Prov.                   2       440-441
        //17    Payee Postal Code                   10      442-451
        //18    Payee Country                       20      452-471
        //19    Payee Country Code                  3       472-474
        //20    Filler                              46      475-520
        //21    Check Delivery Flag                 1       521-521
        //22    Advice Flag                         1       522-522
        //23    Filler                              23      523-545
        //24    Currency Code                       3       546-548
        //25    Filler                              60      548-608
        //26    Property Type Code                  5       609-613
        //27    Payee Email Address                 50      614-663
        //28    Additional Data                     15      664-678
        //29    Payee Address Line 3                100    679-778
        //30    Filler                              422    779-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();

        mPaymentCount++;
        mPaymentAmount += mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1     Record Type                         1       1
        sb.Append('P');

        //2     Payment Type                        3       2-4
        sb.Append('CHK');

        //3     Filler                              15      5-19
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //4     Customer Name                       30      20-49
        sb.Append(SKS_PP_StringFormats::strFill(30, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //5     Originating Routing & Transit       9       50-58
        sb.Append(SKS_PP_StringFormats::strFill(9, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankTransit), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //6    Originating Account Number           17      59-75
        sb.Append(SKS_PP_StringFormats::strFill(17, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankAcct), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
        
        //7     Filler                              2       76-77
        sb.Append(SKS_PP_StringFormats::strFill(2, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //8     Check Date                          8       78-85
        sb.Append(SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate));

        //9     Check Number                        10      86-95
        sb.Append(SKS_PP_StringFormats::strFill(10, mSKS_EFT_FileDetail.PaymentReference, SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //10    Payment Amount                      14      96-109
        sb.Append(SKS_PP_StringFormats::strFill(14, num2str(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //11    Payee Name                          50      110-159
        sb.Append(SKS_PP_StringFormats::strFill(50, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //12    Joint Payee Name                    50      160-209
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //13    Payee Address Line 1                100     210-309
        sb.Append(SKS_PP_StringFormats::strFill(100, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //14    Payee Address Line 2                100     310-409
        sb.Append(SKS_PP_StringFormats::strFill(100, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr2), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //15    Payee City                          30      410-439
        sb.Append(SKS_PP_StringFormats::strFill(30, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneCity), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //16    Payee State/Prov.                   2       440-441
        sb.Append(SKS_PP_StringFormats::strFill(2, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneState), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //17    Payee Postal Code                   10      442-451
        sb.Append(SKS_PP_StringFormats::strFill(10, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneZipPostal), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //18    Payee Country                       20      452-471
        str countryName = this.CharacterReplacement(LogisticsAddressCountryRegion::findByISOCode(mSKS_EFT_FileDetail_BenBank.BenBankCountryRegionId).displayName());
        sb.Append(SKS_PP_StringFormats::strFill(20, countryName, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //19    Payee Country Code                  3       472-474
        sb.Append(SKS_PP_StringFormats::strFill(3, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneCountryRegionId), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //20    Filler                              46      475-520
        sb.Append(SKS_PP_StringFormats::strFill(46, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //21    Check Delivery Flag                 1       521-521
        sb.Append(SKS_PP_StringFormats::strFill(1, SKS_EFT_Format::getCodelookupvalue('CHKDlvryFlag', mSKS_EFT_FileDetail.RecId), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //22    Advice Flag                         1       522-522
        sb.Append(SKS_PP_StringFormats::strFill(1, SKS_EFT_Format::getCodelookupvalue('AdviceFlag', mSKS_EFT_FileDetail.RecId), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //23    Filler                              23      523-545
        sb.Append(SKS_PP_StringFormats::strFill(23, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //24    Currency Code                       3       546-548
        sb.Append(SKS_PP_StringFormats::strFill(3, mSKS_EFT_FileDetail.PaymentCurrencyCode, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //25    Filler                              60      548-608
        sb.Append(SKS_PP_StringFormats::strFill(60, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //26    Property Type Code                  5       609-613
        sb.Append(SKS_PP_StringFormats::strFill(5, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //27    Payee Email Address                 50      614-663
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //28    Additional Data                     15      664-678
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //29    Payee Address Line 3                100    679-778
        sb.Append(SKS_PP_StringFormats::strFill(100, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //30    Filler                              422    779-1200
        sb.Append(SKS_PP_StringFormats::strFill(422, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_CHKRemittance</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_CHKRemittance
    /// </summary>
    /// <param name = "invSKS_EFT_FileDetail">invSKS_EFT_FileDetail</param>
    /// <returns>true</returns>
    boolean rec_CHKRemittance(SKS_EFT_FileDetail invSKS_EFT_FileDetail)
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length  Position
        //1     Record Type                         1       1
        //2     Vendor ID#                          15      2-16
        //3     Table Value 1                       50      17-66
        //4     Invoice Date                        15      67-81
        //5     Table Value 2                       50      82-131
        //6     Invoice #                           15      132-146
        //7     Table Value 3                       50      147-196
        //8     Description                         15      197-211
        //9     Table Value 4                       50      212-261
        //10    Gross Amount                        15      262-276
        //11    Table Value 5                       50      277-326
        //12    Discounts                           15      327-341
        //13    Table Value 6                       50      342-391
        //14    Net Amount                          15      392-406
        //15    Table Value 7                       50      407-456
        //16    Table Header 8                      15      457-471
        //17    Table Value 8                       50      472-521
        //18    Table Header 9                      15      522-536
        //19    Table Value 9                       50      537-586
        //20    Table Header 10                     15      587-601
        //21    Table Value 10                      50      602-651
        //22    Table Header 11                     15      652-666
        //23    Table Value 11                      50      667-716
        //24    Table Header 12                     15      717-731
        //25    Table Value 12                      50      732-781
        //26    Table Header 13                     15      782-796
        //27    Table Value 13                      50      797-846
        //28    Table Header 14                     15      847-861
        //29    Table Value 14                      50      862-911
        //30    Table Header 15                     15      912-926
        //31    Table Value 15                      50      927-976
        //32    Table Header 16                     15      977-991
        //33    Table Value 16                      50      992-1041
        //34    Table Header 17                     15      1042-1056
        //35    Table Value 17                      50      1057-1106
        //36    Table Header 18                     15      1107-1121
        //37    Table Value 18                      50      1122-1171
        //38    Filler                              29      1172-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        AmountMST   gross = invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1     Record Type                         1       1
        sb.Append('R');

        //2     Vendor ID#                          15      2-16
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Vendor ID#', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //3     Table Value 1                       50      17-66
        sb.Append(SKS_PP_StringFormats::strFill(50, mSKS_EFT_FileDetail.AccountNum, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //4     Invoice Date                        15      67-81
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Invoice Date', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //5     Table Value 2                       50      82-131
        sb.Append(SKS_PP_StringFormats::strFill(50, SKS_PP_StringFormats::strDateYYYYMMDD(invSKS_EFT_FileDetail.InvoiceDate), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //6     Invoice #                           15      132-146
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Invoice #', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //7     Table Value 3                       50      147-196
        sb.Append(SKS_PP_StringFormats::strFill(50, invSKS_EFT_FileDetail.InvoiceNumber, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //8     Description                         15      197-211
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Description', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //9     Table Value 4                       50      212-261
        sb.Append(SKS_PP_StringFormats::strFill(50, this.CharacterReplacement(invSKS_EFT_FileDetail.InvoiceTransactionTxt), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //10    Gross Amount                        15      262-276
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Gross Amount', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //11    Table Value 5                       50      277-326
        sb.Append(SKS_PP_StringFormats::strFill(50, num2str(gross * -1,0,2,1,0), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //12    Discounts                           15      327-341
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Discounts', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //13    Table Value 6                       50      342-391
        sb.Append(SKS_PP_StringFormats::strFill(50, '-' + num2str(invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //14    Net Amount                          15      392-406
        sb.Append(SKS_PP_StringFormats::strFill(15, 'Net Amount', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //15    Table Value 7                       50      407-456
        sb.Append(SKS_PP_StringFormats::strFill(50, num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //16    Table Header 8                      15      457-471
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //17    Table Value 8                       50      472-521
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //18    Table Header 9                      15      522-536
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //19    Table Value 9                       50      537-586
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //20    Table Header 10                     15      587-601
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //21    Table Value 10                      50      602-651
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //22    Table Header 11                     15      652-666
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //23    Table Value 11                      50      667-716
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //24    Table Header 12                     15      717-731
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //25    Table Value 12                      50      732-781
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //26    Table Header 13                     15      782-796
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //27    Table Value 13                      50      797-846
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //28    Table Header 14                     15      847-861
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //29    Table Value 14                      50      862-911
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //30    Table Header 15                     15      912-926
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //31    Table Value 15                      50      927-976
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //32    Table Header 16                     15      977-991
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //33    Table Value 16                      50      992-1041
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //34    Table Header 17                     15      1042-1056
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //35    Table Value 17                      50      1057-1106
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //36    Table Header 18                     15      1107-1121
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //37    Table Value 18                      50      1122-1171
        sb.Append(SKS_PP_StringFormats::strFill(50, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //38    Filler                              29      1172-1200
        sb.Append(SKS_PP_StringFormats::strFill(29, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_ACHRemittance</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_ACHRemittance
    /// </summary>
    /// <param name = "invSKS_EFT_FileDetail">invSKS_EFT_FileDetail</param>
    /// <returns>true</returns>
    boolean rec_ACHRemittance(SKS_EFT_FileDetail invSKS_EFT_FileDetail)
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length      Position
        //1     Record Type                         1       1
        //2     Invoice Date                        8       2-9
        //3     Invoice Nbr                         25      10-34
        //4     Gross Amount                        12      35-46
        //5     Discount Amount                     12      47-58
        //6     Net Amount                          12      59-70
        //7     Description                         75      71-145
        //8     Adjustment                          12      146-157
        //9     Adjustment Reason                   2       158-159
        //10    Adjustment Invoice Nbr              25      160-184
        //11    Filler                              1016    185-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        AmountMST   gross = invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1     Record Type                         1       1
        sb.Append('R');

        //1     Invoice Date                        8       2-9
        sb.Append(SKS_PP_StringFormats::strFill(8, SKS_PP_StringFormats::strDateYYYYMMDD(invSKS_EFT_FileDetail.InvoiceDate), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //2     Invoice Nbr                         25      10-34
        sb.Append(SKS_PP_StringFormats::strFill(25, invSKS_EFT_FileDetail.InvoiceNumber, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //3     Gross Amount                        12      35-46
        sb.Append(SKS_PP_StringFormats::strFill(12, num2str(gross * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //4     Discount Amount                     12      47-58
        sb.Append(SKS_PP_StringFormats::strFill(12, '-' + num2str(invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //5     Net Amount                          12      59-70
        sb.Append(SKS_PP_StringFormats::strFill(12, num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //6     Description                         75      71-145
        sb.Append(SKS_PP_StringFormats::strFill(75, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //7     Adjustment                          12      146-157
        sb.Append(SKS_PP_StringFormats::strFill(12, '', SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //8     Adjustment Reason                   2       158-159
        sb.Append(SKS_PP_StringFormats::strFill(2, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //9     Adjustment Invoice Nbr              25      160-184
        sb.Append(SKS_PP_StringFormats::strFill(25, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //10    Filler                              1016    185-1200
        sb.Append(SKS_PP_StringFormats::strFill(1016, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_WIREDetail</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_WIREDetail
    /// </summary>
    /// <returns>true</returns>
    boolean rec_WIREDetail()
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                                     Length      Position
        //1     Record Type                                         1       1
        //2     Payment Type                                        3       2-4
        //3     Filler                                              15      5-19
        //4     Originator or Payer Name (& Address Line 1)         30      20-49
        //5     Originator or Payer Routing & Transit               9       50-58
        //6     Originator or Payer Account Number                  17      59-75
        //7     Wire Type                                           2       76-77
        //8    Value Date                                           8       78-85
        //9    Filler                                               10      86-95
        //10    Payment Amount                                      14      96-109
        //11    Beneficiary Name (& Address Line 1)                 35      110-144
        //12    Filler                                              65      145-209
        //13    Beneficiary Name & Address Line 2                   35      210-244
        //14    Filler                                              65      245-309
        //15    Beneficiary Name & Address Line 3                   35      310-344
        //16    Filler                                              65      345-409
        //17    Beneficiary Name & Address Line 4                   35      410-444
        //18    Filler                                              30      445-474
        //19    Receiver Bank Routing & Transit or SWIFT BIC        11      475-485
        //20    Receiver Account Number                             35      486-520
        //21    Filler                                              25      521-545
        //22    Currency Code                                       3       546-548
        //23    Filler                                              3       549-551
        //24    Receiving Bank Name & Address                       55      552-606
        //25    Filler                                              70      607-676
        //26    Originator or Payer Name & Address Line 2           35      677-711
        //27    Originator or Payer Name & Address Line 3           35      712-746
        //28    Originator or Payer Name & Address Line 4           35      747-781
        //29    Filler                                              151     782-932
        //30    Account with Institution SWIFT BIC                  11      933-943
        //31    Account with Institution Name (& Address 1)         35      944-978
        //32    Account with Institution Name & Address 2           35      979-1013
        //33    Account with Institution Name & Address 3           35      1014-1048
        //34    Account with Institution Name & Address 4           35      1049-1083
        //35    Filler                                              117     1084-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        mPaymentCount++;
        mPaymentAmount += mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1     Record Type                                         1       1
        sb.Append('P');

        //2     Payment Type                                        3       2-4
        sb.Append('WIR');

        //3     Filler                                              15      5-19
        sb.Append(SKS_PP_StringFormats::strFill(15, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //4     Originator or Payer Name (& Address Line 1)         30      20-49
        sb.Append(SKS_PP_StringFormats::strFill(30, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //5     Originator or Payer Routing & Transit               9       50-58
        sb.Append(SKS_PP_StringFormats::strFill(9, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankTransit), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //6    Originating Account Number           17      59-75
        sb.Append(SKS_PP_StringFormats::strFill(17, this.CharacterReplacement(mSKS_EFT_FileDetail.BankBankAcct), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
                
        //7     Wire Type                                           2       76-77
        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #FED_WIRE:
                sb.Append('NR');
                break;
            case #INTL_WIRE:
                sb.Append('SW');
                break;
        }

        //8    Value Date                                           8       78-85
        sb.Append(SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate));

        //9    Filler                                               10      86-95
        sb.Append(SKS_PP_StringFormats::strFill(10, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //10    Payment Amount                                      14      96-109
        sb.Append(SKS_PP_StringFormats::strFill(14, num2str(mSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //11    Beneficiary Name (& Address Line 1)                 35      110-144
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //12    Filler                                              65      145-209
        sb.Append(SKS_PP_StringFormats::strFill(65, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //13    Beneficiary Name & Address Line 2                   35      210-244
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //14    Filler                                              65      245-309
        sb.Append(SKS_PP_StringFormats::strFill(65, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //15    Beneficiary Name & Address Line 3                   35      310-344
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneAddr2), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //16    Filler                                              65      345-409
        sb.Append(SKS_PP_StringFormats::strFill(65, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //17    Beneficiary Name & Address Line 4                   35      410-444
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_VendAddress.BeneCity), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //18    Filler                                              30      445-474
        sb.Append(SKS_PP_StringFormats::strFill(30, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //19    Receiver Bank Routing & Transit or SWIFT BIC        11      475-485
        sb.Append(SKS_PP_StringFormats::strFill(11, subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 9), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        switch(mSKS_EFT_FileFormatPaymSpec.TransactionCode)
        {
            case #FED_WIRE:
                sb.Append(SKS_PP_StringFormats::strFill(11, subStr(mSKS_EFT_FileDetail.DepBankTransit, 1, 9), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
                sb.Append(SKS_PP_StringFormats::strFill(35, subStr(mSKS_EFT_FileDetail.DepBankAcct, 1, 16), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
                break;
            case #INTL_WIRE:
                sb.Append(SKS_PP_StringFormats::strFill(11, mSKS_EFT_FileDetail.DepSwiftNo, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
                sb.Append(SKS_PP_StringFormats::strFill(35, subStr(mSKS_EFT_FileDetail.DepBankIBAN, 1, 16), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
                break;
        }

        //21    Filler                                              25      521-545
        sb.Append(SKS_PP_StringFormats::strFill(25, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //22    Currency Code                                       3       546-548
        sb.Append(SKS_PP_StringFormats::strFill(3, mSKS_EFT_FileDetail.PaymentCurrencyCode, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //23    Filler                                              3       549-551
        sb.Append(SKS_PP_StringFormats::strFill(3, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //24    Receiving Bank Name & Address                       55      552-606
        sb.Append(SKS_PP_StringFormats::strFill(55, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        if(mSKS_EFT_FileFormatPaymSpec.TransactionCode == #INTL_WIRE)       //SKS#DevOps:20209
        {
            //          Filler
            sb.Append(SKS_PP_StringFormats::strFill(67, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

            sb.Append(SKS_PP_StringFormats::strFill(3, SKS_EFT_Format::getCodelookupvalue('ChrgBr', mSKS_EFT_FileDetail.RecId), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
        }
        else
        {
            //25    Filler                                              70      607-676
            sb.Append(SKS_PP_StringFormats::strFill(70, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
        }

        //26    Originator or Payer Name & Address Line 2           35      677-711
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //27    Originator or Payer Name & Address Line 3           35      712-746
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyAddr2), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //28    Originator or Payer Name & Address Line 4           35      747-781
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyCity), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //29    Filler                                              151     782-932
        sb.Append(SKS_PP_StringFormats::strFill(151, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //30    Account with Institution SWIFT BIC                  11      933-943
        sb.Append(SKS_PP_StringFormats::strFill(11, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //31    Account with Institution Name (& Address 1)         35      944-978
        sb.Append(SKS_PP_StringFormats::strFill(35, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //32    Account with Institution Name & Address 2           35      979-1013
        sb.Append(SKS_PP_StringFormats::strFill(35, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //33    Account with Institution Name & Address 3           35      1014-1048
        sb.Append(SKS_PP_StringFormats::strFill(35, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //34    Account with Institution Name & Address 4           35      1049-1083
        sb.Append(SKS_PP_StringFormats::strFill(35, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //35    Filler                                              117     1084-1200
        sb.Append(SKS_PP_StringFormats::strFill(117, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_Header</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_Header
    /// </summary>
    /// <returns>true</returns>
    boolean rec_Header()
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                   length   Position
        //1     Record Type                     1       1
        //2     Customer Name                   35      2-36
        //3     File Date                       8       37-44
        //4     File Sequence Number            6       45-50
        //5     Sender ID                       10      51-60
        //6     Payer ID                        10      61-70
        //7     Wire Security Code              5       71-75
        //8     Filler                          1125    76-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder   sb = new System.Text.StringBuilder();

        //1     Record Type                     1       1
        sb.Append('H');

        //2     Customer Name                   35      2-36
        sb.Append(SKS_PP_StringFormats::strFill(35, this.CharacterReplacement(mSKS_EFT_FileDetail_BankAccount.WOrdPartyName), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //3     File Date                       8       37-44
        sb.Append(SKS_PP_StringFormats::strDateYYYYMMDD(mSKS_EFT_FileDetail.EffectiveDate));

        //4     File Sequence Number            6       45-50
        sb.Append(SKS_PP_StringFormats::strFill(6, mSKS_EFT_File.FileNbr, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //5     Sender ID                       10      51-60
        sb.Append(SKS_PP_StringFormats::strFill(10, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //6     Payer ID                        10      61-70
        sb.Append(SKS_PP_StringFormats::strFill(10, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //7     Wire Security Code              5       71-75
        if(mSKS_EFT_FileDetail.TransactionCode == #FED_WIRE)
        {
            sb.Append(SKS_PP_StringFormats::strFill(5, this.CharacterReplacement(SKS_EFT_Format::getCodelookupvalue('WireSecurityCode', mSKS_EFT_FileDetail.RecId)), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));
        }
        else
        {
            sb.Append(SKS_PP_StringFormats::strFill(5, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
        }

        //8     Filler                          1125    76-1200
        sb.Append(SKS_PP_StringFormats::strFill(1125, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_Trailer</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_Trailer
    /// </summary>
    /// <returns>true</returns>
    boolean rec_Trailer()
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length  Position
        //1     Record Type                     1       1
        //2     Total # Payments                6       2-7
        //3     Total Payment Amount            14      8-21
        //4     Filler                          1179    22-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();

        //1     Record Type                     1       1
        sb.Append('T');

        //2     Total # Payments                6       2-7
        sb.Append(SKS_PP_StringFormats::strFill(6, int2str(mPaymentCount), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //3     Total Payment Amount            14      8-21
        sb.Append(SKS_PP_StringFormats::strFill(14, num2str(mPaymentAmount * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //4     Filler                          1179    22-1200
        sb.Append(SKS_PP_StringFormats::strFill(1179, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>rec_WIRERemittance</Name>
				<Source><![CDATA[
    /// <summary>
    /// rec_WIRERemittance
    /// </summary>
    /// <param name = "invSKS_EFT_FileDetail">invSKS_EFT_FileDetail</param>
    /// <returns>true</returns>
    boolean rec_WIRERemittance(SKS_EFT_FileDetail invSKS_EFT_FileDetail)
    {
        //------------------------------------------------------------------------------------------------------
        //Nbr   Description                     Length      Position
        //1     Record Type                         1       1
        //2     Invoice Date                        8       2-9
        //3     Invoice Nbr                         25      10-34
        //4     Gross Amount                        12      35-46
        //5     Discount Amount                     12      47-58
        //6     Net Amount                          12      59-70
        //7     Description                         75      71-145
        //8     Adjustment                          12      146-157
        //9     Adjustment Reason                   2       158-159
        //10    Adjustment Invoice Nbr              25      160-184
        //11    Filler                              1016    185-1200
        //------------------------------------------------------------------------------------------------------
        System.Text.StringBuilder sb = new System.Text.StringBuilder();
        AmountMST   gross = invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur + invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur;

        //1     Record Type                         1       1
        sb.Append('R');

        //1     Invoice Date                        8       2-9
        sb.Append(SKS_PP_StringFormats::strFill(8, SKS_PP_StringFormats::strDateYYYYMMDD(invSKS_EFT_FileDetail.InvoiceDate), SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //2     Invoice Nbr                         25      10-34
        sb.Append(SKS_PP_StringFormats::strFill(25, invSKS_EFT_FileDetail.InvoiceNumber, SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //3     Gross Amount                        12      35-46
        sb.Append(SKS_PP_StringFormats::strFill(12, num2str(gross * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //4     Discount Amount                     12      47-58
        sb.Append(SKS_PP_StringFormats::strFill(12, '-' + num2str(invSKS_EFT_FileDetail.InvoiceDiscAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));  //SKS#DevOps:20330

        //5     Net Amount                          12      59-70
        sb.Append(SKS_PP_StringFormats::strFill(12, num2str(invSKS_EFT_FileDetail.InvoiceSettleAmountPmtCur * -1,0,2,1,0), SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //6     Description                         75      71-145
        sb.Append(SKS_PP_StringFormats::strFill(75, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //7     Adjustment                          12      146-157
        sb.Append(SKS_PP_StringFormats::strFill(12, '', SKS_PP_FillCharacter::Zero, SKS_PP_FillSide::Left));

        //8     Adjustment Reason                   2       158-159
        sb.Append(SKS_PP_StringFormats::strFill(2, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //9     Adjustment Invoice Nbr              25      160-184
        sb.Append(SKS_PP_StringFormats::strFill(25, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));

        //10    Filler                              1016    185-1200
        sb.Append(SKS_PP_StringFormats::strFill(1016, '', SKS_PP_FillCharacter::Space, SKS_PP_FillSide::Right));
    
        this.fileWrite(sb.ToString());
        return true;
    }

]]></Source>
			</Method>
			<Method>
				<Name>selectPaymentRecords</Name>
				<Source><![CDATA[
    [SuppressBPWarning('BPErrorSelectUsingFirstOnly', 'The buffer is used in next statement or in a datasource query loop.')]
    protected void selectPaymentRecords()
    {
        //------------------------------------------------------------------------------------------------------
        // Standard payment selction
        // Override if different selection is need for a format
        //------------------------------------------------------------------------------------------------------
        //Order by clause must match the clause in the SKS_EFT_Processing.SumByPayment
        select * from mSKS_EFT_FileDetail
            join mSKS_EFT_FileDetail_VendAddress
            join mSKS_EFT_FileDetail_BenBank
            join mSKS_EFT_FileDetail_Intermediary
            join mSKS_EFT_FileDetail_CreditParty
            join msKS_EFT_FileDetail_Instructions
                order by mSKS_EFT_FileDetail.RecordSection,
                    mSKS_EFT_FileDetail.PaymMode,
                    mSKS_EFT_FileDetail.BankAccountId,
                    mSKS_EFT_FileDetail.PaymentCurrencyCode,
                    mSKS_EFT_FileDetail.PaymSpec,
                    mSKS_EFT_FileDetail.EffectiveDate,
                    mSKS_EFT_FileDetail.DepCountryRegionId,
                    mSKS_EFT_FileDetail.RecordType,
                    mSKS_EFT_FileDetail.AccountNum,
                    mSKS_EFT_FileDetail.PaymentReference,
                    mSKS_EFT_FileDetail.RecId
            where mSKS_EFT_FileDetail.FileRecId == mSKS_EFT_File.RecId &&
                mSKS_EFT_FileDetail.RecordSection == SKS_EFT_RecordSection::Payments &&
                mSKS_EFT_FileDetail.RecordSummary != SKS_EFT_RecordSummary::NonSummary &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_VendAddress.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_BenBank.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_Intermediary.RefRecId &&
                mSKS_EFT_FileDetail.RecId == mSKS_EFT_FileDetail_CreditParty.RefRecId &&
                mSKS_EFT_FileDetail.RecId == msKS_EFT_FileDetail_Instructions.RefRecId;
    }

]]></Source>
			</Method>
		</Methods>
	</SourceCode>
</AxClass>